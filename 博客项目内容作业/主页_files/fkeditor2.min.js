function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,o=new Array(t.length);e<t.length;e++)o[e]=t[e];return o}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function o(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperty(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}!function(L,E,H,g,I){var t,n,F,A,N=g,M=N.top.Site,C=!E.getSelection,r=navigator.userAgent.toLowerCase(),c=-1<r.indexOf("se"),T=-1<r.indexOf("firefox"),B=-1<r.indexOf("opera"),a=/applewebkit/.test(r)&&/chrome/.test(r)&&58<=parseFloat(r.match(/ chrome\/(\d+)/)[1]),o="",u="unselectable",l=C?H.selection&&H.selection.createRange&&"None"!=H.selection.type?H.selection.createRange():I:E.getSelection(),R=(_defineProperty(t={ModuleId:"moduleId",OuterFun:"outerFun",Option:"option",Editor:"editor",LinkHasClick:"linkHasClick",SignClassNum:"scn",HasRsChildStyle:"hrcs",Range:"range",NotCreateNewNode:"ncnn",SimpleTextEdit:"simpleTextEdit",HasSelectText:"hst",ClearSpanCursoring:"cscs",OldVHeight:"ovht",OldHwidth:"ohwt",HoverToolOn:"hoverToolOn",FloatImg:"floatImg",HoverToolTimeout:"htto",EditLineTimeout:"etto"},"SignClassNum","signClassNum"),_defineProperty(t,"SetPageChange","spce"),_defineProperty(t,"HasRemoveUselessChild","rucsc"),_defineProperty(t,"RemoveUselessChildIng","rucscing"),_defineProperty(t,"PreScrollHeight","psht"),_defineProperty(t,"ChangeCount","changeCount"),_defineProperty(t,"ScrollChangeChecking","sccg"),_defineProperty(t,"FirstChooseEditor","fcet"),_defineProperty(t,"PreHtmlContent","phct"),_defineProperty(t,"Onfocused","onfocused"),_defineProperty(t,"Mousedown","mousedown"),_defineProperty(t,"Mousemove","mousemove"),_defineProperty(t,"FixRight","fixRight"),_defineProperty(t,"ScreenX","screenX"),_defineProperty(t,"ScreenY","screenY"),_defineProperty(t,"HasRefreshClick","hrfc"),_defineProperty(t,"PreModuleHeight","pmheight"),_defineProperty(t,"PreCommand","preCommand"),_defineProperty(t,"SelectedInputBlur","sib"),_defineProperty(t,"TriggerClick","ectc"),_defineProperty(t,"EndCheckClass","endCheckClass"),_defineProperty(t,"EditSignClass","editSignClass"),_defineProperty(t,"EditorEventBind","editorEventBind"),_defineProperty(t,"BackPreColor","bpcolor"),_defineProperty(t,"PreHasText","preHasText"),t),U={Contenteditable:"contenteditable",Emphasis:"emphasis"},w={Scrolling:"scll",ScrollingMousedown:"scllmdn"},j={EditContent:"editContent",EditPositionFixed:"positionFixed",EditLogoDisplay:"logoDisplay",GlobalLink:"globalLink",BorderRadius:"borderRadius",Opacity:"opacity",Border:"border",Shadow:"shadow",Radius:"radius",Delete:"delete",FontSize:"fSize",LineHeight:"lineHeight",Animation:"animation",Parallax:"parallax",BtnModuleStyle:"btnModuleStyle",EditPhotoBtn:"editPhotoBtn",EditFixedBtn:"editFixedBtn",ImgEffectBtn:"imgEffectBtn",PhotoShapeBtn:"photoShapeBtn",SimpleLinkBtn:"simpleLinkBtn",ModuleTitleBtn:"moduleTitleBtn",DescribePicBtn:"describePicBtn",Linkcreator:"linkcreator",Formats:"formats",Colors:"colors",HoverColors:"hoverColors",Removeformat:"removeformat",TextAlign:"textAlign",JustifyLeft:"justifyLeft",JustifyCenter:"justifyCenter",JustifyRight:"justifyRight",JustifyFull:"justifyFull",WritingMode:"writingMode",Bold:"Bold",Italic:"Italic",Underline:"Underline",Unlink:"Unlink",Createlink:"Createlink",SingleClick:"singleClick",Dblclick:"dblclick",InputFontSize:"inputFontSize",InputLineHeight:"inputLineHeight",ChooseFormats:"chooseFormats",ChooseLineHeight:"chooseLineHeight",ChooseFontSize:"chooseFontSize",DeleteLink:"deleteLink",Horizontal:"horizontal",VerticalToRight:"verticalToRight",VerticalToLeft:"verticalToLeft",EditDynamicNumber:"editDynamicNumber",EditAnimation:"editAnimation",EditPlay:"editPlay",EditAlt:"editAlt"};M.simpleTextList={allEditors:[],chooseEditor:{},colorToolShow:!1,checking:!1},o=/msie/.test(r)?"-ms-":/chrome/.test(r)||/safari/.test(r)||/yandex/.test(r)?"-webkit-":T?"-moz-":B?"-o-":/konqueror/.test(r)?"-khtml-":"";var e=function e(){this.constructor.prototype.extend=function(t,e){for(var o in e)o in e.constructor.prototype||(t[o]=e[o]);for(var o in e.constructor.prototype)t.constructor.prototype[o]=e[o]}};n=new e;var i=function i(){this.constructor.prototype.test=function(){return!0}};new i;var d=function d(){var e,g=this;this.getEventCtrl=function(){if(e)return e;var t=function t(){var h=this;h.constructor.prototype.removeParentUselessNode=function(t){var e=t.element,o=t.styleName,n=(t.styleValue,t.endCheckClass);if(_typeof(e.parent())==I)return g;var i=e.parent();return i.hasClass(n)||e.text().length==i.text().length&&(i.css(o,""),t.element=i,h.removeParentUselessNode(t)),g},h.constructor.prototype.changeChildStyle=function(t){var e=t.element,o=t.styleName;t.styleValue;if(_typeof(e.children)==I)return g;for(var n=0;n<e.children().length;n++){var i=e.children().eq(n);i.css(o,""),t.element=i,h.changeChildStyle(t)}return g},h.constructor.prototype.setElementStyleEffectAll=function(t){var e=t.element,o=t.effectElement,n=t.styleName,i=t.styleValue;t.elemenText,t.endCheckClass;return e&&0<e.length&&(e.find("*").css(n,""),e.find(o).css(n,i)),t.element=e,h.setElementParentStyleEffectAll(t),g},h.constructor.prototype.setElementParentStyleEffectAll=function(t){var e=t.element,o=t.effectElement,n=t.styleName,i=t.styleValue,r=t.elemenText,a=t.endCheckClass,l=e.parent();return _typeof(l)==I||l.hasClass(a)||L.trim(l.text())!=r||(l[0].tagName.toLowerCase()==o?l.css(n,i):_typeof(l.css(n))!=I&&l.css(n,""),t.element=l,h.setElementParentStyleEffectAll(t)),g},h.constructor.prototype.checkInArray=function(t,e){for(var o=0;o<t.length;o++)if(t[o]==e)return!0;return!1},h.constructor.prototype.findTagInParent=function(t,e,o){var n=!1;if(_typeof(t.parent())==I||t.parent().length<=0)return n;var i=t.parent();return i.hasClass(o)?n:i[0].tagName.toLowerCase()==e?i:h.findTagInParent(i,e,o)},h.constructor.prototype.filterPasteData=function(t){var e,o,n,i,r,a,l,d,s,c=["div","span","font","p","u","i","br","b","a","strong","em"],u=["font-size","line-height","text-align","color","font-family"];if(_typeof(t.children)==I||t.children().length<=0)return g;for(var f=0;f<t.children().length;f++)if(o=t.children().eq(f),h.filterPasteData(o),e=L.trim(o.prop("tagName").toLowerCase()),h.checkInArray(c,e)){if("a"===e){var p=o.attr("href");p&&-1!=p.indexOf(location.origin)&&o.attr("href",p.replace(location.origin,""))}if(!(_typeof(n=o.attr("style"))==I||n.length<=0||(s=(n=n.toLowerCase()).split(";")).length<=0)){i=!1,r=[];for(var m=0;m<s.length;m++)_typeof(s[m])!=I&&_typeof(a=s[m].split(":"))!=I&&2==a.length?(0<(l=a[0]).indexOf(",")&&(l=l.substring(l.lastIndexOf(","))),d=a[1],l=L.trim(l),h.checkInArray(u,l)?("font-size"!=l&&"line-height"!=l||(d.indexOf("px")<0?s[m]="":i=!0),r.push(s[m]+";")):i=!0):i=!0;i&&o.attr("style",r.join(""))}}else o.prop("outerHTML",o.text());return g},h.constructor.prototype.textPositionCorrect=function(t){if(0<t.find("div").length||0<t.find("p"))return g;if(_typeof(t.children)==I||t.children().length<=0)return g;for(var e=0;e<t.children().length;e++){var o=t.children().eq(e);_typeof(o.attr("style"))!=I&&o.attr("style")&&-1!=o.attr("style").indexOf("text-align")&&"block"!=o.css("display")&&o.css("display","block"),h.textPositionCorrect(o)}return g},h.constructor.prototype.setUnselectable=function(t){return t.fkEditorWrap.find("["+u+"]").css(o+"user-select","none").attr(u,"on").on("selectstart mousedown",!1),t.toolbar.find(".simpleTextEditTool").find("["+u+"]").css(o+"user-select","none").attr(u,"on").on("selectstart mousedown",!1),g},h.constructor.prototype.removeUselessChildStyle=function(t,e){if(t.data(R.SetPageChange)&&1!=t.data(R.HasRemoveUselessChild)&&_typeof(e.children())!=I)for(var o,n,i,r,a,l,d,s,c=0;c<e.children().length;c++){if(s=_typeof(i=(o=e.children().eq(c)).attr("class"))==I||""==i,n=e.parent(),("span"==r||"font"==r||"a"==r)&&o.text().length<=0&&s&&o.html().indexOf("br")<=0)return void o.replaceWith("");s&&(r=o.prop("tagName").toLowerCase(),a=o.attr("style"),l=o.attr("color"),d=o.attr("face"),_typeof(a)!=I&&""!=a||"span"!=r&&("font"!=r||_typeof(l)!=I||_typeof(d)!=I)||(o.replaceWith(o.html()),o=n)),h.removeUselessChildStyle(t,o)}},h.constructor.prototype.removeElementProp=function(t){var e,o,n=t.element,i=t.attrName;_typeof(o=n.attr(i))!=I&&""!=o&&n.removeAttr(i);for(var r=0;r<n.children().length;r++)_typeof(o=(e=n.children().eq(r)).attr(i))!=I&&""!=o&&e.removeAttr(i),h.removeElementProp({element:e,attrName:i})},h.constructor.prototype.setElementStyle=function(t){var e,o=t.element,n=t.styleName,i=t.styleValue;o.css(n,i);for(var r=0;r<o.children().length;r++)(e=o.children().eq(r)).css(n,i),h.setElementStyle({element:e,styleName:n,styleValue:i})}};return e=new t},this.getUICtrl=function(){}};A=new d;var s=function s(){var e,o,D=this;this.getEventCtrl=function(){if(e)return e;var t=function t(){var x=this,w=(new Date).getTime(),P=(new Date).getTime();x.constructor.prototype.getWindowSelection=function(){return C?x.checkSelectionRange()?H.selection.createRange():l:E.getSelection()},x.constructor.prototype.checkIEGetSelection=function(){var t=x.getWindowSelection();return!!t&&!("baseOffset"in t&&0==t.baseOffset)},x.constructor.prototype.isNumberPress=function(t){return 48<=t&&t<=57||(96<=t&&t<=105||(8==t||46==t||37==t||39==t))},x.constructor.prototype.checkSelectionRange=function(){return H.selection&&H.selection.createRange&&"None"!=H.selection.type},x.constructor.prototype.getSelectedNode=function(){var t,e,o=x.getWindowSelection();C||(t=o.anchorNode),!t&&x.checkSelectionRange()&&(t=(e=(o=H.selection).getRangeAt?o.getRangeAt(0):o.createRange()).commonAncestorContainer?e.commonAncestorContainer:e.parentElement?e.parentElement():e.item(0));return!!t&&("#text"==t.nodeName?L(t.parentNode):L(t))},x.constructor.prototype.detectElement=function(t){var o,e=t.tags,n=!1,i=x.getSelectedNode();return!!i&&(o=i.prop("tagName").toLowerCase(),L.each(e,function(t,e){if(o==e)return!(n=!0)}),n||(i.parents().each(function(){if(o=L(this).prop("tagName").toLowerCase(),L.each(e,function(t,e){if(o==e)return!(n=!0)}),n)return!1}),n))},x.constructor.prototype.detectElementCss=function(t){var e,o=x.getSelectedNode(),n=".fk-editor,.floatBtn";return t&&o&&0<o.length&&o.is(n)?(""==(e=x.detectElementDeepCss(o,t))&&(e=o.css(t)),e):t&&o?o.css(t):""},x.constructor.prototype.detectElementDeepCss=function(t,e){var o="",n=t.text().length;if(n<=0)return o;if(t.children().length<=0&&0<n)return o=t.css(e);for(var i=t.children().length-1;0<=i&&""==(o=x.detectElementDeepCss(t.children().eq(i),e));i--);return o},x.constructor.prototype.refuseStyle=function(t){var e=x.getSelectedNode();if(e&&e.is("[style]")&&""!=e.css(t)){var o,n=e.css(t);return e.css(t,""),o=e.attr("style"),e.css(t,n),o}return""},x.constructor.prototype.setSelection=function(t,e){var o,n=x.getWindowSelection();if(C)n.execCommand(t,!1,e);else{n.anchorNode&&n.getRangeAt&&(o=n.getRangeAt(0)),o&&(n.removeAllRanges(),n.addRange(o)),r.match(/msie/)||H.execCommand("StyleWithCSS",!1,!1),"fontname"===t&&(N.isIE()?e=e.replace(/\\/g,""):H.execCommand("StyleWithCSS",!1,!0));try{H.execCommand(t,!1,e)}catch(i){console.log(i)}}return x.affectStyleAround(!1,!0),D},x.constructor.prototype.affectStyleAround=function(t,e){var o=x.getSelectedNode();if((o=o||t)&&0==e)return o.parent().is("[style]")&&o.attr("style",o.parent().attr("style")),o.is("[style]")&&o.find("*").attr("style",o.attr("style")),D;if(t&&e&&t.is("[style]")){var n=e.split(";");if("color"==(n=n[0].split(":"))[0]){var i=!1;t.find("*").each(function(t,e){(0==t&&L(this).attr("color")||L(this).parent().attr("color"))&&(i=!0),L(this).attr("color")||i||L(this).css(n[0],n[1])})}else t.is("[style*="+n[0]+"]")&&t.find("*").css(n[0],n[1]);x.selectText(t)}return D},x.constructor.prototype.selectText=function(t){if(l==I||!t)return D;t=t[0];var e,o=x.getWindowSelection();return C?(o.moveToElementText(t),o.select()):_typeof(t)==I||null==t||((e=H.createRange()).selectNodeContents(t),o.removeAllRanges(),o.addRange(e),L(t).is(":empty")&&(L(t).append("&nbsp;"),x.selectText(L(t)))),D},x.constructor.prototype.setNodeRange=function(t){if(_typeof(t)!=I){if(C)return D;try{var e,o=x.getWindowSelection();if(o.removeAllRanges(),a||N.isSafari())o.selectAllChildren(t);else{if((e=t.childNodes)&&0<e.length){for(var n=0;n<e.length;n++){var i;(i=H.createRange()).selectNode(e[n]),o.addRange(i)}return D}(i=H.createRange()).selectNode(t)}}catch(r){console.log(r)}return D}},x.constructor.prototype.getSelectText=function(t,e){var o,n="",i=x.getWindowSelection();return!C&&i.anchorNode&&i.getRangeAt&&(o=i.getRangeAt(0),e||t.data(R.Range,o),n=o.toString()),C&&l!=I&&(e||t.data(R.Range,i),n=i.htmlText),n},x.constructor.prototype.setSelectRange=function(t){if(null==t)return D;var e=x.getWindowSelection();return C?x.checkSelectionRange()&&H.selection.createRangeCollection(t):(e.removeAllRanges(),x.getWindowSelection().addRange(t)),D},x.constructor.prototype.setTagStyle=function(t){_typeof(t.styleName)==I&&(t.styleName=""),_typeof(t.styleValue)==I&&(t.styleValue="");var e=x.refuseStyle(t.styleName);return _typeof(e)==I&&(e=""),_typeof(t.tagName)!=I&&""!=t.tagName||(t.tagName="span"),t.tAttr="style",t.tVal=t.styleName+":"+t.styleValue+";"+e,x.replaceSelectedStyle(t)},x.constructor.prototype.replaceSelectedStyle=function(t){var e,o=t.tagName,n=t.tAttr,i=t.tVal,r=t.styleName,a=t.styleValue,l=t.editor,d=t.notCreateNewNode,s=t.attr2,c=t.attr2Value,u=t.command,f=t.createNewNodeAction,p=20,m=50,h="";if(!l)return console.log("replaceSelectedStyle err, editor = "+l),D;if(h=l.data(R.EndCheckClass),e=l.data(R.EditSignClass),_typeof(d)==I&&(d=!1),(w=(new Date).getTime())-P<p)return D;var g,v=l.data(R.HasRefreshClick),C=l.data(R.SignClassNum),E=l.find("."+l.data(R.EditSignClass)+C),B=L.trim(x.getSelectText(l,!0)).length,b=!!t.isSetLinkColor;if(!b&&!v&&0<E.length&&(0<B||d||L.browser.msie&&"9.0"==L.browser.version))return E.css(r,a),_typeof(s)!=I&&""!=s&&E.attr(s,c),"color"!=r&&"color"!=s||(0<(g=A.getEventCtrl().findTagInParent(E,"u",h)).length&&g.css(r,a),0<(g=A.getEventCtrl().findTagInParent(E,"a",h)).length&&g.css(r,a),E.find("a").css(r,a)),l.data(R.HasRsChildStyle)<m&&(l.data(R.HasRsChildStyle,parseInt(l.data(R.HasRsChildStyle))+1),E.find("*").css(r,""),"color"!=r&&"color"!=s||(A.getEventCtrl().removeElementProp({element:E,attrName:"color"}),M.styleChanged()),A.getEventCtrl().removeParentUselessNode({element:E,styleName:r,styleValue:a,endCheckClass:h})),x.setOrUnsetUnderline({command:u,element:E,editor:l,endCheckClass:h}),D;if(P=w,l.data(R.HasRefreshClick,!1),l.data(R.HasRsChildStyle,0),1==f)return D;var T,y,k,S,_=x.getWindowSelection();_.anchorNode&&_.getRangeAt&&(T=_.getRangeAt(0),y=H.createElement(o),0<E.length&&("&nbsp;"==E.html()?E.replaceWith(""):E.removeClass(e+C)),S=l.attr("style"),l.height(l.height()+"px"),C=parseInt(C)+1,l.data(R.SignClassNum,C),L(y).addClass(e+C),k=T.extractContents(),y.appendChild(k),l.attr("style",S),_typeof(s)!=I&&""!=s&&L(y).attr(s,c),T.insertNode(y),b&&L(y).parent().attr("color")?L(y).attr("style",""):L(y).attr("style","").css(r,a),u!=j.Underline&&("style"==n?x.affectStyleAround(L(y),i):x.affectStyleAround(L(y),!0)),x.setOrUnsetUnderline({command:u,element:L(y),editor:l,endCheckClass:h}))},x.constructor.prototype.setOrUnsetUnderline=function(t){var e,o=t.command,n=t.element,i=t.editor,r=t.endCheckClass;if(o==j.Underline){var a,l=!1,d=!1,s=!1,c=!1,u=!1,f="none",p="underline",m="text-decoration";if(elemenText=L.trim(n.text()),e=i.attr("style"),i.height(i.height()+"px"),0==(l=A.getEventCtrl().findTagInParent(n,"u",r))&&0==(d=0!=(d=A.getEventCtrl().findTagInParent(n,"a",r))&&d.css(m)!=f&&(s=d,!0))){var h=n.find("u");if(0<h.length&&L.trim(h.eq(0).text())==elemenText&&(c=!0),0==c){var g=n.find("a");u=0<g.length&&L.trim(g.eq(0).text())==elemenText&&g.eq(0).css(m)!=f}}if(x.setSelection(o),a={element:n,effectElement:"a",styleName:m,styleValue:f,elemenText:elemenText,endCheckClass:r},0!=l||0!=d||0!=c||0!=u)1==d&&L.trim(s.text())!=elemenText?(s.find("*").css(m,""),s.css(m)!=f?s.css(m,f):s.css(m,p)):A.getEventCtrl().setElementStyleEffectAll(a);else{var v=L("<u></u>");v.html(n.html()),n.html(v.prop("outerHTML")),A.getEventCtrl().setElementStyleEffectAll(a)}return x.setNodeRange(n[0]),i.attr("style",e),D}},x.constructor.prototype.popCursorLastDiv=function(t){var e=t.obj,o=t.editor;if(!t.checkOnfocused||!o.data(R.Onfocused))try{var n;if(!C)return void((n=E.getSelection()).selectAllChildren&&e[0]&&!N.isIE9()&&(n.selectAllChildren(e[0]),n.collapseToEnd()));if(H.selection)(n=H.selection.createRange()).moveToElementText(e[0]),n.collapse(!1),n.select()}catch(i){}}};return e=new t},this.getUICtrl=function(){if(o)return o;var t=function t(){};return o=new t}};F=new s;var f=function f(){var t,o=this;this.getEventCtrl=function(){if(t)return t;var e=function e(){var t=this;n.extend(this,F.getEventCtrl()),t.constructor.prototype.setSelection=function(){return console.log("rewrite setSelection"),o}};return t=new e},this.getUICtrl=function(){}};new f;var p=function p(){var t,e;this.getEventCtrl=function(){if(t)return t;var o=function o(t){var e=this;e.constructor.prototype.bindInputEvent=function(r){var a=r.element,n=r.module,l=r.editor,d=r.command,s=r.btn,c=r.option,u=12,f=120;s.find(".selectDivCover").unbind("mousewheel.selectDivCover").bind("mousewheel.selectDivCover",function(t,e){if(s.find(".fkEditor-formatBar").height()<=10)return!1;var o,n=s.find(".selectDiv span"),i=parseInt(n.attr("_value"));if(0<e){if(f<=i)return!1;i+=1}else{if(i<=u)return!1;i-=1}switch(n.attr("_value",i).text(i),d){case j.FontSize:c.btnModuleEdit||c.noSelectOption?((o={}).command=j.FontSize,o.val=i+"px",o.height=c.noSelectOption?c.noSelectOption.height:"",_EditBtnBase.getEventCtrl().selectChangeForBtnModuel(r,o)):F.getEventCtrl().setTagStyle({styleName:"font-size",styleValue:i+"px",editor:l,notCreateNewNode:!0,createNewNodeAction:!0});break;case j.LineHeight:F.getEventCtrl().setTagStyle({styleName:"line-height",styleValue:i+"px",editor:l,notCreateNewNode:!0,createNewNodeAction:!0})}return F.getEventCtrl().popCursorLastDiv({obj:a}),!1}),a.unbind("keyup").bind("keyup",function(t){t.stopPropagation();var e=L(this),o=e.html().replace(/\D/g,"");switch(f<o?(o=f,e.html(o),e.attr(U.Contenteditable)&&F.getEventCtrl().popCursorLastDiv({obj:e})):o<u&&(o=u),o=L.trim(o),s.find(".selectDiv span").attr("_value",o),d){case j.FontSize:c.btnModuleEdit||c.noSelectOption?(otherOption={},otherOption.command=j.FontSize,otherOption.val=o+"px",otherOption.height=c.noSelectOption?c.noSelectOption.height:"",_EditBtnBase.getEventCtrl().selectChangeForBtnModuel(r,otherOption)):(l.data(R.SelectedInputBlur)&&_EditToolBase.getEventCtrl().editToolLogDog({module:n,command:j.InputFontSize}),F.getEventCtrl().setTagStyle({styleName:"font-size",styleValue:o+"px",editor:l,notCreateNewNode:!0,createNewNodeAction:!0}));break;case j.LineHeight:l.data(R.SelectedInputBlur)&&_EditToolBase.getEventCtrl().editToolLogDog({module:n,command:j.InputLineHeight}),F.getEventCtrl().setTagStyle({styleName:"line-height",styleValue:o+"px",editor:l,notCreateNewNode:!0,createNewNodeAction:!0})}l.data(R.SelectedInputBlur,!1)}).unbind("keydown").bind("keydown",function(t){t.stopPropagation();var e=t.keyCode;if(13!=e&&116!=e||_EditToolBase.getEventCtrl().animateHideToolSecondPanel(c),F.getEventCtrl().isNumberPress(e)){var o=L(this).html().replace(/\D/g,"");"0"!=o||48!=e&&96!=e?3<o.length&&t.preventDefault():t.preventDefault()}else t.preventDefault()}).unbind("blur").bind("blur",function(t){t.stopPropagation(),l.data(R.SelectedInputBlur,!0)})},e.constructor.prototype.getWheelData=function(t){var e=t.find(".fkEditor-formats"),o=e.find(".fkEditor-formatContent"),n=e.find(".fkEditor-formatSlider"),i=o.find(".fkEditor-format"),r=e.height(),a=o.height(),l=n.height(),d=i.length-r/i.height(),s=a-r,c=r-l,u=c/d,f=s/d,p=o.position().top,m=n.position().top,h=1;return{c:o,s:n,ct:p,st:m,cs:f*h,ss:u*h,cm:s,sm:c}},e.constructor.prototype.bindMousewheelAndSlideEvent=function(t){var e,o,n=t.formatbar,i=t.toolbar;e=function e(){i.data(w.ScrollingMousedown)&&i.data(w.Scrolling,!0)},o=function o(){i.data(w.Scrolling,!1),i.data(w.ScrollingMousedown,!1)},n.find(".fkEditor-formatContent").mCustomScrollbar({theme:"select-theme",callbacks:{onScrollStart:e,onScroll:o}}),n.find(".mCSB_dragger_bar").unbind("mousemove.scrollTools").bind("mousemove.scrollTools",function(t){i.data(w.ScrollingMousedown,!0)}),n.find("a").click(function(){i.data(w.Scrolling,!1)}),n.unbind("mousewheel.formatbar").bind("mousewheel.formatbar",function(t,e){return!1})}};return t=new o},this.getUICtrl=function(){if(e)return e;var t=function t(){var s=this;s.constructor.prototype.createSelectedToolCoverDom=function(t){var e=[];return e.push("<div "+u+' class="selectDivCover"></div>'),e},s.constructor.prototype.createSelectedToolDom=function(t){t.option;var e=t.btn,o=t.reSetUnselectable,n=[],i=e.command,r=u;return o&&(r=o),n.push("<div "+r+' class="selectDiv selectDivNew">'),n.push("<span "+r+"></span>"),n.push("</div>"),n.push("<a "+r+' class="fkEditor-tool-icon fkEditor-tool-iconNew '+i+'-tool-icon">'),n.push("</a>"),r!=u&&n.push(s.createSelectedToolCoverDom(t).join("")),n},s.constructor.prototype.createSelectedSlideToolDom=function(t){var e=t.option,o=t.btn,n=[],i="formatDef",r=t.selectedData;n.push(s.createSelectedToolDom(t).join("")),n.push('<div class="'+e.css+"-formatBar "+e.css+'-formatBarNew"'+u+">"),n.push('<span class="selectedTip" title="当访客电脑未安装该款字体时，将显示为系统默认字体。">'),n.push('<span class="tipLeft">'),n.push("</span>"),n.push('<span class="tipRight">'),n.push("当访客电脑未安装该款字体时，将显示为系统默认字体。"),n.push("</span>"),n.push("</span>"),n.push('<div class="'+e.css+"-formats "+e.css+'-formatsNew fkEditorBar" '+u+">"),n.push('<div class="'+e.css+'-formatContent" '+u+">");for(var a=0;a<r.length;a++){var l="formatMg ",d="";0!=a&&(i=""),_typeof(r[a][3])!=I&&(l+=r[a][3],d=""),n.push("<a "+e.css+'-formatval="'+r[a][0]+'" '+e.css+'-formatName="'+r[a][1]+'" class="'+e.css+"-format  "+e.css+"-formatNew  "+i+'" role="menuitem" '+u+' title="'+d+'">'),_typeof(r[a][2])!=I&&n.push('<span class="'+r[a][2]+'"></span>'),n.push('<span style="position:relative; font-family:'+r[a][0]+'" class="'+l+'" '+u+">"+r[a][1]),n.push("</span>"),n.push("</a>")}return n.push("</div>"),n.push("</div>"),n.push("</div>"),_EditBtnBase.getUICtrl().createBtnToolDom({option:e,reSetUnselectable:t.reSetUnselectable,btn:o,toolContent:n.join("")})}};return e=new t}};_SelectedTool=new p;var D={},m=function m(){var e,t,v=this;this.getEventCtrl=function(){if(e)return e;var t=function t(){var m,h,w,l=this,d=[],i=[],P=!1;l.constructor.prototype.addBtnParam=function(t,e,o,n,i,r,a,l){return d.push({moduleName:t,command:e,key:o,tag:n,cls:i,emphasis:r,className:a,title:l})},l.constructor.prototype.getButtonsData=function(t){var e=t.option;return d&&0<d.length||(l.addBtnParam("EditColorBtn",j.Colors,"","","tool-colors",!1,"tool-color","颜色"),l.addBtnParam("EditHoverColorBtn",j.HoverColors,"","","tool-colors",!1,"tool-hover-color","悬停颜色"),l.addBtnParam("EditFormatsBtn",j.Formats,"","","tool-formats",!1,"","文字字体"),l.addBtnParam("EditFontSizeBtn",j.FontSize,"","","tool-fontSize",!1,"tool-size","文字大小"),l.addBtnParam("EditBreakLineBtn"),l.addBtnParam("EditBoldBtn",j.Bold,"B",["b","strong","h1","h2","h3","h4","h5","h6"],"tool-bold tool-boldNew",!0,"","加粗"),l.addBtnParam("EditItalicBtn",j.Italic,"I",["i","em"],"tool-italic",!0,"","斜体"),l.addBtnParam("EditUnderlineBtn",j.Underline,"U",["u"],"tool-underline",!0,"","下划线"),l.addBtnParam("EditWritingModeBtn",j.WritingMode,"","","tool-writingMode tool-writingModeNew",!1,"","文字排列方式"),l.addBtnParam("EditLineHeightBtn",j.LineHeight,"","","tool-lineHeight",!1,"","行高"),l.addBtnParam("EditTextAlignBtn",j.TextAlign,"","","tool-textAlign",!1,"","对齐方式"),l.addBtnParam("EditLinkBtn",j.Linkcreator,"L",["a"],"tool-linkcreator",!1,"","设置链接"),l.addBtnParam("EditRemoveFormatBtn",j.Removeformat,".","","tool-removeformat",!1,"","清除格式"),l.addBtnParam("EditSeperatorBtn")),l.getShowOrderBtn({btns:d,toolBtnOrder:e.Tool.ToolBtnOrder,option:e})},l.constructor.prototype.addHoverBtnParam=function(t,e,o,n){return i.push({moduleName:t,command:e,className:o,title:n})},l.constructor.prototype.getHoverShowButtons=function(t){var e=t.option;return i&&0<i.length||(l.addHoverBtnParam("EditContentBtn",j.EditContent,"tool-editContent tool-editContentNew","编辑文本"),l.addHoverBtnParam("EditFixedPositionBtn",j.EditPositionFixed,"tool-editPositionFixed","固定"),l.addHoverBtnParam("EditLogoDisplayBtn",j.EditLogoDisplay,"tool-editLogoDisplay","显示Logo"),l.addHoverBtnParam("EditBtnModuleStyleBtn",j.BtnModuleStyle,"tool-editModule f-tool-editModule","编辑按钮"),l.addHoverBtnParam("EditPhotoBtn",j.EditPhotoBtn,"f-tool-editPic tool-editPic","添加图片"),l.addHoverBtnParam("EditImgEffectBtn",j.ImgEffectBtn,"f-tool-hoverPic tool-hoverPic","模块特效"),l.addHoverBtnParam("EditPhotoShapeBtn",j.PhotoShapeBtn,"f-tool-picShape tool-picShape","图片形状"),l.addHoverBtnParam("EditSimpleLinkBtn",j.SimpleLinkBtn,"f-tool-link tool-link f-simple-tool-link","设置链接"),l.addHoverBtnParam("EditModuleTitleBtn",j.ModuleTitleBtn,"f-tool-edit-name tool-edit-name","模块标题"),l.addHoverBtnParam("EditDescribePicBtn",j.DescribePicBtn,"f-tool-description tool-description","图片描述"),l.addHoverBtnParam("EditFixedBtn",j.EditFixedBtn,"f-tool-fixed tool-fixed","固定"),l.addHoverBtnParam("EditAnimationBtn",j.Animation,"f-tool-animation tool-animation tool-animationNew","模块动画"),l.addHoverBtnParam("EditParallaxBtn",j.Parallax,"f-tool-parallax tool-parallax tool-parallaxNew","设置悬停视差"),l.addHoverBtnParam("EditBorderRadiusBtn",j.BorderRadius,"f-tool-borderRadius tool-borderRadius","圆角"),l.addHoverBtnParam("EditAltBtn",j.EditAlt,"f-tool-alt tool-alt","图片描述"),l.addHoverBtnParam("EditOpacityBtn",j.Opacity,"f-tool-opacity tool-opacity","透明度"),l.addHoverBtnParam("EditBorderBtn",j.Border,"f-tool-border tool-border","边框"),l.addHoverBtnParam("EditShadowBtn",j.Shadow,"f-tool-shadow tool-shadow","阴影"),l.addHoverBtnParam("EditGlobalLinkBtn",j.GlobalLink,"f-tool-link tool-link tool-linkNew","设置链接"),l.addHoverBtnParam("EditDeleteBtn",j.Delete,"f-tool-delete tool-delete tool-deleteNew","隐藏模块"),l.addHoverBtnParam("EditSeperatorBtn"),l.addHoverBtnParam("EditDynamicNumberBtn",j.EditDynamicNumber,"f-tool-number tool-number","编辑数字"),l.addHoverBtnParam("EditNumAnimationBtn",j.EditAnimation,"f-tool-numAnimation tool-numAnimation","设置动画"),l.addHoverBtnParam("EditPlayBtn",j.EditPlay,"f-tool-play tool-play","播放动画")),l.getShowOrderBtn({btns:i,toolBtnOrder:e.HoverTool.ToolBtnOrder,option:e})},l.constructor.prototype.getShowOrderBtn=function(t){for(var e=t.option,o=t.btns,n=t.toolBtnOrder,i=[],r=0;r<n.length;r++)for(var a=0;a<o.length;a++)if(o[a].moduleName==n[r]){"EditContentBtn"==o[a].moduleName?o[a].title=e.EditContentBtn.name:"EditDeleteBtn"==o[a].moduleName&&("logo"==e.moduleId?o[a].title="隐藏logo":o[a].title="隐藏模块"),i.push(o[a]);break}return i},l.constructor.prototype.buttonEmphasize=function(t){for(var e,o,n,i=t.option,r=t.buttons,a=t.editor,l=L("#"+i.css+"-toolBar-"+i.moduleId),d=l.find(".tool-formats"),s=l.find(".tool-fontSize"),c=s.find(".selectDiv span"),u=l.find(".tool-lineHeight"),f=l.find(".tool-color ."+i.css+"-tool-icon"),p=l.find(".tool-hover-color ."+i.css+"-tool-icon"),m=i.css+"-tool-depressedNew",h=i.css+"-tool-depressedNewHover",g=i.css+"-tool-depressedNewShow",v=i.moduleId,C=v.replace("module",""),E=Number(L(v).attr("_modulestyle")),B=0;B<r.length;B++)if(A.getEventCtrl().checkInArray(i.Tool.ToolBtnOrder,r[B].moduleName)){if(n=r[B].command,r[B].emphasis&&""!=r[B].tag){if(e=r[B].cls.split(" ")[0],!(o=F.getEventCtrl().detectElement({tags:r[B].tag})))switch(n){case j.Bold:["bold","700"].includes(F.getEventCtrl().detectElementCss("font-weight"))&&(o=!0);break;case j.Italic:"italic"==F.getEventCtrl().detectElementCss("font-style")&&(o=!0);break;case j.Underline:/underline/.test(F.getEventCtrl().detectElementCss("text-decoration"))&&(o=!0)}o?l.find("."+e).find("."+g).length<=0&&l.find("."+e).find("."+m).addClass(g).removeClass(h):l.find("."+e).find("."+m).removeClass(g).addClass(h)}if(n==j.TextAlign)switch(F.getEventCtrl().detectElementCss("text-align")){case"center":_EditTextAlignBtn.getEventCtrl().textAlignEmphasize({editor:a,toolbar:l,command:j.JustifyCenter});break;case"right":_EditTextAlignBtn.getEventCtrl().textAlignEmphasize({editor:a,toolbar:l,command:j.JustifyRight});break;case"justify":_EditTextAlignBtn.getEventCtrl().textAlignEmphasize({editor:a,toolbar:l,command:j.JustifyFull});break;default:_EditTextAlignBtn.getEventCtrl().textAlignEmphasize({editor:a,toolbar:l,command:j.JustifyLeft})}if(n==j.WritingMode){var b,T=F.getEventCtrl().getSelectedNode();if(!T||T.length<0)return;switch(T.hasClass("fk-editor")&&(T.hasClass("fk-editor-vertical-rl")?b="verticalToLeft":T.hasClass("fk-editor-vertical-lr")&&(b="verticalToRight")),b){case"verticalToRight":_EditWritingModeBtn.getEventCtrl().writtingModeEmphasize({editor:a,toolbar:l,command:j.VerticalToRight});break;case"verticalToLeft":_EditWritingModeBtn.getEventCtrl().writtingModeEmphasize({editor:a,toolbar:l,command:j.VerticalToLeft});break;default:_EditWritingModeBtn.getEventCtrl().writtingModeEmphasize({editor:a,toolbar:l,command:j.Horizontal})}}if(n==j.Colors){var y,k,S,_;y=F.getEventCtrl().detectElementCss("color"),k=_EditColorBtn.getEventCtrl().checkColorIsWhite(y),_="none"==(S=F.getEventCtrl().detectElementCss("background-image"));var x=M.getModuleAttrPattern(C),w="";x&&x.cl&&x.cl.hc&&(w=x.cl.hc),81===E&&!("rgba(255, 255, 255, 0)"===w||""===w)||(k&&_?f.css("border","solid 1px #ccc"):f.css("border","0px"),k&&_?f.css("background",y):_?f.css("background",y):f.css("background",S),f.removeClass("fk-colorPicker-transparentIco"))}if(n==j.HoverColors){var P=M.getModuleAttrPattern(C),D=P?P.cl.hc:"";_EditColorBtn.getEventCtrl().checkColorIsWhite(D)?p.css("border","solid 1px #ccc"):p.css("border","0px"),"rgba(255, 255, 255, 0)"===D?p.addClass("transparent"):p.removeClass("transparent"),p.css("background",D)}if(n==j.Formats){var H,I="font-family";i.EditFormatsBtn.selectedData;H=(H=(H=F.getEventCtrl().detectElementCss(I))&&"fontface"==H.split("__")[0]?M.analysisCustomFontFaceFamily(H).name:(0<H.indexOf(",")&&(H=H.substring(0,H.indexOf(","))),(H=H.replace(/"/g,"")).replace(/'/g,""))).replace(/^_/,""),O&&(O._data.fontFamily=H),d.attr("title",H)}if(n==j.FontSize){I="font-size";fontSize=F.getEventCtrl().detectElementCss(I),fontSize=parseInt(fontSize.replace("px","")),0<fontSize&&("true"==c.attr(U.Contenteditable)?s.find(".selectDiv span").attr("_value",fontSize).html(fontSize):s.find(".selectDiv span").attr("_value",fontSize).html(fontSize+"px"))}if(n==j.LineHeight){var N;I="line-height";N=(N=F.getEventCtrl().detectElementCss(I)).replace("px",""),isNaN(N)&&fontSize&&(N=fontSize),0<(N=parseInt(N))&&u.find(".selectDiv span").attr("_value",N)}}},l.constructor.prototype.bindToolBtnEvent=function(o){var n=o.option,i=o.editor,t=o.toolbar,e=(o.module,o.fkEditorWrap,t.find(".simpleTextEditTool .tool")),r=t.find(".editToolIcon"),a="mouseup.hoverToolButton";return c&&r.unbind(a).bind(a,function(t){t.stopPropagation()}),r.unbind("click.hoverToolButton").bind("click.hoverToolButton",function(){return o.thisBtnElement=this,l.hoverToolButtonClick(o),!1}),n.simpleTool||e.unbind("click.toolbutton").bind("click.toolbutton",function(t){if(i.data(R.HasRsChildStyle,0),_EditColorBtn.getEventCtrl().backTextSelectedStatus(o),L(".J_advanceColorPicker").hide(),c){var e=this;F.getEventCtrl().setSelectRange(i.data(R.Range)),o.thisBtnElement=e,n.btnModuleEdit||n.noSelectOption?l.toolButtonClickForBtnModuel(o):l.toolButtonClick(o)}else o.thisBtnElement=this,n.btnModuleEdit||n.noSelectOption?l.toolButtonClickForBtnModuel(o):l.toolButtonClick(o);return!1}),v},l.constructor.prototype.hoverToolButtonClick=function(i){var r,a=i.option,l=i.editor,d=i.module,t=i.fkEditorWrap,s=i.toolbar,e=i.thisBtnElement,o=L(e),c=a.moduleId.replace("module",""),n=o.attr("command"),u=500,f=a.btnModuleEdit,p=a.simpleTool,m=a.showLinkPanel,h=a.tipTitle,g=!0,v=500;switch(l.data(R.PreCommand,n),_EditToolBase.getEventCtrl().hideToolBarMask(),n){case j.EditContent:a.noSelectOption&&"dynamicNumber"===a.noSelectOption.module&&d.css("height",a.noSelectOption.height),M.getFontListAjax().then(function(t){if(O=new Vue({data:function o(){return{fontFamily:"",fontsList:t}},provide:function n(){return{args:i}}}).$mount("".concat(s.selector," .text_font_wrap")),D[l.attr("id")]=l.html()||"",l.data(R.TriggerClick)&&(l.data(R.TriggerClick,!1),g=!1),0<l.find(".editTip").length?l.data(R.PreHtmlContent,""):l.data(R.PreHtmlContent,l.html()),l.data(R.SimpleTextEdit,!0),l.data(R.HasRefreshClick,!0),l.removeData(R.Range,!0),s.css({width:a.Tool.width,height:a.Tool.height}),s.find(".simpleTextHoverTool").hide(),s.find(".simpleTextEditTool").fadeIn(u),l.css("cursor","text"),d.addClass("formLockEdit"),l.not(":focus")){var e=100;clearTimeout(w),w=setTimeout(function(){l.find(".editTip").remove(),l.attr(U.Contenteditable,!0).focus(),_EditBtnBase.getEventCtrl().buttonEmphasize(i)},e)}_EditToolBase.getEventCtrl().calcuToolBarPos(i),M.checkSimpleTextHideTool(a.moduleId),_EditToolBase.getEventCtrl().editToolBarMask(c),_EditWritingModeBtn.getEventCtrl().adjustWritingModeState(i),f&&((r={}).command=j.EditContent,_EditBtnBase.getEventCtrl().selectChangeForBtnModuel(i,r)),F.getEventCtrl().popCursorLastDiv({obj:l,editor:l,checkOnfocused:!0})});break;case j.EditPositionFixed:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),_EditFixedPositionBtn.getEventCtrl().checkPositionFixed({toolbar:s,btn:o,option:a}),_EditToolBase.getEventCtrl().calcuToolBarPos(i);break;case j.EditLogoDisplay:if(P)return;P=!0,_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),_EditLogoDisplayBtn.getEventCtrl().checkLogoDisplay({toolbar:s,btn:o,option:a}),setTimeout(function(){P=!1},v);break;case j.GlobalLink:if(l.attr(U.Contenteditable,!0),l.data(R.PreHtmlContent,l.html()),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),0<l.find(".editTip").length&&!f&&!p)return void N.ing("请输入内容",!0);if(a.globalJumpCtrlFun&&""!=a.globalJumpCtrlFun){var C,E={};p||(F.getEventCtrl().setNodeRange(l[0]),C=F.getEventCtrl().getSelectText(l,!1),E="corpTitle"==a.editorName?_EditLinkBtn.getEventCtrl().getCorpTitleLinkPreData():_EditLinkBtn.getEventCtrl().getGlobalLinkPreData(l,i)),m||p?(_EditGlobalLinkBtn.getEventCtrl().showGlobalLinkPanel(i),N.fkEval(a.globalJumpCtrlFun)):C&&""!=C&&(""==E._lide?(l.data(R.TriggerClick,!0),s.find(".tool-linkcreator").trigger("click"),setTimeout(function(){l.attr(U.Contenteditable,!1)},500)):(_EditGlobalLinkBtn.getEventCtrl().showGlobalLinkPanel(i),E._lname=E._lname||E._lurl,N.fkEval(a.globalJumpCtrlFun.replace("xxx",L.toJSON(E)))))}break;case j.BorderRadius:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),_EditBorderRadiusBtn.getEventCtrl().showBorderRadiusPanel(i);break;case j.Opacity:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),_EditOpacityBtn.getEventCtrl().showOpacityPanel(i);break;case j.Border:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),_EditBorderBtn.getEventCtrl().showBorderPanel(i);break;case j.Shadow:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),_EditShadowBtn.getEventCtrl().showShadowPanel(i);break;case j.EditAlt:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),a.altFunc&&""!=a.altFunc&&N.fkEval(a.altFunc);break;case j.Delete:_EditToolBase.getEventCtrl().deleteOrHideToolBar(a),a.deleteFun&&""!=a.deleteFun?N.fkEval(a.deleteFun):p||t.remove();break;case j.Animation:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),a.animationFun&&""!=a.animationFun&&N.fkEval(a.animationFun);break;case j.Parallax:a.editParallaxVueDom||(a.editParallaxVueDom=new Vue({data:function T(){var t=.4,e=1,o=d.attr("_pdir")||d.data("direction"),n=d.attr("_pdist")||d.data("distance");return{direction:void 0===o?e:o,distance:void 0===n?t:n}},methods:{handleStop:function y(t,e){a.editNumberOption.onSlider&&(a.editNumberOption.onSlider(a.moduleId,t,e),"direction"==e&&M.logDog(201287,0==t?9:10),"distance"==e&&M.logDog(201287,11))}}}).$mount(".J_parallaxPanel_".concat(a.moduleId))),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a,j.EditAnimation),_EditParallaxBtn.getEventCtrl().showParallaxPanel(i);break;case j.BtnModuleStyle:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),a.editModuleFun&&""!=a.editModuleFun&&N.fkEval(a.editModuleFun);break;case j.EditPhotoBtn:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),a.editPhotoFun&&""!=a.editPhotoFun&&N.fkEval(a.editPhotoFun);break;case j.ImgEffectBtn:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),a.imgEffectFun&&""!=a.imgEffectFun&&N.fkEval(a.imgEffectFun);break;case j.PhotoShapeBtn:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),a.photoShapeFun&&""!=a.photoShapeFun&&N.fkEval(a.photoShapeFun);break;case j.SimpleLinkBtn:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),a.simpleLinkFun&&""!=a.simpleLinkFun&&N.fkEval(a.simpleLinkFun);break;case j.ModuleTitleBtn:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a);var B=s.find(".tool-edit-name .fkEditor-moduleNameSlideBar"),b=N.top.$("#module"+c+"SideBtn").find(".g_sideBtn_c .g_sideBtn_tl").text();B.find(".J_module-name-input").val(b).focus(),_EditModuleTitleBtn.getEventCtrl().showModuleTitlePanel(i);break;case j.DescribePicBtn:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),s.find(".tool-description").find("#logoDescription").val(N.decodeHtml(N.top._logoData.des)).focus(),_EditDescribePicBtn.getEventCtrl().showDescribePicPanel(i);break;case j.EditFixedBtn:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),_EditFixedBtn.getEventCtrl().setFixedLogoBtnTitle({toolbar:s,btn:o,option:a}),a.fixedFun&&""!=a.fixedFun&&(N.fkEval(a.fixedFun),M.undoRun(function(){},{type:"logo",detail:"fixedClick",undoSame:!1,redoSame:!1,undoArgs:[{toolbar:s,btn:o,option:a}],redoArgs:[{toolbar:s,btn:o,option:a}],undoFn:function k(t){_EditFixedBtn.getEventCtrl().setFixedLogoBtnTitle(t),N.fkEval(a.fixedFun)},redoFn:function S(t){_EditFixedBtn.getEventCtrl().setFixedLogoBtnTitle(t),N.fkEval(a.fixedFun)}}));break;case j.EditDynamicNumber:a.editNumberVueDom||(a.editNumberVueDom=new Vue({data:function T(){return{module:d,startNumber:d.data("startNumber"),endNumber:d.data("endNumber"),useVisitors:d.data("useVisitors"),visitorVal:d.data("visitorVal")}},methods:{handleInputBlur:function _(t,e){if(("startNumber"===e?this.module.data("startNumber"):this.module.data("endNumber"))!==t){var o=a.editNumberOption.onBlur(a.moduleId,t,e);!1===o.setNumber&&("startNumber"===e?this.startNumber=o.preNumber:"endNumber"===e&&(this.endNumber=o.preNumber))}},handleCheckBoxChange:function x(t){a.editNumberOption.onCheck(a.moduleId,t),t?(this.startNumber=0,this.endNumber=this.visitorVal):(this.startNumber=this.module.data("startNumber"),this.endNumber=this.module.data("endNumber"))}}}).$mount(".numberPanel")),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a,j.EditDynamicNumber),_EditDynamicNumberBtn.getEventCtrl().showEditNumberPanel(i),a.editNumberCtrlFun&&""!==a.editNumberCtrlFun&&N.fkEval(a.editNumberCtrlFun);break;case j.EditAnimation:a.editNumAnimationVueDom||(a.editNumAnimationVueDom=new Vue({data:function T(){return{continued:d.data("continued"),delay:d.data("delay")}},methods:{handleStop:function y(t,e){a.editNumberOption.onSlider&&a.editNumberOption.onSlider(a.moduleId,t,e)}}}).$mount(".numAnimationPanel")),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a,j.EditAnimation),_EditNumAnimationBtn.getEventCtrl().showNumAnimationPanel(i);break;case j.EditPlay:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),a.editNumberOption.onPlay&&a.editNumberOption.onPlay&&a.editNumberOption.onPlay(a.moduleId,d.data("continued"),d.data("delay"))}h&&_EditToolBase.getEventCtrl().hideSimpleTip(s.find(".simpleTextHoverTool .tool .editToolIcon")),l.trigger("change"),g&&_EditToolBase.getEventCtrl().editToolLogDog({module:d,command:n})},l.constructor.prototype.toolButtonClick=function(t){var e=t.option,o=t.editor,n=t.module,i=t.toolbar,r=t.thisBtnElement,a=(i.find(".tool"),L(r).attr("command")),l=i.find(".tool-color ."+e.css+"-tool-icon"),d=!0;switch(o.not(":focus")&&o.attr(U.Contenteditable,!0).focus(),a==j.Removeformat&&o.data(R.HasRefreshClick,!0),_EditorBase.getEventCtrl().setEidtorSelectedRule({editor:o,command:a}),o.data(R.PreCommand,a),a){case j.Linkcreator:if(o.data(R.TriggerClick)&&(o.data(R.TriggerClick,!1),d=!1),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e),e.jumpCtrlFun&&""!=e.jumpCtrlFun&&!o.data(R.LinkHasClick)){var s=F.getEventCtrl().getSelectText(o,!0);linkPreData={},"corpTitle"==e.editorName?linkPreData=_EditLinkBtn.getEventCtrl().getCorpTitleLinkPreData():linkPreData=_EditLinkBtn.getEventCtrl().getLinkPreData(),o.data(R.LinkHasClick,!0),s&&""!=s&&g.fkEval(e.jumpCtrlFun.replace("xxx",L.toJSON(linkPreData))),clearTimeout(m),m=setTimeout(function(){o.data(R.LinkHasClick,!1)},2e3)}break;case j.Formats:_EditFormatsBtn.getEventCtrl().showFormatToolBar(t);break;case j.FontSize:_EditFontSizeBtn.getEventCtrl().showSizeToolBar(t);break;case j.LineHeight:_EditLineHeightBtn.getEventCtrl().showLineHiehgtToolBar(t);break;case j.Colors:if(_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e),M.colorPickerV2.show({base:i[0],initialColor:"none"==l.css("background-image")?l.css("background-color"):l.css("background-image"),defaultColor:"#000000",openGradientMode:!0,onChange:M.simpleTextSetTextColor,onHide:function p(){F.getEventCtrl().setSelectRange(o.data(R.Range))}}),M.simpleTextList.allEditors)for(var c=0;c<M.simpleTextList.allEditors.length;c++)if(M.simpleTextList.allEditors[c].moduleId==e.moduleId){M.simpleTextList.chooseEditor=M.simpleTextList.allEditors[c].editor;break}break;case j.Underline:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e),0<L.trim(F.getEventCtrl().getSelectText(o,!0)).length&&0<o.find("a").length?F.getEventCtrl().setTagStyle({editor:o,command:a}):F.getEventCtrl().setSelection(a);break;case j.Removeformat:if(_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e),L.trim(F.getEventCtrl().getSelectText(o,!1)).length==L.trim(o.text()).length)o.html(o.text());else{var u="20px",f=100;C&&F.getEventCtrl().setTagStyle({styleName:"font-size",styleValue:u,editor:o}),F.getEventCtrl().setSelection(a),F.getEventCtrl().setSelection("Unlink"),clearTimeout(h),h=setTimeout(function(){F.getEventCtrl().setSelection("removeformat")},f),(n.find(".fk-editor-vertical-rl").length<1||n.find(".fk-editor-vertical-lr").length<1)&&_EditorBase.getEventCtrl().setEditorAutoHeight(e.moduleId)}break;case j.TextAlign:_EditTextAlignBtn.getEventCtrl().showTextAlignBtnPanel(t);break;case j.WritingMode:_EditWritingModeBtn.getEventCtrl().showWritingModePanel(t);break;default:F.getEventCtrl().setSelection(a),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e)}return o.data(R.ClearSpanCursoring)||(o.trigger("change"),o.data(R.ClearSpanCursoring,!0),o.find("span").css("cursor",""),setTimeout(function(){o.data(R.ClearSpanCursoring,!1)},300)),setTimeout(function(){a!=j.Underline&&a!=j.Bold&&a!=j.Italic&&a!=j.Removeformat||_EditBtnBase.getEventCtrl().buttonEmphasize(t),0<L.trim(F.getEventCtrl().getSelectText(o,!0)).length&&F.getEventCtrl().getSelectText(o,!1)},100),d&&_EditToolBase.getEventCtrl().editToolLogDog({module:n,command:a}),v},l.constructor.prototype.toolButtonClickForBtnModuel=function(t){var a=t.option,e=t.editor,o=t.module,l=a.moduleId.replace("module",""),n=t.toolbar,i=t.thisBtnElement,r=(n.find(".tool"),L(i).attr("command")),d=n.find(".tool-color ."+a.css+"-tool-icon");if(hoverColorBar=n.find(".tool-hover-color ."+a.css+"-tool-icon"),M.isVueStyleGrayTest(l))var s=N.top.Site.getModuleAttrPattern(l).cl;else s=N.top.Site.getModuleAttrPattern(l).contentLink;var c=a.noSelectOption&&a.noSelectOption.className?".".concat(a.noSelectOption.className):"";switch(F.getEventCtrl().setNodeRange(e[0]),e.not(":focus")&&e.attr(U.Contenteditable,!0).focus(),e.data(R.PreCommand,r),r){case j.Formats:_EditFormatsBtn.getEventCtrl().showFormatToolBar(t);break;case j.FontSize:_EditFontSizeBtn.getEventCtrl().showSizeToolBar(t);break;case j.Colors:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a);var u=function u(t,e,o){for(var n=0;n<e.length;n++)e[n].value?o.push({cls:t,key:e[n].key,value:e[n].value}):o.push({cls:t,key:e[n].key})},f=function f(){var t=0<arguments.length&&arguments[0]!==I?arguments[0]:"",e=1<arguments.length&&arguments[1]!==I?arguments[1]:[],o=[];if(0===t.length||0===e.length)return o;if(Array.isArray(t))for(var n=0;n<t.length;n++){var i=t[n];u(i,e,o)}else"string"==typeof t&&u(t,e,o);return o},p=function p(t,e){var o=e||t,n=a.noSelectOption?".".concat(a.noSelectOption.className):".m_float_btn__text";".fk-editor-break-dynamic-number"===n&&(n=[".floatdynamic",".floatdynamic .fk-editor-break-dynamic-number"]),_EditColorBtn.getEventCtrl().checkColorIsWhite(o)?d.css("border","solid 1px #ccc"):d.css("border","0px"),d.css("background",o),s.y=1,s.fct=1,Vue.set(s,"c",o),N.top.Site.getModuleAttrPattern(l).changed=!0;var i=[{key:"background-image",value:o},{key:"-webkit-background-clip",value:"text"},{key:"-webkit-text-fill-color",value:"transparent"}],r=[{key:"background-image",value:null},{key:"-webkit-background-clip",value:null},{key:"-webkit-text-fill-color",value:null}];-1<o.indexOf("linear-gradient")?(M.setModuleStyleCssList(l,f(n,i)),M.removeModuleStyleCssList(l,f(n,[{key:"color",value:null}]))):(M.setModuleStyleCssList(l,f(n,[{key:"color",value:o}])),M.removeModuleStyleCssList(l,f(n,r))),M.styleChanged()};M.colorPickerV2.show({base:n[0],initialColor:"none"==d.css("background-image")?d.css("background-color"):d.css("background-image"),defaultColor:"#000000",openGradientMode:!0,onChange:p,onChangeStop:function g(t,e){M.undoRun(p,{type:"module.floatBtn",detail:"floatBtnTextColor",id:l,doArgs:[t],undoArgs:[e]})}}),F.getEventCtrl().getWindowSelection().removeAllRanges();break;case j.HoverColors:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a);var m=function m(t,e){var o=e||t,n=a.noSelectOption?".".concat(a.noSelectOption.className):".m_float_btn__text";".fk-editor-break-dynamic-number"===n&&(n=[".floatdynamic",".floatdynamic .fk-editor-break-dynamic-number"]),_EditColorBtn.getEventCtrl().checkColorIsWhite(o)?hoverColorBar.css("border","solid 1px #ccc"):hoverColorBar.css("border","0px"),"rgba(255, 255, 255, 0)"===o?hoverColorBar.addClass("transparent"):hoverColorBar.removeClass("transparent"),hoverColorBar.css("background",o),s.y=1,s.fct=1,Vue.set(s,"hc",o),N.top.Site.getModuleAttrPattern(l).changed=!0,M.styleChanged()},h="none"==hoverColorBar.css("background-image")?hoverColorBar.css("background-color"):hoverColorBar.css("background-image");M.colorPickerV2.show({base:n[0],initialColor:h,defaultColor:"",openGradientMode:!0,onChange:m}),F.getEventCtrl().getWindowSelection().removeAllRanges();break;case j.Underline:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),M.undoRun(function(t,e){N.top.Site.getModuleAttrPattern(t).changed=!0;var o=M.isVueStyleGrayTest(t);if(o)var n=N.top.Site.getModuleAttrPattern(t).cl;else n=N.top.Site.getModuleAttrPattern(t).contentLink;e?(n.d=1,n.y=1):n.d=0,o||(c?M.setModuleStyleCssList(t,[{cls:".lightModuleOuterContent".concat(t," ").concat(c),key:"text-decoration",value:e?"underline":"none"}]):M.setModuleStyleCssList(t,[{cls:".lightModuleOuterContent"+t+" a",key:"text-decoration",value:e?"underline":"none"},{cls:".lightModuleOuterContent"+t+" .pagenation_N a span",key:"text-decoration",value:e?"underline":"none"}]))},{type:"module.floatBtn",detail:"floatBtnUnderLine",id:l,doArgs:[l,!s.d],undoArgs:[l,s.d],redoArgs:[l,!s.d]}),M.styleChanged();break;case j.Bold:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),M.undoRun(function(t,e){var o;N.top.Site.getModuleAttrPattern(t).changed=!0;var n=M.isVueStyleGrayTest(t);o=n?N.top.Site.getModuleAttrPattern(t).cl:N.top.Site.getModuleAttrPattern(t).contentLink,e?(o.b=1,o.y=1):o.b=0,n||M.setModuleStyleCssList(t,[{cls:".lightModuleOuterContent"+t+" a",key:"font-weight",value:e?"bold":"normal"}])},{type:"module.floatBtn",detail:"floatBtnBold",id:l,doArgs:[l,!s.b],undoArgs:[l,s.b],redoArgs:[l,!s.b]}),M.styleChanged();break;case j.Italic:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a),M.undoRun(function(t,e){if(N.top.Site.getModuleAttrPattern(t).changed=!0,M.isVueStyleGrayTest(t))var o=N.top.Site.getModuleAttrPattern(t).cl;else o=N.top.Site.getModuleAttrPattern(t).contentLink;e?(o.i=1,o.y=1):o.i=0,M.setModuleStyleCssList(t,[{cls:".lightModuleOuterContent"+t+" a",key:"font-style",value:e?"italic":"normal"}])},{type:"module.floatBtn",detail:"floatBtnItalic",id:l,doArgs:[l,!s.i],undoArgs:[l,s.i],redoArgs:[l,!s.i]}),M.styleChanged();break;default:_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a)}return e.data(R.ClearSpanCursoring)||(e.trigger("change"),e.data(R.ClearSpanCursoring,!0),e.find("span").css("cursor",""),setTimeout(function(){e.data(R.ClearSpanCursoring,!1)},300)),setTimeout(function(){r!=j.Underline&&r!=j.Bold&&r!=j.Italic||_EditBtnBase.getEventCtrl().buttonEmphasize(t)},100),_EditToolBase.getEventCtrl().editToolLogDog({module:o,command:r}),v},l.constructor.prototype.selectChangeForBtnModuel=function(t,e){var o=t.option,n=t.editor,i=t.module,r=o.moduleId.replace("module",""),a=e.command,l=e.val;if(M.isVueStyleGrayTest(r))var d=N.top.Site.getModuleAttrPattern(r).cl;else d=N.top.Site.getModuleAttrPattern(r).contentLink;var s=e.height;switch(a){case j.Formats:var c=n.css("font-family");d.y=1,d.f=l,N.top.Site.getModuleAttrPattern(r).changed=!0,l=(l=l.replace(/"/g,"")).replace(/'/g,""),n.css("font-family",l),M.styleChanged(),M.undoRun(function(){},{type:"module.floatBtn",detail:"floatBtnFormats",id:r,undoSame:!1,redoSame:!1,undoArgs:[n,c],redoArgs:[n,l],undoFn:function f(t,e){t.css("font-family",e)},redoFn:function p(t,e){t.css("font-family",e)}});break;case j.FontSize:var u=n.css("font-size");s&&n.css("height",s),n.css("font-size",l),d.y=1,d.ls=l.replace("px",""),N.top.Site.getModuleAttrPattern(r).changed=!0,M.styleChanged(),M.undoRun(function(){},{type:"module.floatBtn",detail:"floatBtnFontSize",id:r,undoSame:!1,redoSame:!1,undoArgs:[n,u],redoArgs:[n,l],undoFn:function f(t,e){t.css("font-size",e)},redoFn:function p(t,e){t.css("font-size",e)}});break;case j.EditContent:n.focus(function(){L(this).css("white-space","normal")}).focusout(function(){L(this).css("white-space","nowrap")}),i.find(".ui-resizable-handle").show(),N.top.$(H).off("click.btnToolHide").on("click.btnToolHide",function(){n.attr(U.Contenteditable)||i.unbind("mouseout.showResizable")}),i.bind("mouseout.showResizable",function(){i.find(".ui-resizable-handle").show()})}}};return e=new t},this.getUICtrl=function(){if(t)return t;var e=function e(){var t=this;t.constructor.prototype.createHoverBtnToolDom=function(t){var e=t.option,o=t.btn,n=t.btnContent,i=[],r="",a="";return e.tipTitle?a=' data-title-tip="'+o.title+'" ':r=' title="'+o.title+'" ',i.push('<div command="'+o.command+'" class="tool f-tool editTool '+o.className+'" role="button" '+u+" "+r+" >"),n?i.push(n):i.push("<a "+u+' class="editToolIcon f-editToolIcon" command ="'+o.command+'" '+a+" ></a>"),i.push("</div>"),i},t.constructor.prototype.createBtnToolDom=function(t){var e=t.option,o=t.btn,n=t.toolContent,i=t.reSetUnselectable,r=[],a=u;return i&&(a=i),r.push('<div command="'+o.command+'" class="tool '+o.cls+" "+o.className+'" role="button" data-tool="'+o.cls+'" '+a+' title="'+o.title+'">'),n?r.push(n):r.push("<a "+a+' class="fkEditor-tool-icon"></a>'),_typeof(o.emphasis)!=I&&o.emphasis&&r.push('<div class="'+e.css+"-tool-depressedNew "+e.css+'-tool-depressedNewHover"></div>'),r.push("</div>"),r}};return t=new e}};_EditBtnBase=new m;var O=null,h=function h(){var e,t,x=this;this.getEventCtrl=function(){if(e)return e;var t=function t(){var T,y,k,S,_,c=this;c.constructor.prototype.bindToolAndEditorCreatedEvent=function(t){return _EditGlobalLinkBtn.getEventCtrl().bindGlobalLinkPanelEvent(t),_EditBorderRadiusBtn.getEventCtrl().bindBorderRadiusPanelEvent(t),_EditOpacityBtn.getEventCtrl().bindOpacityPanelEvent(t),_EditModuleTitleBtn.getEventCtrl().bindModuleTitlePanelEvent(t),_EditDescribePicBtn.getEventCtrl().bindDescribePicPanelEvent(t),_EditBorderBtn.getEventCtrl().bindBorderPanelEvent(t),_EditShadowBtn.getEventCtrl().bindShadowPanelEvent(t),_EditFormatsBtn.getEventCtrl().bindFormatSliderEvent(t),_EditFontSizeBtn.getEventCtrl().bindFontSizeEvent(t),_EditLineHeightBtn.getEventCtrl().bindLineHeihgtSliderBarEvent(t),_EditTextAlignBtn.getEventCtrl().bindTextAlignSliderBarEvent(t),_EditWritingModeBtn.getEventCtrl().bindWrittingModeSliderBarEvent(t),_EditRadiusBtn.getEventCtrl().bindRadiusBtnEvent(t),_EditBtnBase.getEventCtrl().bindToolBtnEvent(t),c.bindToolBarEvent(t),_FkEditor.getEventCtrl().bindEditorEvent(t),_EditDynamicNumberBtn.getEventCtrl().bindDynamicNumberPanelEvent(t),x},c.constructor.prototype.bindSimpleToolCreatedEvent=function(t){return _EditGlobalLinkBtn.getEventCtrl().bindGlobalLinkPanelEvent(t),_EditBorderRadiusBtn.getEventCtrl().bindBorderRadiusPanelEvent(t),_EditOpacityBtn.getEventCtrl().bindOpacityPanelEvent(t),_EditModuleTitleBtn.getEventCtrl().bindModuleTitlePanelEvent(t),_EditDescribePicBtn.getEventCtrl().bindDescribePicPanelEvent(t),_EditBorderBtn.getEventCtrl().bindBorderPanelEvent(t),_EditShadowBtn.getEventCtrl().bindShadowPanelEvent(t),_EditRadiusBtn.getEventCtrl().bindRadiusBtnEvent(t),_EditBtnBase.getEventCtrl().bindToolBtnEvent(t),c.bindToolBarEvent(t),x},c.constructor.prototype.showToolBar=function(t){var e=t.option,o=t.editor,n=t.module,i=L("#fkEditor-toolBar-"+e.moduleId);if(!M.checkNestModule(n).inSubNav||N.top._subNavPackEdit){var r=M.hasPopupModuleOpen();if((!M.checkNestModule(n).inPopupZone||r&&r.editing)&&!(n.hasClass("fixed_project")||"fk-webHeaderZone"===M.checkNestModule(n).realParentId&&L(".webHeaderFixed").length)){var a=L(n).data("imgHoverEft"),l=i.data("imageCalcuToolBarPos"),d=e.moduleId.match(/\d/g),s=d?M.getModuleAttrModuleData(parseInt(d.join(""))).style:0;a&&1<a.effType&&79===s?l||(i.data("imageCalcuToolBarPos","true"),i.length&&c.calcuToolBarPos(t)):c.calcuToolBarPos(t),c.calcuPanelPosForRight(t),n.data(R.HoverToolOn,!0),o.data(R.SimpleTextEdit)||(c.checkEditItemDisplay(t),i.find(".simpleTextEditTool").hide(),i.find(".simpleTextHoverTool").show())}}},c.constructor.prototype.calcuToolBarPos=function(t){var e,o,n,i,r=t.option,a=t.editor,l=L("#fkEditor-toolBar-"+r.moduleId),d=_EditorBase.getEventCtrl().getModule({option:r}),s=L("#web").offset(),c=d.offset(),u=c.top,f=L(H).width(),p=c.left,m=L(".floatLeftTop")[0].getBoundingClientRect().top,h=8,g=M.checkNestModule(d);return l.css({left:0,top:0}),L("#topAdvArea").is(":visible")&&L("#topAdvArea").height(),r.btnModuleEdit&&(h+=6),o=p+(e=l.outerWidth()+2)-f,r.HoverTool&&r.HoverTool.show||(simpleTextEdit=!0),a.data(R.SimpleTextEdit)?toolBarHeight=parseInt(r.Tool.height.replace("px","")):toolBarHeight=parseInt(r.HoverTool.height.replace("px","")),p-=s.left,l.data(R.FixRight,!1),0<o&&(p=p-o-20,l.data(R.FixRight,!0)),f<p+e+135&&l.data(R.FixRight,!0),r.noSelectOption&&"dynamicNumber"===r.noSelectOption.module&&l.data(R.FixRight,!0),i=(p=p<0?0:p)+"px",(n=parseInt(u-s.top)-(toolBarHeight+h))+m<L(".floatLeftTop").offset().top&&(n=parseInt(u+d.outerHeight()-m)+"px"),g.inPopupZone&&(n=parseInt(u)-(toolBarHeight+h)+"px",toolBarHeight+h>u&&(n=parseInt(u+d.outerHeight()+h)+"px")),l.css({display:"block",top:n,left:i}).addClass("J_fkEditor_tool").data(R.ModuleId,r.moduleId),(d.data("corpTitle")||d.data("logo"))&&((N.top._logoPositionFixTop||N.top._titlePositionFixTop)&&u<=m?l.css({top:parseInt(u+d.outerHeight())+"px",position:"fixed"}):l.css({position:"absolute"})),x},c.constructor.prototype.calcuPanelPosForRight=function(t){var e,o,n,i,r=t.option,a=(t.editor,L("#fkEditor-toolBar-"+r.moduleId)),l=a.find(".simpleTextHoverTool .fkEditorBar"),d=38,s=2,c=-2,u=a.height();a.data("fixRight")?(a.find(".tool .slideDiv").addClass("f-slideDiv-right"),l.each(function(){if(e=L(this).innerWidth(),s=2,c=1,L(this).hasClass("borderPanel")?n=_EditBorderBtn._panelHeight:L(this).hasClass("opacityPanel")?n=_EditOpacityBtn._panelHeight:L(this).hasClass("linkPanel")?(n=_EditGlobalLinkBtn._panelHeight,c=5):L(this).hasClass("shadowPanel")?n=_EditShadowBtn._panelHeight:L(this).hasClass("J_moduleNamePanel")?n=_EditModuleTitleBtn._panelHeight:L(this).hasClass("descPanel")?n=_EditDescribePicBtn._panelHeight:L(this).hasClass("borderRadiusPanel")?n=_EditBorderRadiusBtn._panelHeight:L(this).hasClass("numberPanel")?(n=_EditDynamicNumberBtn._panelHeight,c=-50,s+=10):L(this).hasClass("numAnimationPanel")&&(n=_EditNumAnimationBtn._panelHeight,s+=10),i=-n,o=-(e-d),!isNaN(n)&&0<n&&L(this).css({top:i-s+"px",left:o-c+"px"}),r.noSelectOption&&"dynamicNumber"===r.noSelectOption.module){var t=L(this).parents(".tool").offset().left-a.offset().left;a.offset().top-n<=60?L(this).css({top:u+"px",left:-t+"px"}):L(this).css({left:-t+"px"})}})):(l.css({left:"6px",top:"46px"}),a.find(".simpleTextHoverTool .linkPanel").css({left:"2px",top:"46px"}),a.find(".tool .slideDiv").removeClass("f-slideDiv-right"))},c.constructor.prototype.checkEditItemDisplay=function(t){var e,o,n=t.option,i=t.toolbar,r=i.find(".tool-animation"),a=n.moduleId;return"function"==typeof n.animationStatusFun&&1==n.animationStatusFun(a.replace("module",""))?(r.show(),e=n.HoverTool.animationShowWidth,"simpleText"==n.editorName&&(e=M.canShowParallaxBtn(L("#".concat(a)))?"225px":"186px")):(r.hide(),e=n.HoverTool.width),i.css("width",e),i.css("height",n.HoverTool.height),(o=i.find(".tool-edit-name"))&&0<o.length&&(0==M.getSideStatus(a)?o.is(":hidden")&&o.show():o.is(":hidden")||o.hide()),x},c.constructor.prototype.bindToolBarEvent=function(e){var o=e.option,n=e.module,i=e.editor,r=e.toolbar;r.addClass("editorHoverShowTool").unbind("mouseover.hoverShowTool").bind("mouseover.hoverShowTool",function(t){_EditorBase.getEventCtrl().checkEditorEditable(e)&&(n.data(R.HoverToolOn,!0).trigger("mouseover"),r.css("display","block").addClass("J_fkEditor_tool").data(R.ModuleId,o.moduleId)),clearTimeout(i.data(R.HoverToolTimeout)),clearTimeout(i.data(R.EditLineTimeout)),n.mouseenter()}).unbind("mouseleave.hoverShowTool").bind("mouseleave.hoverShowTool",function(t){(n.find(".fk-editor-vertical-rl").length<1||n.find(".fk-editor-vertical-lr").length<1)&&n.trigger("mouseleave"),n.data(R.HoverToolOn,!1)}).off("click.hoverShowTool").on("click.hoverShowTool",function(t){t.stopPropagation()}),o.simpleTool||r.find(".simpleTextEditTool").not(".tool").off("click.notBtnClick").on("click.notBtnClick",function(){return _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o),_typeof(i.data(R.Range))!=I&&F.getEventCtrl().setSelectRange(i.data(R.Range)),!1});var t=M.checkNestModule(n);t.inSubNav?r.addClass("showInSubNavPack"):t.inPopupZone&&r.addClass("showInPopupZone")},c.constructor.prototype.deleteToolWrapDom=function(t){var e=1e3,o=t.deleteToolBar,n=t.option;return o&&setTimeout(function(){var t=n;o.is(":visible")||(L(H).unbind("mouseup.fkTool"+t.moduleId),c.deleteOrHideToolBar(t))},e),x},c.constructor.prototype.deleteOrHideToolBar=function(t){var e,o=L("#"+t.css+"-toolBar-"+t.moduleId),n=_EditorBase.getEventCtrl().getModule({option:t}),i=n.find("."+t.css);if(t.btnModuleEdit&&(!(i=n.find("#"+t.moduleId+"FlBtn"))||i.length<=0)&&(i=n.find(".J_floatBtnBox .floatBtn")),_typeof(o)!=I&&(t.isHideToolBar?o.hide():(t.editNumberVueDom=null,t.editNumAnimationVueDom=null,t.editParallaxVueDom=null,o.remove(),o=null),i.data(R.HasRemoveUselessChild)||(e=i.attr("style")||"",i.height(i.height()+"px"),i.data(R.RemoveUselessChildIng,!0),A.getEventCtrl().removeUselessChildStyle(i,i),i.data(R.RemoveUselessChildIng,!1),setTimeout(function(){i.data(R.HasRemoveUselessChild,!0)},500),i.attr("style",e))),_typeof(n)!=I&&!t.simpleTool){M.setSimpleEditorBlur(n,i),E.getSelection&&E.getSelection().removeAllRanges(),fkEditorLine=n.find(".fk-editor-line"),fkEditorLine.hasClass("fk-editor-bd")&&(fkEditorLine.addClass("fk-editor-bdNone"),fkEditorLine.removeClass("fk-editor-bd"));var r=i.html();D[i.attr("id")]&&D[i.attr("id")]!==r&&(M.undoRun(function(){},{undoSame:!1,redoSame:!1,undoArgs:[i.attr("id"),D[i.attr("id")],t.showEditTipWord,t.editTipWord],redoArgs:[i.attr("id"),r,t.showEditTipWord,t.editTipWord],undoFn:function a(t,e,o,n){var i=L("#"+t);i.html(e),e.length<=0&&(o?i.html('<div class="editTip">'+n+"</div>"):i.html(n))},redoFn:function l(t,e){var o=L("#"+t);o.html(e),e.length<=0&&(showEditTipWord?o.html('<div class="editTip">'+editTipWord+"</div>"):o.html(editTipWord))}}),D[i.attr("id")]=null),L.trim(i.text()).length<=0&&(t.showEditTipWord?i.html('<div class="editTip">'+t.editTipWord+"</div>"):i.html(t.editTipWord))}},c.constructor.prototype.animateHideToolSecondPanel=function(t,e){var o,n,i,r,a,l,d,s,c,u,f,p,m,h,g,v,C=L("#"+t.css+"-toolBar-"+t.moduleId),E=200;if(!C.data(w.Scrolling)){if(e!=j.BorderRadius&&($borderRadiusPanel=C.find(".tool-borderRadius").find(".borderRadiusPanel"),0<$borderRadiusPanel.height()&&($borderRadiusPanel.removeClass("f-borderRadiusPanel-show"),C.find(".tool-borderRadius").find(".slideDiv").removeClass("slideDivBorder"))),e!=j.Opacity&&0<(n=C.find(".tool-opacity").find(".opacityPanel")).height()&&(n.removeClass("f-opacityPanel-show"),C.find(".tool-opacity").find(".slideDiv").removeClass("slideDivBorder")),e!=j.ModuleTitleBtn&&0<(a=C.find(".tool-edit-name").find(".J_moduleNamePanel")).height()&&(a.removeClass("f-moduleNamePanel-show"),C.find(".tool-edit-name").find(".slideDiv").removeClass("slideDivModuleName")),e!=j.DescribePicBtn&&0<(l=C.find(".tool-description").find(".descPanel")).height()&&(l.removeClass("f-descPanel-show"),C.find(".tool-description").find(".slideDiv").removeClass("slideDivDesc")),e!=j.Border&&0<(i=C.find(".tool-border").find(".borderPanel")).height()&&(i.removeClass("f-borderPanel-show"),C.find(".tool-border").find(".slideDiv").removeClass("slideDivBorder")),e!=j.Parallax){var B=C.find(".tool-parallax");parallaxPanel=B.find(".parallaxPanel"),0<parallaxPanel.height()&&(B.find(".parallaxSlideBar").removeClass("parallaxSlideBar-show"),parallaxPanel.removeClass("f-parallaxPanel-show"))}if(e!=j.Shadow&&0<(r=C.find(".tool-shadow").find(".shadowPanel")).height()&&(r.removeClass("f-shadowPanel-show"),C.find(".tool-shadow").find(".slideDiv").removeClass("slideDivShadow")),e!=j.GlobalLink&&0<(o=C.find(".tool-link").find("."+t.css+"-linkSlideBar")).height()&&(o.removeClass("linkPanelSlide"),clearTimeout(S),S=setTimeout(function(){C.find(".tool-link").find(".slideDiv").removeClass("slideDivBorder"),o.find(".fkEditorBar").removeClass("fkEditorBarBorder")},E)),e!=j.Formats&&L(".tool-formats .tabs-select__tabs").stop().slideUp(300,"linear"),e!=j.FontSize&&0<(c=C.find(".tool-fontSize").find("."+t.css+"-formatBar")).height()&&((u=C.find(".tool-fontSize").find(".selectDiv")).find("span").attr(U.Contenteditable,!1),c.removeClass("formatBarSlideDown"),clearTimeout(T),T=setTimeout(function(){u.find("span").html(u.find("span").attr("_value")+"px"),c.parent().find(".fkEditor-tool-iconNew").removeClass("edTriangleOnNew")},E)),e!=j.LineHeight&&0<(f=C.find(".tool-lineHeight").find("."+t.css+"-formatBar")).height()&&((p=C.find(".tool-lineHeight").find(".selectDiv")).find("span").attr(U.Contenteditable,!1),f.removeClass("formatBarSlideDown"),clearTimeout(y),y=setTimeout(function(){p.addClass("selectDivNew"),p.find("span").html(""),f.parent().find(".fkEditor-tool-iconNew").removeClass("edTriangleOnNew")},E)),e!=j.WritingMode&&0<(g=C.find(".tool-writingMode").find("."+t.css+"-formatBar")).height()&&(v=C.find(".tool-writingMode").find(".selectDiv"),g.removeClass("formatBarSlideDown writingModeSlideDown"),clearTimeout(_),_=setTimeout(function(){v.addClass("selectDivNew"),g.parent().find(".fkEditor-tool-iconNew").removeClass("edTriangleOnNew")},E)),e!=j.TextAlign&&0<(m=C.find(".tool-textAlign").find("."+t.css+"-formatBar")).height()&&(h=C.find(".tool-textAlign").find(".selectDiv"),m.removeClass("formatBarSlideDown textAlignSlideDown"),clearTimeout(k),k=setTimeout(function(){h.addClass("selectDivNew"),m.parent().find(".fkEditor-tool-iconNew").removeClass("edTriangleOnNew")},E)),e!=j.EditDynamicNumber&&0<(d=C.find(".tool-number").find("."+t.css+"-numberSlideBar")).height()&&d.removeClass("numberPanelSlide"),e!=j.EditAnimation){var b=C.find(".tool-numAnimation");0<(s=b.find(".numAnimationPanel")).height()&&(b.find(".numAnimationSlideBar").removeClass("numAnimationSlideBar-show"),s.removeClass("f-numAnimationPanel-show"))}return L(".J_faiColorPickerAlp").is(":visible")&&L(".J_faiColorPickerAlp").slideUp(E),x}},c.constructor.prototype.isShowHoverToolPanel=function(t){var e=!1;return 0<t.find(".tool-link").find(".fkEditor-linkSlideBar").height()&&(e=!0),0<t.find(".tool-borderRadius").find(".borderRadiusPanel").height()&&(e=!0),0<t.find(".tool-opacity").find(".opacityPanel").height()&&(e=!0),0<t.find(".tool-border").find(".borderPanel").height()&&(e=!0),0<t.find(".tool-shadow").find(".shadowPanel").height()&&(e=!0),t.find(".setRadiusBar").data("radiusSliding")&&(e=!0),0<t.find(".tool-edit-name").find(".J_moduleNamePanel").height()&&(e=!0),0<t.find(".tool-description").find(".descPanel").height()&&(e=!0),0<t.find(".tool-number").find(".numberPanel").height()&&(e=!0),0<t.find(".tool-parallax").find(".parallaxPanel").height()&&(e=!0),0<t.find(".tool-numAnimation").find(".numAnimationPanel").height()&&(e=!0),e},c.constructor.prototype.bindSliderInputEvent=function(o,n){var i,E;return E=function E(r){var t,a,l;function d(t,e){e?t.attr("contenteditable",e).addClass("J_contentEditable contentEditable"):t.removeAttr("contenteditable").removeClass("J_contentEditable contentEditable")}function s(t,e,o){t.html(e+(o||""))}function c(t){return parseInt(t.html().replace(r.per,"")||0)||0}function u(t,e){t._value=c(t),t._length=t.html().length,t._event=e}function e(t,e){var o=new a;o.add(t,["isEditable"],"可编辑状态中");var n=o.start();if(n)return n;d(t,!0),t.html(c(t)),F.getEventCtrl().setNodeRange(t[0]),N.isMozilla()&&t.focus()}function o(t,e){var o=new a;if(u(t,e),o.add(t,["isNumberKey"],"请输入数字"),o.add(t,["maxLength:"+r.maxLength],"数字已达最大长度"),o.start())return!1}function n(t,e){var o=new a;u(t,e),o.add(t,["maxVal:"+r.maxVal],"超过最大值");var n=o.start();if(i(t,e),n)return n}function i(t,e){var o=new a;u(t,e),o.add(t,["minVal:"+r.minVal],"小于最小值");var n=o.start(),i=c(t);n&&(i=r.minVal),r.onChange(i)}function f(t,e){var o=new a;u(t,e),o.add(t,["minVal:"+r.minVal],"小于最小值");var n=o.start(),i=c(t);n&&(i=r.minVal),s(t,i,r.per),d(t,!1)}return t={onChange:function p(){},maxVal:100,per:"%",minVal:0,maxLength:3},r=L.extend({},t,r),(a=function a(){this.cache=[]}).prototype.add=function(o,t,n){for(var i,r=this,e=0;i=t[e++];)!function(){var e=i.split(":");r.cache.push(function(){var t=e.shift();return e.unshift(o),e.push(n),l[t].apply(o,e)})}()},a.prototype.start=function(){for(var t,e=0;t=this.cache[e++];){var o=t();if(o)return o}},l={isNumberKey:function m(t,e){if(!N.isNumberKey(t._event))return e},maxLength:function h(t,e,o){if(t._length>=e)return o},maxVal:function g(t,e,o){if(t._value>e)return s(t,e),F.getEventCtrl().popCursorLastDiv(t),t.focus(),o},minVal:function v(t,e,o){if(t._value<e)return o},isEditable:function C(t,e){if(t.hasClass("J_contentEditable contentEditable"))return e}},{click:e,keypress:o,keyup:n,blur:f}},i=function i(){var t=["click"," keypress"," keyup"," blur",""],e=".sliderInput";o.off(e).on(t.join(e),function(t){return t.stopPropagation(),E(n)[t.type](L(this),t)})},function t(){return o.length&&i(),o}()},c.constructor.prototype.editToolBarMask=function(t){var e={id:t,useClass:!0,leftClass:"fk-dialog-hidden-mask",rightClass:"fk-dialog-hidden-mask",topClass:"fk-dialog-hidden-mask",bottomClass:"fk-dialog-hidden-mask",centerClass:"fk-dialog-center-mask",extFn:[{name:"click.dialogmask",fn:function r(){c.removeToolBarDialog(t),c.checkFontFace(t)}}]};M.addModuleMask(e);var o=L("#module"+t),n=M.checkNestModule(o),i=M.hasPopupModuleOpen();n.inPopupZone&&i&&L(".fk-dialog-hidden-mask").addClass("fk-dialog-hidden-mask_popupZone"),n.inSubNav&&N.top._subNavPackEdit&&L(".fk-dialog-hidden-mask").addClass("fk-dialog-hidden-mask-insubNav"),L(E).off("mousewheel.disabledScroll").on("mousewheel.disabledScroll",function(t){setTimeout(function(){M.addModuleMask(e)},200)})},c.constructor.prototype.checkFontFace=function(t){if(!M.isSupportFontCache()){var e=L("#module".concat(t)),o=null;if(o=L("corpTitle"==t?"#fkEditor-corpTitle *[style*=font-family]":"#module".concat(t," .fk-editor *[style*=font-family]")),81!=e.attr("_modulestyle"))o&&o.each(function(t,e){var o=L(e).css("font-family"),n=(L(e).text()||"").replace(/\s/g,"");if("fontface"===o.split("__")[0]){var i="";if(L("#".concat(o)).each(function(t,e){i+=L(e).attr("substring")}),n!=i)if(n.length<450){var r=n.split("");if(i){var a=!0,l=!1,d=I;try{for(var s,c=r[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var u=s.value;if(!i.includes(u)){M.resetHeadFontFace(o,N.unique(n+i));break}}}catch(f){l=!0,d=f}finally{try{a||null==c["return"]||c["return"]()}finally{if(l)throw d}}}else M.resetHeadFontFace(o,N.unique(n+i))}else N.ing("由于当前文本内容过长将导致浏览器响应缓慢，建议拆分不同文本模块实现或删减文本内容。")}});else{var n=e.find("#module".concat(t,"FlBtn")),i=n.css("font-family")||"";if("fontface"===i.split("__")[0]){var r=n.text().replace(/\s/g,""),a=r.split(""),l="";if(L("#".concat(i)).each(function(t,e){l+=L(e).attr("substring")}),l){var d=!0,s=!1,c=I;try{for(var u,f=a[Symbol.iterator]();!(d=(u=f.next()).done);d=!0){var p=u.value;if(!l.includes(p)){M.resetHeadFontFace(i,r);break}}}catch(m){s=!0,c=m}finally{try{d||null==f["return"]||f["return"]()}finally{if(s)throw c}}}else M.resetHeadFontFace(i,r)}}}},c.constructor.prototype.removeToolBarDialog=function(t,e){var o=N.top.$("#module"+t);!M.checkNestModule(o).inPopupZone&&M.hasPopupModuleOpen()||(M.checkSimpleTextHideTool(),0<L(".moduleMaskContainer").length&&M.removeModuleMask(),L(E).off("mousewheel.disabledScroll"))},c.constructor.prototype.hideToolBarMask=function(){0<L(".fk-dialog-hidden-mask").length&&M.removeModuleMask()},c.constructor.prototype.hideHoverTool=function(t){var e=t.option,o=t.editor,n=L("#fkEditor-toolBar-"+e.moduleId);o.data(R.SimpleTextEdit)||_EditToolBase.getEventCtrl().isShowHoverToolPanel(n)||(N.top.$(".popupBg").length<=0?_EditToolBase.getEventCtrl().deleteOrHideToolBar(e):(e.isHideToolBar=!0,_EditToolBase.getEventCtrl().deleteOrHideToolBar(e),e.isHideToolBar=!1))},c.constructor.prototype.buildSimpleTip=function(t,e){var o=t.toolbar;e.off("mouseenter.tips").on("mouseenter.tips",function(){L(this).attr("data-title-tip")&&(o.find(".setRadiusBar").data("radiusSliding")||(L(this).addClass("f-button-tip-vertical"),M.getTopHeight()+48>L(this).offset().top?L(this).removeClass("f-button-top").addClass("f-button-bottom"):L(this).addClass("f-button-top").removeClass("f-button-bottom")))}).off("mouseleave.tips").on("mouseleave.tips",function(){L(this).removeClass("f-button-tip-vertical").removeClass("f-button-bottom").removeClass("f-button-tip")})},c.constructor.prototype.hideSimpleTip=function(t){t.removeClass("f-button-tip-vertical").removeClass("f-button-bottom").removeClass("f-button-tip")},c.constructor.prototype.editToolLogDog=function(t){var e=t.module,o=t.command;if(e.hasClass("formStyle81"))switch(o){case j.EditContent:M.logDog(200193,1),M.inPopupZoneLog(e,200304,3);break;case j.BtnModuleStyle:M.logDog(200193,2);break;case j.Animation:M.logDog(200193,3);break;case j.GlobalLink:M.logDog(200193,4);break;case j.Opacity:M.logDog(200193,5);break;case j.Border:M.logDog(200193,6);break;case j.Shadow:M.logDog(200193,7);break;case j.Radius:M.logDog(200193,8);break;case j.Delete:M.logDog(200193,9);break;case j.Colors:M.logDog(200193,10);break;case j.Bold:M.logDog(200193,11);break;case j.Underline:M.logDog(200193,12);break;case j.Formats:M.logDog(200193,13);break;case j.FontSize:M.logDog(200193,14);break;case j.Dblclick:M.logDog(200193,15)}else if(e.hasClass("formStyle86"))switch(o){case j.EditContent:M.logDog(200077,1),M.inPopupZoneLog(e,200304,1);break;case j.Animation:M.logDog(200077,2);break;case j.GlobalLink:M.logDog(200077,3);break;case j.Delete:M.logDog(200077,4);break;case j.Colors:M.logDog(200077,5);break;case j.Bold:M.logDog(200077,6);break;case j.Italic:M.logDog(200077,7);break;case j.Underline:M.logDog(200077,8);break;case j.Formats:M.logDog(200077,9);break;case j.FontSize:M.logDog(200077,10);break;case j.LineHeight:M.logDog(200077,14);break;case j.TextAlign:M.logDog(200077,17);break;case j.JustifyLeft:M.logDog(200077,18);break;case j.JustifyCenter:M.logDog(200077,19);break;case j.JustifyRight:M.logDog(200077,20);break;case j.SingleClick:M.logDog(200077,21);break;case j.Dblclick:M.logDog(200077,22);break;case j.Linkcreator:M.logDog(200077,23);break;case j.DeleteLink:M.logDog(200077,24);break;case j.InputFontSize:M.logDog(200077,25);break;case j.InputLineHeight:M.logDog(200077,26);break;case j.ChooseFormats:M.logDog(200077,27);break;case j.ChooseLineHeight:M.logDog(200077,28);break;case j.JustifyFull:M.logDog(200077,30);break;case j.Horizontal:M.logDog(200077,31);break;case j.VerticalToLeft:M.logDog(200077,32);break;case j.VerticalToRight:M.logDog(200077,33)}else if(e.hasClass("corpTitle"))switch(o){case j.EditContent:M.logDog(200271,1);break;case j.GlobalLink:M.logDog(200271,2);break;case j.EditPositionFixed:M.logDog(200271,3);break;case j.EditLogoDisplay:N.top.$("#logo").is(":visible")?M.logDog(200271,4):M.logDog(200271,5);break;case j.Delete:M.logDog(200271,6);break;case j.Dblclick:M.logDog(200271,7);break;case j.Colors:M.logDog(200271,8);break;case j.Bold:M.logDog(200271,9);break;case j.Italic:M.logDog(200271,10);break;case j.Underline:M.logDog(200271,11);break;case j.Formats:M.logDog(200271,12);break;case j.LineHeight:M.logDog(200271,13);break;case j.TextAlign:M.logDog(200271,14)}else if(e.hasClass("formStyle79"))switch(o){case j.EditPhotoBtn:M.logDog(200194,2);break;case j.ImgEffectBtn:M.logDog(200194,3);break;case j.Animation:M.logDog(200194,5);break;case j.PhotoShapeBtn:M.logDog(200194,4);break;case j.Opacity:M.logDog(200194,7);break;case j.SimpleLinkBtn:M.logDog(200194,6);break;case j.Delete:M.logDog(200194,8);break;case j.Dblclick:M.logDog(200194,9)}else if(e.hasClass("formStyle115"))switch(o){case j.EditDynamicNumber:M.logDog(201013,1);break;case j.EditContent:M.logDog(201013,2);break;case j.EditAnimation:M.logDog(201013,3);break;case j.Animation:M.logDog(201013,4);break;case j.SimpleLinkBtn:M.logDog(201013,5);break;case j.EditPlay:M.logDog(201013,6);break;case j.Delete:M.logDog(201013,7)}}};return e=new t},this.getUICtrl=function(){if(t)return t;var e=function e(){var t=this,d="J_fkSingleTool";t.constructor.prototype.creatButtonsList=function(t){t.option;var e,o=t.buttons,n=t.toolbar.find(".simpleTextEditTool"),i=[],r="moduleName";if(!(0<n.children().length)){for(var a=0;a<o.length;a++)e=o[a],"EditColorBtn"==(t.btn=e)[r]&&i.push(_EditColorBtn.getUICtrl().createBtnToolDom(t).join("")),"EditHoverColorBtn"==e[r]&&i.push(_EditColorBtn.getUICtrl().createBtnToolDom(t).join("")),"EditBoldBtn"==e[r]&&i.push(_EditBoldBtn.getUICtrl().createBtnToolDom(t).join("")),"EditItalicBtn"==e[r]&&i.push(_EditItalicBtn.getUICtrl().createBtnToolDom(t).join("")),"EditUnderlineBtn"==e[r]&&i.push(_EditUnderlineBtn.getUICtrl().createBtnToolDom(t).join("")),"EditFormatsBtn"==e[r]&&i.push(_EditFormatsBtn.getUICtrl().createBtnToolDom(t).join("")),"EditFontSizeBtn"==e[r]&&i.push(_EditFontSizeBtn.getUICtrl().createBtnToolDom(t).join("")),"EditWritingModeBtn"==e[r]&&i.push(_EditWritingModeBtn.getUICtrl().createBtnToolDom(t).join("")),"EditLineHeightBtn"==e[r]&&i.push(_EditLineHeightBtn.getUICtrl().createBtnToolDom(t).join("")),"EditTextAlignBtn"==e[r]&&i.push(_EditTextAlignBtn.getUICtrl().createBtnToolDom(t).join("")),"EditLinkBtn"==e[r]&&i.push(_EditLinkBtn.getUICtrl().createBtnToolDom(t).join("")),"EditRemoveFormatBtn"==e[r]&&i.push(_EditRemoveFormatBtn.getUICtrl().createBtnToolDom(t).join("")),"EditSeperatorBtn"==e[r]&&i.push(_EditSeperatorBtn.getUICtrl().createHoverBtnToolDom().join("")),"EditBreakLineBtn"==e[r]&&i.push(_EditBreakLineBtn.getUICtrl().createHoverBtnToolDom().join("")),_EditBreakLineBtn;return n.append(i.join("")),x}},t.constructor.prototype.creatHoverButtonsList=function(t){var e,o,n=t.option,i=t.hoverShowButtons,r=t.toolbar.find(".simpleTextHoverTool"),a=[],l="moduleName",d=n.tipTitle;if(0<r.children().length)return x;for(var s=0;s<i.length;s++)e=i[s],"EditContentBtn"==(t.btn=e)[l]&&a.push(_EditContentBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditFixedPositionBtn"==e[l]&&a.push(_EditFixedPositionBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditLogoDisplayBtn"==e[l]&&a.push(_EditLogoDisplayBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditAnimationBtn"==e[l]&&a.push(_EditAnimationBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditParallaxBtn"==e[l]&&M.canShowParallaxBtn(t.module)&&a.push(_EditParallaxBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditBtnModuleStyleBtn"==e[l]&&a.push(_EditBtnModuleStyleBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditPhotoBtn"==e[l]&&a.push(_EditPhotoBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditImgEffectBtn"==e[l]&&a.push(_EditImgEffectBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditAltBtn"==e[l]&&a.push(_EditAltBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditPhotoShapeBtn"==e[l]&&a.push(_EditPhotoShapeBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditSimpleLinkBtn"==e[l]&&a.push(_EditSimpleLinkBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditModuleTitleBtn"==e[l]&&a.push(_EditModuleTitleBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditDescribePicBtn"==e[l]&&a.push(_EditDescribePicBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditFixedBtn"==e[l]&&a.push(_EditFixedBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditGlobalLinkBtn"==e[l]&&a.push(_EditGlobalLinkBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditBorderRadiusBtn"==e[l]&&a.push(_EditBorderRadiusBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditOpacityBtn"==e[l]&&a.push(_EditOpacityBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditBorderBtn"==e[l]&&a.push(_EditBorderBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditShadowBtn"==e[l]&&a.push(_EditShadowBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditDeleteBtn"==e[l]&&a.push(_EditDeleteBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditSeperatorBtn"==e[l]&&a.push(_EditSeperatorBtn.getUICtrl().createHoverBtnToolDom().join("")),"EditDynamicNumberBtn"==e[l]&&a.push(_EditDynamicNumberBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditNumAnimationBtn"==e[l]&&a.push(_EditNumAnimationBtn.getUICtrl().createHoverBtnToolDom(t).join("")),"EditPlayBtn"==e[l]&&a.push(_EditPlayBtn.getUICtrl().createHoverBtnToolDom(t).join(""));return r.append(a.join("")),d&&(o=r.find(".tool .editToolIcon"),x.getEventCtrl().buildSimpleTip(t,o)),x},t.constructor.prototype.buildToolWrapDom=function(t){var e,o,n,i=t.option,r=(t.editor,[]),a=6;if(!i.moduleId||i.moduleId<=0)return console.log("buildToolWrapDom moduleId err, option.moduleId = "+i.moduleId),o;o=L("#"+i.css+"-toolBar-"+i.moduleId),n=M.checkNestModule(L("#"+i.moduleId)).inPopupZone?L("body"):L("#web"),e=L("."+d);for(var l=0;l<e.length;l++)e=e.eq(l),x.getEventCtrl().deleteToolWrapDom({deleteToolbar:e,option:e.data(R.Option)});return i.btnModuleEdit&&(a+=6),r.push('<div id="'+i.css+"-toolBar-"+i.moduleId+'" role="toolbar" class="'+d+" "+i.css+" "+i.toolExtClasses+" "+i.css+"-tool "+i.css+'DefHeight" style="width:'+i.toolBarWidth+';">'),r.push('<div style="display:none;"><input maxlength="255" id="simpleTextLinkInputVal-'+i.moduleId+'"></input></div>'),r.push('<div class="simpleTextHoverTool"></div>'),r.push('<div class="simpleTextEditTool" style="display:none;"></div>'),r.push('<div class="simpleTextCover f-simpleTextCover" style="height:'+a+'px;"></div>'),r.push("</div>"),n.append(r.join("")),(o=L("#"+i.css+"-toolBar-"+i.moduleId)).data(R.Option,i),o}};return t=new e}};_EditToolBase=new h;var v=function v(){var e,o,i=this;this.getEventCtrl=function(){if(e)return e;var t=function t(){var e,o,n,s=this;s.constructor.prototype.getModule=function(t){var e=t.option;if("null"!=e.moduleId&&0!=e.moduleId)return L("#"+e.moduleId)},s.constructor.prototype.stopBannerJump=function(t){var e=t.clickEvent,o=L(e.target).parentsUntil("#bannerV2",".J_bannerItem");o.length&&(href=o.attr("href"),target=o.attr("target"),o.attr("href","javascript:void(0);").attr("target",""),setTimeout(function(){o.attr("href",href).attr("target",target)},0))},s.constructor.prototype.logEditorSingleClick=function(t){var e=t.editor,o=t.module;clearTimeout(n),n=setTimeout(function(){"true"!=e.attr(U.Contenteditable)&&_EditToolBase.getEventCtrl().editToolLogDog({module:o,command:j.SingleClick})},300)},s.constructor.prototype.setEidtorSelectedRule=function(t){var n=t.editor,e=t.command,i=!1;n.text().length<=0||(F.getEventCtrl().getSelectText(n,!0).length<=0&&(n.data(R.HasRefreshClick)?(F.getEventCtrl().setNodeRange(n[0]),i=!0):e!=j.Colors&&e!=j.FontSize&&e!=j.LineHeight&&(F.getEventCtrl().setSelectRange(n.data(R.Range)),i=!0)),clearTimeout(o),o=setTimeout(function(){var t=n.data(R.SignClassNum),e=n.find("."+n.data(R.EditSignClass)+t);if(n.data(R.HasRefreshClick)||e.length<=0){var o=0<F.getEventCtrl().getSelectText(n,!0).length;n.data(R.HasSelectText,o),o&&F.getEventCtrl().setTagStyle({styleName:"xxxx",styleValue:"",editor:n,notCreateNewNode:!1})}i&&F.getEventCtrl().getSelectText(n,!1)},100))},s.constructor.prototype.bindAllEvent=function(r){var o,n,a=r.option,l=r.module,d=r.editor,t=(r.fkEditorWrap,"mouseup.fkTool"+a.moduleId),i=!1;l.unbind("mouseenter.fkModuleEvent").bind("mouseenter.fkModuleEvent",function(t){if(L(this).is(":hover"),(!M.checkNestModule(l).inSubNav||N.top._subNavPackEdit)&&(!M.checkNestModule(l).inPopupZone||N.top._popupZone&&N.top._popupZone.pZone&&N.top._popupZone.pZone.editing)&&!l.hasClass("ui-resizable-resizing")){clearTimeout(d.data(R.EditLineTimeout));var e,o,n=L(this).find(".fk-editor-line"),i=L("#"+a.css+"-toolBar-"+a.moduleId);n.hasClass("fk-editor-bdNone")&&(n.addClass("fk-editor-bd"),n.removeClass("fk-editor-bdNone")),clearTimeout(d.data(R.HoverToolTimeout)),(r.toolbar=i).length<1&&(e=_EditBtnBase.getEventCtrl().getButtonsData(r),r.buttons=e,o=_EditBtnBase.getEventCtrl().getHoverShowButtons(r),r.hoverShowButtons=o,i=_EditToolBase.getUICtrl().buildToolWrapDom(r),r.toolbar=i,a.EditRadiusBtn&&_EditRadiusBtn.getUICtrl().createEditRadiusBtnDom(r),_EditToolBase.getUICtrl().creatHoverButtonsList(r),_EditToolBase.getUICtrl().creatButtonsList(r),A.getEventCtrl().setUnselectable(r),_EditToolBase.getEventCtrl().bindToolAndEditorCreatedEvent(r),_EditToolBase.getEventCtrl().showToolBar(r)),d.data(R.SimpleTextEdit)||(_EditToolBase.getEventCtrl().checkEditItemDisplay(r),i.find(".simpleTextEditTool").hide(),i.find(".simpleTextHoverTool").show()),M.createSimpleTextAutoWidthBtn(L(this))}}).unbind("mouseleave.fkModuleEvent").bind("mouseleave.fkModuleEvent",function(t){var e=L(this).find(".fk-editor-line"),o=200;s.checkEditorEditable(r)||d.data(R.SimpleTextEdit)||d.data(R.EditLineTimeout,setTimeout(function(){r.fkEditorLine=e,_EditorBase.getEventCtrl().hideEditLine(r)},o)),d.data(R.SimpleTextEdit)||d.data(R.HoverToolTimeout,setTimeout(function(){_EditToolBase.getEventCtrl().hideHoverTool(r)},o))}).unbind("dblclick.fkModuleEvent").bind("dblclick.fkModuleEvent",function(t){if(!M.checkNestModule(l).inSubNav||N.top._subNavPackEdit){var e=M.hasPopupModuleOpen();(!M.checkNestModule(l).inPopupZone||e&&e.editing)&&(clearTimeout(n),t.preventDefault(),(o=L("#"+a.css+"-toolBar-"+a.moduleId)).find(".simpleTextHoverTool").is(":visible")&&(d.data(R.TriggerClick,!0),o.find(".tool-editContentNew .editToolIcon").trigger("click")),_EditToolBase.getEventCtrl().editToolLogDog({module:l,command:j.Dblclick}))}}).off("click.fkClick","a").on("click.fkClick","a",function(t){var e=this;if("true"===l.find(".fk-editor").attr("contenteditable"))return t.preventDefault(),t.stopPropagation(),void t.stopImmediatePropagation();i?i=!1:(i=!1,t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),clearTimeout(n),n=setTimeout(function(){i=!0,e.click()},220))}),c&&L(H).unbind(t).bind(t,function(t){0==t.button&&l.data(R.Mousemove)&&L(".fk-popupWindowVT").length<1&&F.getEventCtrl().getSelectText(d,!1)})},s.constructor.prototype.bindSimpleToolAllEvent=function(n){var i=n.option,r=n.module,a=n.editor;r.unbind("mouseenter.fkModuleEvent").bind("mouseenter.fkModuleEvent",function(t){if(!M.checkNestModule(r).inSubNav||N.top._subNavPackEdit){var e,o=L("#"+i.css+"-toolBar-"+i.moduleId);clearTimeout(a.data(R.HoverToolTimeout)),(n.toolbar=o).length<1&&(e=_EditBtnBase.getEventCtrl().getHoverShowButtons(n),n.hoverShowButtons=e,o=_EditToolBase.getUICtrl().buildToolWrapDom(n),n.toolbar=o,i.EditRadiusBtn&&_EditRadiusBtn.getUICtrl().createEditRadiusBtnDom(n),_EditToolBase.getUICtrl().creatHoverButtonsList(n),_EditToolBase.getEventCtrl().bindSimpleToolCreatedEvent(n)),_EditToolBase.getEventCtrl().showToolBar(n)}}).unbind("mouseleave.fkModuleEvent").bind("mouseleave.fkModuleEvent",function(t){var e=200;a.data(R.SimpleTextEdit)||a.data(R.HoverToolTimeout,setTimeout(function(){_EditToolBase.getEventCtrl().hideHoverTool(n)},e))}).unbind("dblclick.fkModuleEvent").bind("dblclick.fkModuleEvent",function(t){M.checkNestModule(r).inSubNav&&!N.top._subNavPackEdit||(i.dblclickFun&&""!=i.dblclickFun&&N.fkEval(i.dblclickFun),_EditToolBase.getEventCtrl().editToolLogDog({module:r,command:j.Dblclick}))})},s.constructor.prototype.checkEditorEditable=function(t){var e=t.editor.attr(U.Contenteditable);return _typeof(e)!=I&&0!=e&&"false"!=e},s.constructor.prototype.backTextSelected=function(t){var e=t.data(R.SignClassNum),o=t.find("."+t.data(R.EditSignClass)+e);return t.data(R.HasRefreshClick)||F.getEventCtrl().setNodeRange(o[0]),i},s.constructor.prototype.refeshEidtorHeight=function(t){var e=t.option,o=t.editor,n=t.module;if(!o.hasClass("fk-editor-vertical-rl")&&!o.hasClass("fk-editor-vertical-lr")){var i=o[0].clientHeight,r=o[0].scrollHeight;o.data(R.PreScrollHeight)||o.data(R.PreScrollHeight,r),o.data(R.ChangeCount)>e.changeCount&&(i<r||r!=o.data(R.PreScrollHeight))&&!o.data(R.ScrollChangeChecking)&&(o.data(R.PreScrollHeight,r),o.data(R.ScrollChangeChecking,!0),o.css("height",r+"px"),n.css("height",r+"px"),n.attr("_autoheight",0),n.trigger("mouseover"),setTimeout(function(){o.data(R.ScrollChangeChecking,!1)},50)),s.setEditorAutoHeight(n.attr("id"))}},s.constructor.prototype.setEditorAutoHeight=function(t){if(!(0<L("#fkEditor-"+t).length&&(L("#fkEditor-"+t).hasClass("fk-editor-vertical-rl")||L("#fkEditor-"+t).hasClass("fk-editor-vertical-lr"))))return clearTimeout(e),e=setTimeout(function(){M.autoModuleHeight(t.replace("module",""))},200),i},s.constructor.prototype.hideEditLine=function(t){var e=t.option,o=t.editor,n=t.fkEditorLine,i=L("#fkEditor-toolBar-"+e.moduleId);o.data(R.SimpleTextEdit)||0<i.find(".tool-link").find(".linkPanel").height()||n.hasClass("fk-editor-bd")&&(n.addClass("fk-editor-bdNone"),n.removeClass("fk-editor-bd"))},s.constructor.prototype.simpleTextFormatPasteData=function(t,e){A.getEventCtrl().filterPasteData(t),A.getEventCtrl().textPositionCorrect(t)}};return e=new t},this.getUICtrl=function(){if(o)return o;var t=function t(){};return o=new t}};_EditorBase=new v;var b=function b(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(){var t=[];return t.push('<div class="seperatorNew"></div>'),t}};return e=new t}};_EditSeperatorBtn=new b;var y=function y(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(){var t=[];return t.push('<div style="clear:both;"></div>'),t}};return e=new t}};_EditBreakLineBtn=new y;var k=function k(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createHoverBtnToolDom(t)}};return e=new t}};_EditAnimationBtn=new k;var S=function S(){var e,o;this._panelHeight=123,this.getEventCtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.showParallaxPanel=function(t){var e=t.option,o=t.toolbar.find(".tool-parallax"),n=e.moduleId.replace("module",""),i=o.find("."+e.css+"-parallaxSlideBar"),r=i.find(".parallaxPanel");0<r.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e,j.Parallax):(r.addClass("f-parallaxPanel-show"),i.addClass("parallaxSlideBar-show"),_EditToolBase.getEventCtrl().editToolBarMask(n))}};return e=new t},this.getUICtrl=function(){if(o)return o;var t=function t(){var r=this;r.constructor.prototype.createHoverBtnToolDom=function(t){var e=t.option,o=t.btn,n="";e.tipTitle&&(n=' data-title-tip="'+o.title+'" ');var i='\n\t\t\t\t\t\t<div class="parallaxDiv slideDiv" '.concat(u,">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a ").concat(u,' class="f-editToolIcon editToolIcon ').concat(o.command,'-tool-icon" command ="').concat(o.command,'" ').concat(n,'></a>\n\t\t\t\t\t\t<div class="parallaxSlideBar ').concat(e.css,"-parallaxSlideBar f-").concat(e.css,'-parallaxSlideBar ">\n\t\t\t\t\t\t\t<div class="f-parallaxPanel f-fkEditorBar parallaxPanel fkEditorBar J_parallaxPanel_').concat(e.moduleId,'">\n\t\t\t\t\t\t\t\t').concat(r.createparallaxPanelDom(e),"\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t");return t.btnContent=i,i=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,i},r.constructor.prototype.createparallaxPanelDom=function(t){return'<div class="f-parallaxPanel_wrap">\n\t\t\t\t\t\t<div class="parallaxPanelItem">\n\t\t\t\t\t\t\t<span class="delay parallaxSliderText">位移方向：</span>\n\t\t\t\t\t\t\t<radio-group-component @on-change="handleStop(direction, \'direction\')" v-model="direction">\n\t\t\t\t\t\t        <radio-component :label="0">正向</radio-component>\n\t\t\t\t\t\t        <radio-component :label="1">反向</radio-component>\n\t\t\t\t\t\t    </radio-group-component>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="parallaxPanelItem">\n\t\t\t\t\t\t\t<span class="continued parallaxSliderText">位移强度：</span>\n\t\t\t\t\t\t\t<slider-component :decimal=\'true\' :digitis=\'1\' :min="0" :max="1" :step="0.1" :width="100" v-model="distance"\n\t\t\t\t\t\t\t\t@on-stop="(value) => handleStop(value, \'distance\')"\n\t\t\t\t\t\t\t></slider-component>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t'}};return o=new t}};_EditParallaxBtn=new S;var _=function _(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createHoverBtnToolDom(t)}};return e=new t}};_EditPlayBtn=new _;var x=function x(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(t){var e,o=t.btn;return t.btnContent="<a "+u+' class="editToolIcon f-editToolIcon" command ="'+o.command+'">'+o.title+"</a>",e=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,e}};return e=new t}};_EditBtnModuleStyleBtn=new x;var P=function P(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){var i=this;i.constructor.prototype.setEditPhotoText=function(t){t.btn;var e=t.option.moduleId,o=t.module;return"logo"==e?1==N.top.$("#logo").attr("_defaultlogo")?"添加logo":"编辑logo":o.data("imgHoverEft")&&o.data("imgHoverEft").isInit?"添加图片":"编辑图片"},i.constructor.prototype.createHoverBtnToolDom=function(t){var e,o=t.btn,n=o.title;return n=i.setEditPhotoText(t),t.btnContent="<a "+u+' class="editToolIcon f-editToolIcon" command ="'+o.command+'">'+n+"</a>",e=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,e}};return e=new t}};_EditPhotoBtn=new P;var V=function V(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createHoverBtnToolDom(t)}};return e=new t}};_EditImgEffectBtn=new V;var z=function z(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createHoverBtnToolDom(t)}};return e=new t}};_EditPhotoShapeBtn=new z;var W=function W(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createHoverBtnToolDom(t)}};return e=new t}};_EditAltBtn=new W;var J=function J(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createHoverBtnToolDom(t)}};return e=new t}};_EditSimpleLinkBtn=new J;var G=function G(){var t,e;this._panelHeight=47,this.getEventCtrl=function(){if(t)return t;var e=function e(){var t=this;t.constructor.prototype.bindModuleTitlePanelEvent=function(t){var e=t.option,o=(t.module,t.editor,t.toolbar),n=(e.moduleId.replace("module",""),"keyup.moduleTitleSlideBar change.moduleTitleSlideBar");o.find(".tool-edit-name").find("."+e.css+"-moduleNameSlideBar").find(".J_moduleNamePanel").find(".J_module-name-input").off(n).on(n,function(){e.moduleTitleFun&&""!=e.moduleTitleFun&&N.fkEval(e.moduleTitleFun)})},t.constructor.prototype.showModuleTitlePanel=function(t){var e=t.option,o=t.toolbar.find(".tool-edit-name"),n=e.moduleId.replace("module",""),i=o.find("."+e.css+"-moduleNameSlideBar").find(".J_moduleNamePanel");0<i.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e,j.ModuleTitleBtn):(i.addClass("f-moduleNamePanel-show"),o.find(".slideDiv").addClass("slideDivModuleName"),_EditToolBase.getEventCtrl().editToolBarMask(n))}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){var r=this;r.constructor.prototype.createHoverBtnToolDom=function(t){var e=t.option,o=t.btn,n=[],i="";return e.tipTitle&&(i=' data-title-tip="'+o.title+'" '),n.push('<div class="f-module-name-div J_moduleNameDiv slideDiv" '+u+">"),n.push("</div>"),n.push("<a "+u+' class="f-editToolIcon editToolIcon '+o.command+'-tool-icon" command ="'+o.command+'" '+i+" ></a>"),n.push('<div class=" '+e.css+"-moduleNameSlideBar f-"+e.css+'-moduleNameSlideBar ">'),n.push('<div class="J_moduleNamePanel f-fkEditorBar fkEditorBar">'),n.push(r.createModuleTitlePanelDom(e)),n.push("</div>"),n.push("</div>"),n.push("</div>"),t.btnContent=n.join(""),n=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,n},r.constructor.prototype.createModuleTitlePanelDom=function(t){var e="";return e+='<div class="f-descItem">',e+='<div class="f-descTip">模块标题：</div>',e+='<div class="f-descSet"><input class="f-module-name-input J_module-name-input"  maxlength="50"/></div>',e+="</div>"}};return e=new t}};_EditModuleTitleBtn=new G;var q=function q(){var t,e;this._panelHeight=47,this.getEventCtrl=function(){if(t)return t;var e=function e(){var t=this;t.constructor.prototype.bindDescribePicPanelEvent=function(t){var e=t.option,o=(t.module,t.editor,t.toolbar),n=(e.moduleId.replace("module",""),o.find(".tool-description").find("."+e.css+"-describePicSlideBar").find(".descPanel")),i="keyup.describePicSlideBar change.describePicSlideBar",r="";n.find("#logoDescription").off(i).on(i,function(){e.describePicFun&&""!=e.describePicFun&&N.fkEval(e.describePicFun)}).off(".undoLogo").on("focus.undoLogo",function(){r=L(this).val()}).on("blur.undoLogo",function(){M.undoRun(function(){},{type:"logo",detail:"logoDescription",undoSame:!1,redoSame:!1,undoArgs:[r],redoArgs:[L(this).val()],undoFn:N.top._undo.logoDiscUndo,redoFn:N.top._undo.logoDiscUndo})})},t.constructor.prototype.showDescribePicPanel=function(t){var e=t.option,o=t.toolbar.find(".tool-description"),n=e.moduleId.replace("module",""),i=o.find("."+e.css+"-describePicSlideBar").find(".descPanel");0<i.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e,j.DescribePicBtn):(i.addClass("f-descPanel-show"),o.find(".slideDiv").addClass("slideDivDesc"),_EditToolBase.getEventCtrl().editToolBarMask(n))}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){var r=this;r.constructor.prototype.createHoverBtnToolDom=function(t){var e=t.option,o=t.btn,n=[],i="";return e.tipTitle&&(i=' data-title-tip="'+o.title+'" '),n.push('<div class="describeDiv slideDiv" '+u+">"),n.push("</div>"),n.push("<a "+u+' class="f-editToolIcon editToolIcon '+o.command+'-tool-icon" command ="'+o.command+'" '+i+" ></a>"),n.push('<div class=" '+e.css+"-describePicSlideBar f-"+e.css+'-describePicSlideBar ">'),n.push('<div class="f-descPanel f-fkEditorBar descPanel fkEditorBar">'),n.push(r.createDescribePicPanelDom(e)),n.push("</div>"),n.push("</div>"),n.push("</div>"),t.btnContent=n.join(""),n=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,n},r.constructor.prototype.createDescribePicPanelDom=function(t){var e=[];return e.push('<div class="f-descItem">'),e.push('<div class="f-descTip">输入图片描述文字：</div>'),e.push('<div class="f-descSet"><input id="logoDescription" class="f-logoDesPic"  maxlength="50"/></div>'),e.push("</div>"),e.join("")}};return e=new t}};_EditDescribePicBtn=new q;var $=function $(){var t,e;this.getEventCtrl=function(){if(t)return t;var e=function e(t){this.constructor.prototype.setFixedLogoBtnTitle=function(t){var e=t.btn,o=t.option,n=(t.toolbar,o.tipTitle),i="",r="unfixed";i=N.top._logoPositionFixTop?(e.addClass(r),"固定"):(e.removeClass(r),"不固定"),n?e.attr("data-title-tip",i):e.attr("title",i)}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(t){var e,o=t.btn,n="",i=t.option.tipTitle;return editToolIconExt=N.top._logoPositionFixTop?"":"unfixed",o.title=N.top._logoPositionFixTop?"不固定":"固定",n=i?' data-title-tip="'+o.title+'" ':' title="'+o.title+'" ',t.btnContent="<a "+u+' class="f-editToolIcon editToolIcon '+editToolIconExt+'" command ="'+o.command+'" '+n+"></a>",e=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,e}};return e=new t}};_EditFixedBtn=new $;var X=function X(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createBtnToolDom(t)}};return e=new t}};_EditBoldBtn=new X;var Y=function Y(){var t,e;this._panelHeight=123,this.getEventCtrl=function(){if(t)return t;var e=function e(){var t=this;t.constructor.prototype.bindDynamicNumberPanelEvent=function(t){var e=t.option,o=(t.module,t.editor,t.toolbar.find(".tool-number").find("."+e.css+"-numberSlideBar")),n=(o.find(".numberPanel"),"click.dynamicNumberBar mouseup.dynamicNumberBar");c&&o.unbind(n).bind(n,function(t){t.stopPropagation()})},t.constructor.prototype.getDynamicNumberPreData=function(t,e){e.option;var o=t;return{_startNumber:o.attr("_startNumber")||0,_endNumber:o.attr("_endNumber")||100,_useVisits:o.attr("_useVisits")||!1}},t.constructor.prototype.showEditNumberPanel=function(t){var e=t.option,o=t.toolbar.find(".tool-number"),n=e.moduleId.replace("module",""),i=o.find("."+e.css+"-numberSlideBar");i.find(".numberPanel");0<i.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e):(i.addClass("numberPanelSlide"),_EditToolBase.getEventCtrl().editToolBarMask(n))}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){var i=this;i.constructor.prototype.createHoverBtnToolDom=function(t){var e,o=t.btn,n=t.option;return t.btnContent="\n\t\t\t\t\t\t\t<a ".concat(u,' class="editToolIcon f-editToolIcon" command ="').concat(o.command,'">').concat(o.title,'</a>\n\t\t\t\t\t\t\t<div class="').concat(n.css,'-numberSlideBar">\n\t\t\t\t\t\t\t\t<div class="numberPanel fkEditorBar">\n\t\t\t\t\t\t\t\t\t').concat(i.createNumberPanelDom(n),"\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t"),e=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,e},i.constructor.prototype.createNumberPanelDom=function(t){var e=t.moduleId.replace("module","");return'\n\t\t\t\t\t\t\t<div class="numberPanleItem">\n\t\t\t\t\t\t\t\t<span class="startNumber numberInputText">开始数字：</span>\n\t\t\t\t\t\t\t\t<input-component v-model=\'startNumber\' number classes="startNumberInput'.concat(e,' numberInput"\n\t\t\t\t\t\t\t\t\tmaxlength="15"\n\t\t\t\t\t\t\t\t\t@on-undo-blur="(value) => handleInputBlur(value, \'startNumber\')">\n\t\t\t\t\t\t\t\t</input-component>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="numberPanleItem">\n\t\t\t\t\t\t\t\t<span class="endNumber numberInputText">结束数字：</span>\n\t\t\t\t\t\t\t\t<input-component v-model=\'endNumber\' number classes="endNumberInput').concat(e,' numberInput"\n\t\t\t\t\t\t\t\t\tmaxlength="15" :disabled="useVisitors"\n\t\t\t\t\t\t\t\t\t@on-undo-blur="(value) => handleInputBlur(value, \'endNumber\')">\n\t\t\t\t\t\t\t\t</input-component>\n\t\t\t\t\t\t\t\t\x3c!--<div class="visitorContent">\n\t\t\t\t\t\t\t\t\t<checkbox-component v-model="useVisitors" :true-value="true" :false-value="false"\n\t\t\t\t\t\t\t\t\t\t\t@on-change="handleCheckBoxChange">访客量</checkbox-component>\n\n\t\t\t\t\t\t\t\t\t\t<tooltip-component content="显示实时的网站访客数量" effect="light">\n\t\t\t\t\t\t\t\t\t\t\t<i class="tipIconPic"></i>\n\t\t\t\t\t\t\t\t\t\t</tooltip-component>\n\t\t\t\t\t\t\t\t</div>--\x3e\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t')}};return e=new t}};_EditDynamicNumberBtn=new Y;var Z=function Z(){var e,o;this._panelHeight=123,this.getEventCtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.showNumAnimationPanel=function(t){var e=t.option,o=t.toolbar.find(".tool-numAnimation"),n=e.moduleId.replace("module",""),i=o.find("."+e.css+"-numAnimationSlideBar"),r=i.find(".numAnimationPanel");0<r.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e):(r.addClass("f-numAnimationPanel-show"),r.addClass("f-numAnimationPanel-show"),i.addClass("numAnimationSlideBar-show"),_EditToolBase.getEventCtrl().editToolBarMask(n))}};return e=new t},this.getUICtrl=function(){if(o)return o;var t=function t(){var r=this;r.constructor.prototype.createHoverBtnToolDom=function(t){var e=t.option,o=t.btn,n="";e.tipTitle&&(n=' data-title-tip="'+o.title+'" ');var i='\n\t\t\t\t\t\t\t<div class="numAnimationDiv slideDiv" '.concat(u,">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<a ").concat(u,' class="f-editToolIcon editToolIcon ').concat(o.command,'-tool-icon" command ="').concat(o.command,'" ').concat(n,'></a>\n\t\t\t\t\t\t\t<div class="numAnimationSlideBar ').concat(e.css,"-numAnimationSlideBar f-").concat(e.css,'-numAnimationSlideBar ">\n\t\t\t\t\t\t\t\t<div class="f-numAnimationPanel f-fkEditorBar numAnimationPanel fkEditorBar">\n\t\t\t\t\t\t\t\t\t').concat(r.createNumAnimationPanelDom(e),"\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t");return t.btnContent=i,i=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,i},r.constructor.prototype.createNumAnimationPanelDom=function(t){return'\n\t\t\t\t\t\t\t<div class="numAnimationPanelItem">\n\t\t\t\t\t\t\t\t<span class="continued numAnimationSliderText">持续：</span>\n\t\t\t\t\t\t\t\t<slider-component :decimal=\'true\' :digitis=\'1\' unit="s" :min="0" :max="10" :step="0.1" :width="100" v-model="continued"\n\t\t\t\t\t\t\t\t\t@on-stop="(value) => handleStop(value, \'continued\')"\n\t\t\t\t\t\t\t\t></slider-component>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="numAnimationPanelItem">\n\t\t\t\t\t\t\t\t<span class="delay numAnimationSliderText">延迟：</span>\n\t\t\t\t\t\t\t\t<slider-component :decimal=\'true\' :digitis=\'1\' unit="s" :min="0" :max="10" :step="0.1"\n\t\t\t\t\t\t\t\t\t:width="100" v-model="delay" @on-change="(value) => handleStop(value, \'delay\')"\n\t\t\t\t\t\t\t\t></slider-component>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t'}};return o=new t}};_EditNumAnimationBtn=new Z;var Q=function Q(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(t){var e,o=t.btn;return t.option.showContentIcon?t.btnContent="":t.btnContent="<a "+u+' class="editToolIcon" command ="'+o.command+'">'+o.title+"</a>",e=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,e}};return e=new t}};_EditContentBtn=new Q;var K=function K(){var t,e;this.getEventCtrl=function(){if(t)return t;var e=function e(t){var n=this;n.constructor.prototype.checkPositionFixed=function(t){t.btn;var e=t.option;if("function"==typeof e.positionFixedFun){var o=function o(){n.setFixedPositionBtnTitle(t);e.positionFixedFun()};M.undoRun(o,{type:"logo",detail:"logoFixed"})}},n.constructor.prototype.setFixedPositionBtnTitle=function(t){var e=t.btn,o=t.option,n=(t.toolbar,o.tipTitle),i="",r="editToolIconUnable";i=N.top._titlePositionFixTop?(e.removeClass(r),"固定"):(e.addClass(r),"不固定"),n?e.attr("data-title-tip",i):e.attr("title",i)}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(t){var e,o=t.btn,n="",i=t.option.tipTitle;return editToolIconUnable=N.top._titlePositionFixTop?"editToolIconUnable":"",o.title=N.top._titlePositionFixTop?"不固定":"固定",n=i?' data-title-tip="'+o.title+'" ':' title="'+o.title+'" ',t.btnContent="<a "+u+' class="editToolIcon '+editToolIconUnable+'" command ="'+o.command+'" '+n+"></a>",e=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,e}};return e=new t}};_EditFixedPositionBtn=new K;var tt=function tt(){var t,e;this.getEventCtrl=function(){if(t)return t;var e=function e(t){var i=this;i.constructor.prototype.checkLogoDisplay=function(e){e.btn;var o=e.option;if("function"==typeof o.logoDisplayFun){var n=function n(){var t=i.setLogoDisplayBtnTitle(e);o.logoDisplayFun(t)};M.undoRun(n,{type:"logo",detail:"logoDisplaySwitch"})}},i.constructor.prototype.setLogoDisplayBtnTitle=function(t){var e=t.btn,o=t.option,n="",i=(t.toolbar,o.tipTitle),r="editToolIconUnable",a=!!N.top.$("#logo").is(":visible");return n=a?(e.addClass(r),"显示Logo"):(e.removeClass(r),"隐藏Logo"),i?e.attr("data-title-tip",n):e.attr("title",n),a}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(t){var e,o=t.btn,n=t.option.tipTitle,i="",r=!!N.top.$("#logo").is(":visible"),a=r?"":"editToolIconUnable";return o.title=r?"隐藏Logo":"显示Logo",i=n?' data-title-tip="'+o.title+'" ':' title="'+o.title+'" ',t.btnContent="<a "+u+' class="editToolIcon '+a+'" command ="'+o.command+'" '+i+"></a>",e=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,e}};return e=new t}};_EditLogoDisplayBtn=new tt;var et=function et(){var e,o,p=this;this.getEventCtrl=function(){if(e)return e;var t=function t(){var f=this;f.constructor.prototype.initColorBtnBgColor=function(t){var e=t.editor,o=t.option,n=t.toolbar.find(".tool-color ."+o.css+"-tool-icon");setTimeout(function(){n.css("background",e.css("color")),n.removeClass("fk-colorPicker-transparentIco")},100)},f.constructor.prototype.checkColorIsWhite=function(t){var e=!1;if(_typeof(t)==I||"null"==t||L.trim(t).length<=0)return e;if(0<(t=(t=L.trim(t)).toLowerCase()).indexOf(";")&&(t=(t=t.split(";"))[0]),-1!=t.indexOf("white")||-1!=t.indexOf("#ffffff"))return!0;if(-1!=t.indexOf("rgb")){if(-1!=t.indexOf("(255, 255, 255"))return!0;if(3<t.split(",").length&&(-1!=t.indexOf(", 0)")||-1!=t.indexOf(",0)")))return!0}return e},f.constructor.prototype.simpleTextColorInputHexStatus=function(t){var e,o,n,i=t.editor,r=t.option,a=t.state,l=t.color,d=t.rgbaColor,s=!1,c=F.getEventCtrl().getSelectedNode();if(i.data(R.HasRefreshClick)&&1==a&&(L.trim(F.getEventCtrl().getSelectText(i,!0)).length<=0?i.data(R.NotCreateNewNode,!1):i.data(R.NotCreateNewNode,!0)),_typeof(s=i.data(R.NotCreateNewNode))==I&&(s=!0),c&&"function"==typeof c.hasClass&&c.hasClass("J_colorpicker_hex")&&(s=!0),1==a&&s){var u={styleName:"xxxx",styleValue:"",editor:i,notCreateNewNode:"false",tTag:"font"};F.getEventCtrl().setTagStyle(u),setTimeout(function(){F.getEventCtrl().setTagStyle(u),F.getEventCtrl().getWindowSelection().removeAllRanges()},100)}else o=(e=i.attr("id")).substring(e.indexOf("-")+1),n=L("#fkEditor-toolBar-"+o).find(".tool-color ."+r.css+"-tool-icon"),(d&&""!=d?(n.css("background",d),f.checkColorIsWhite(d)):(n.css("background",l),f.checkColorIsWhite(l)))?n.css("border","solid 1px #ccc"):n.css("border","0px"),d&&""!=d?F.getEventCtrl().setTagStyle({styleName:"color",styleValue:d,editor:i,notCreateNewNode:s,attr2:"color",attr2Value:l}):-1<l.indexOf("linear-gradient")?(F.getEventCtrl().setTagStyle({styleName:"color",styleValue:"transparent",editor:i,notCreateNewNode:s,attr2:"color",attr2Value:l}),F.getEventCtrl().setTagStyle({styleName:"background-image",styleValue:l,editor:i,notCreateNewNode:s,attr2:"color",attr2Value:l})):(F.getEventCtrl().setTagStyle({styleName:"color",styleValue:l,editor:i,notCreateNewNode:s,attr2:"color",attr2Value:l}),F.getEventCtrl().setTagStyle({styleName:"background-image",styleValue:"",editor:i,notCreateNewNode:s,attr2:"color",attr2Value:l}));return F.getEventCtrl().getWindowSelection().removeAllRanges(),N.top.Site.getModuleAttr(o.replace("module","")).data.changed=!0,p},f.constructor.prototype.backTextSelectedStatus=function(t){var e=t.option,o=t.editor;if(!L(".J_faiColorPickerAlp").is(":visible")||!L(".J_advanceColorPicker").data("open"))return p;var n,i=o.data(R.SignClassNum),r=o.find("."+o.data(R.EditSignClass)+i)[0];T?((n=H.createRange()).selectNode(r),l.addRange(n)):C?F.getEventCtrl().setSelectRange(o.data(R.Range)):F.getEventCtrl().setNodeRange(r);var a=L("#fkEditor-toolBar-"+e.moduleId);colorBar=a.find(".tool-color ."+e.css+"-tool-icon"),fontColor=L(r).css("color"),f.checkColorIsWhite(fontColor)?colorBar.css("border","solid 1px #ccc"):colorBar.css("border","0px"),colorBar.css("background",fontColor),colorBar.removeClass("fk-colorPicker-transparentIco")}};return e=new t},this.getUICtrl=function(){if(o)return o;var t=function t(){this.constructor.prototype.createBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createBtnToolDom(t)}};return o=new t}};_EditColorBtn=new et;var ot=function ot(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createHoverBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createHoverBtnToolDom(t)}};return e=new t}};_EditDeleteBtn=new ot;var nt=function nt(){var t,C,i=this;this.getEventCtrl=function(){if(t)return t;var e=function e(){var t=this;t.constructor.prototype.showFormatToolBar=function(t){var e=t.option,o=t.toolbar.find(".tool-formats").find("."+e.css+"-formatBar"),n=0<o.height();return o.find(".formatDef").removeClass("formatDef"),n?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e):(o.parent().find(".fkEditor-tool-iconNew").addClass("edTriangleOnNew"),o.addClass("formatBarSlideDown"),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e,j.Formats)),i},t.constructor.prototype.bindFormatSliderEvent=function(o){var n=o.option,i=o.editor,t=o.toolbar,r=t.find(".tool-formats"),a=(n.moduleId.replace("module",""),r.find("."+n.css+"-formatBar"));_SelectedTool.getEventCtrl().bindMousewheelAndSlideEvent({formatbar:a,toolbar:t}),a.find("a").click(function(t){var e;return c&&(t.stopPropagation(),!n.btnModuleEdit||n.noSelectOption&&F.getEventCtrl().setSelectRange(i.data(R.Range))),a.find(".formatDef").removeClass("formatDef"),a.find(".selectedTip").hide(),L(this).addClass("formatDef"),r.find(".selectDiv span").attr("title",L(this).attr(n.css+"-formatName")).html(L(this).attr(n.css+"-formatName")),n.btnModuleEdit||n.noSelectOption?((e={}).command=j.Formats,e.val=L(this).attr(n.css+"-formatval"),e.height=n.noSelectOption?n.noSelectOption.height:"",_EditBtnBase.getEventCtrl().selectChangeForBtnModuel(o,e)):F.getEventCtrl().setSelection("fontname",L(this).attr(n.css+"-formatval")),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(n),setTimeout(function(){i.trigger("change.fkeditorClick")},200),!1}).hover(function(){var t,e=L(this);a.find(".formatDef").removeClass("formatDef"),e.addClass("formatDef"),e.find(".formatMg").hasClass("needTip")&&(t=a.find(".selectedTip"),a.find(".selectedTip").show(),t.css({top:e[0].getBoundingClientRect().top-a[0].getBoundingClientRect().top-parseInt((t.find(".tipRight").outerHeight()-e.outerHeight())/2),left:parseInt(e.width())+22}))},function(){L(this).find(".formatMg").hasClass("needTip")&&a.find(".selectedTip").hide()})}};return t=new e},this.getUICtrl=function(){if(C)return C;var c;Vue.component("tabs-select-component",{template:'\n\t\t\t\t\t<div class="tabs-select-wrap" :style="selectWrapStyle">\n\t\t\t\t\t\t<div class="select-value-wrap" @click="toggleClick">\n\t\t\t\t\t\t\t<span class="select-value">{{selectValue}}</span>\n\t\t\t\t\t\t\t<span class="select-icon" :class="{ \'active-select-icon\': showContent }"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="tabs-select__tabs" :style="tabWrapStyle" style="display: none;">\n\t\t\t\t\t\t\t<div class="tabs-header" v-if="tabList.length">\n\t\t\t\t\t\t\t\t<span class="active_bar" :style="{ transform: \'translateX(\' + activeBarLeft + \'px)\' }"></span>\n\t\t\t\t\t\t\t\t<div class="tab-item" :class="{ tab_active: item.id === activeId }" v-for="(item, index) in tabList" :key="index" @click="handleTabChange(item.id)">{{item.label}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="tabs-content" :style="tabsContentStyle">\n\t\t\t\t\t\t\t\t<scrollbar-component>\n\t\t\t\t\t\t\t\t\t<slot name="tabContent"></slot>\n\t\t\t\t\t\t\t\t</scrollbar-component>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t',props:{tabList:{type:Array,"default":function e(){return[]}},selectValue:{"default":""},selectWidth:{type:Number,"default":106},selectHeight:{type:Number,"default":32},tabContentWidth:{type:Number,"default":180},tabContentHeight:{type:Number,"default":360}},data:function o(){return{activeId:this.tabList[0]?this.tabList[0].id:0,activeBarLeft:0,showContent:!1}},methods:{handleTabChange:function n(t){this.activeId=t,this.$emit("tabClick",t),this.changeActiveBarLeft(),L(".tabs-select__tabs .jz_scrollbar__wrap").scrollTop(0)},toggleClick:function i(){this.showContent=!this.showContent,L(".tabs-select__tabs").stop().slideToggle(300,"linear")},changeActiveBarLeft:function r(){var n=this;this.$nextTick(function(){var t=L(".tabs-select-wrap .tab_active"),e=t.position().left,o=0===t.width()?n.tabContentWidth/n.tabList.length:t.width();n.activeBarLeft=e+(o-48)/2})}},computed:{selectWrapStyle:function a(){var t=this.selectWidth,e=this.selectHeight;return{width:"".concat(t,"px"),height:"".concat(e,"px")}},tabWrapStyle:function l(){var t=this.tabContentWidth,e=this.tabContentHeight;return{width:"".concat(t,"px"),height:"".concat(e,"px"),marginLeft:"-".concat(t/2,"px")}},tabsContentStyle:function d(){return{height:"calc(100% - 40px)"}}},mounted:function s(){this.tabList.length&&this.changeActiveBarLeft()}}),Vue.component("font-family-component",{template:'\n\t\t\t\t\t<div class="font-family-component">\n\t\t\t\t\t\t<tabs-select-component :tabList="tabList" @tabClick="tabClick" :select-value="selectValue" ref="tabSelect">\n\t\t\t\t\t\t\t<template slot="tabContent">\n\t\t\t\t\t\t\t\t<div class="font-family-type-wrap" v-for="(fontTypeItem, index) in fontsList" :key="index" v-show="fontTypeItem.type == tabActiveId">\n\t\t\t\t\t\t\t\t\t<div class="font-family-type-group" v-for="(item, i) in fontTypeList" :key="i">\n\t\t\t\t\t\t\t\t\t\t<div class="font-family-type__name" :title="item.name" @click="toggleSecondList(index, i)">\n\t\t\t\t\t\t\t\t\t\t\t<span class="font-family-type_icon"></span>\n\t\t\t\t\t\t\t\t\t\t\t<p>{{item.name}}</p>\n\t\t\t\t\t\t\t\t\t\t\t<tooltip-component effect="light" placement="top" popper-class="font-family-tips__popper" v-if="item.tipsTitle && item.tipsDesc">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="font-family-tips__wrap" slot="content">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p class="font-family-tips__title">{{item.tipsTitle}}</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p class="font-family-tips__desc" v-html="item.tipsDesc"></p>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class="keywordItemTips jz_tooltip font-family-tips-icon"></i>\n\t\t\t\t\t\t\t\t\t\t\t</tooltip-component>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div :class="\'js-fontList\' + index + i">\n\t\t\t\t\t\t\t\t\t\t\t<div class="font-family-item" v-for="font in item.list" :key="createSymbol(font.id)" :title="font.name" @click.stop="handleFontItemClick(font)">\n\t\t\t\t\t\t\t\t\t\t\t\t<svg><use :xlink:href="\'#font_\' + font.previewSvgId"></use></svg>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="font-family-flag">可商用</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</tabs-select-component>\n\t\t\t\t\t</div>\n\t\t\t\t',props:{selectValue:{"default":""},fontsList:{type:Array}},data:function o(){return{tabActiveId:0,recentlyUsedFontList:[]}},inject:["args"],methods:{toggleSecondList:function u(t,e){var o=L(".js-fontList".concat(t).concat(e)),n=L(".js-fontList".concat(t).concat(e)).siblings(".font-family-type__name").find(".font-family-type_icon");"none"==o.css("display")?n.css("transform","rotate(0deg)"):n.css("transform","rotate(-90deg)"),o.stop().slideToggle(300,"linear")},createSymbol:function f(t){return Symbol(t)},handleFontItemClick:function p(t){var e=this,o=t.useFontFace,n=t.id,i=t.name;M.logDog(200948,1e3+t.fontType+1),M.logDog(200948,n);var r=t["font-family"];if(o){var a=M.initCustomFontFaceFamily(i,n),l=F.getEventCtrl().getSelectText(this.args.editor);if(""===l&&(F.getEventCtrl().setNodeRange(this.args.editor[0]),l=F.getEventCtrl().getSelectText(this.args.editor)),450<l.replace(/\s/,"").length)return void N.ing("由于当前文本内容过长将导致浏览器响应缓慢，建议拆分不同文本模块实现或删减文本内容。");"fk-editor-break-dynamic-number"===this.args.option.extClasses&&(l="0123456789"),M.addFontFaceToHead(a,l),M.onFontFaceLoad(function(){s(e.args.module,a,!0),M.isSupportFontCache()&&(t.name="_"+t.name,M.addFontFile(t,function(){i="_"+(i=i.replace(/\s/g,"")),L("[style*=".concat(a,"]")).css("font-family","".concat(i,", ").concat(a))}).then(function(){t.name=t.name.replace("_","")}))})}else s(this.args.module,r);if(this.$refs.tabSelect.showContent=!1,L(".tabs-select__tabs").stop().slideUp(300,"linear"),O&&(O._data.fontFamily=i),L(".tool.tool-formats").attr("title",i),0===this.recentlyUsedFontList.length)this.recentlyUsedFontList.unshift(t);else{var d=this.recentlyUsedFontList.findIndex(function(t){return t.id==n});-1==d?4===this.recentlyUsedFontList.length&&this.recentlyUsedFontList.pop():this.recentlyUsedFontList.splice(d,1),this.recentlyUsedFontList.unshift(t)}function s(t,e){var n=2<arguments.length&&arguments[2]!==I&&arguments[2],i=t.attr("_modulestyle"),r=t.attr("_moduleid");if(81==i||115==i){var o=81==i,a=o?t.find("#module".concat(r,"FlBtn")):t.find(".fk-editor-break-dynamic-number"),l=a.css("font-family"),d=o?"module.floatBtn":"module.dynamicNumber",s=o?"floatBtnFontFamilyChange":"dynamicNumberFontFamilyChange";M.undoRun(function(t){-1<t.indexOf("宋体")?(clearTimeout(c),c=setTimeout(function(){a.css("font-family",t)},500)):a.css("font-family",t);var e=M.getModuleAttrModuleData(r),o=n?M.mergeFonts(a):[{fontFamily:t,fontId:-1}];81==i?e.prop5=o:e.prop1=o},{type:d,detail:s,doArgs:[e],undoArgs:[l]})}else F.getEventCtrl().setSelection("fontname",e);M.styleChanged(),M.getModuleAttr(r).data.changed=!0}E.localStorage.setItem("recentlyUsedFontList",JSON.stringify(this.recentlyUsedFontList)),setTimeout(function(){e.args.editor.trigger("change.fkeditorClick"),e.args.editor.trigger("click")},500)},tabClick:function m(t){this.tabActiveId=t},fixRecentlyUsedFontList:function h(){"1"!==E.localStorage.getItem("recentlyUsedFontListVersion")&&(E.localStorage.removeItem("recentlyUsedFontList"),E.localStorage.setItem("recentlyUsedFontListVersion","1")),this.recentlyUsedFontList=JSON.parse(E.localStorage.getItem("recentlyUsedFontList"))||[]}},computed:{tabList:function g(){return this.fontsList.map(function(t){return{id:t.type,label:t.name}})},fontTypeList:function v(){var e=this;return[{fontType:-1,name:"最近使用",list:this.recentlyUsedFontList}].concat(_toConsumableArray(this.fontsList.find(function(t){return t.type==e.tabActiveId}).fontTypeList)).filter(function(t){return t.list&&t.list.length})}},mounted:function s(){this.fixRecentlyUsedFontList()}});var t=function t(){this.constructor.prototype.createBtnToolDom=function(t){t.selectedData=t.option.EditFormatsBtn.selectedData;var e='\n\t\t\t\t\t\t<div class="text_font_wrap">\n\t\t\t\t\t\t\t<font-family-component :select-value="fontFamily" :fonts-list="fontsList"></font-family-component>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t';return _EditBtnBase.getUICtrl().createBtnToolDom({option:t.option,reSetUnselectable:t.reSetUnselectable,btn:t.btn,toolContent:e})}};return C=new t}};_EditFormatsBtn=new nt;var it=function it(){var t,e,s=this;this.getEventCtrl=function(){if(t)return t;var e=function e(){var d,t=this;t.constructor.prototype.showSizeToolBar=function(t){var e=t.option,o=t.toolbar,n=(t.editor,o.find(".tool-fontSize")),i=n.find(".selectDivNew span"),r=n.find("."+e.css+"-formatBar"),a=0<r.height(),l=300;return r.find(".formatDef").addClass("J_formatDef").removeClass("formatDef"),a?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e):(n.find(".selectDiv span").html(n.find(".selectDiv span").attr("_value")),r.parent().find(".fkEditor-tool-iconNew").addClass("edTriangleOnNew"),r.addClass("formatBarSlideDown"),i.attr(U.Contenteditable,!0),clearTimeout(d),d=setTimeout(function(){F.getEventCtrl().setNodeRange(i[0])},l),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e,j.FontSize)),s},t.constructor.prototype.bindFontSizeEvent=function(o){var n=o.option,i=o.editor,t=o.toolbar,r=o.module,a=t.find(".tool-fontSize"),l=a.find(".selectDivNew span"),e=a.find("."+n.css+"-formatBar");_SelectedTool.getEventCtrl().bindMousewheelAndSlideEvent({formatbar:e,toolbar:t}),_SelectedTool.getEventCtrl().bindInputEvent({element:l,command:j.FontSize,editor:i,btn:a,option:n,module:r}),e.find("a").click(function(t){var e;return _EditToolBase.getEventCtrl().editToolLogDog({module:r,command:j.ChooseFormats}),l.attr(U.Contenteditable,!1),F.getEventCtrl().getWindowSelection().removeAllRanges(),c&&(t.stopPropagation(),!n.btnModuleEdit||n.noSelectOption&&F.getEventCtrl().setSelectRange(i.data(R.Range))),a.find(".selectDiv span").attr("_value",L(this).attr(n.css+"-formatName").replace("px","")).html(L(this).attr(n.css+"-formatName")),n.btnModuleEdit||n.noSelectOption?((e={}).command=j.FontSize,e.val=L(this).attr(n.css+"-formatval"),e.height=n.noSelectOption?n.noSelectOption.height:"",_EditBtnBase.getEventCtrl().selectChangeForBtnModuel(o,e)):F.getEventCtrl().setTagStyle({styleName:"font-size",styleValue:L(this).attr(n.css+"-formatval"),editor:i,notCreateNewNode:!0,createNewNodeAction:!0}),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(n),i.data(R.PreHtmlContent,i.html()),!1}).hover(function(){e.find(".formatDef").removeClass("formatDef"),L(this).addClass("formatDef")})}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createBtnToolDom=function(t){var e;return t.selectedData=t.option.EditFontSizeBtn.selectedData,t.reSetUnselectable=" ",e=_SelectedTool.getUICtrl().createSelectedSlideToolDom(t),delete t.reSetUnselectable,e}};return e=new t}};_EditFontSizeBtn=new it;var rt=function rt(){var t,e;this._panelHeight=110,this.getEventCtrl=function(){if(t)return t;var e=function e(){var t=this;t.constructor.prototype.bindGlobalLinkPanelEvent=function(t){var e=t.option,o=t.module,n=t.editor,i=t.toolbar.find(".tool-link").find("."+e.css+"-linkSlideBar"),r=i.find(".linkPanel"),a="click.globalLinkBar mouseup.globalLinkBar";c&&i.unbind(a).bind(a,function(t){t.stopPropagation()}),r.find(".cancel").unbind("click.linkPanelCancel").bind("click.linkPanelCancel",function(){e.cancelGlobalJumpCtrlFun&&""!=e.cancelGlobalJumpCtrlFun&&N.fkEval(e.cancelGlobalJumpCtrlFun),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e)}),r.find(".confirm").unbind("click.linkPanelConfirm").bind("click.linkPanelConfirm",function(){e.saveGlobalJumpCtrlFun&&""!=e.saveGlobalJumpCtrlFun&&(N.fkEval(e.saveGlobalJumpCtrlFun)&&_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e),n.trigger("change"))}),r.find(".linkDelete").off("mouseenter.linkDeleteHover").on("mouseenter.linkDeleteHover",function(){""==r.find(".linkSet").find(".jumpHref").val()?L(this).addClass("f-deleteDisable"):L(this).removeClass("f-deleteDisable")}).off("click.linkDeleteClick").on("click.linkDeleteClick",function(){_EditToolBase.getEventCtrl().editToolLogDog({module:o,command:j.DeleteLink}),r.find(".linkSet").find(".jumpHref").val("").removeAttr("disabled"),r.find(".linkSet").find(".jumpCtrl").attr({_lType:"0",_linkdeleteclick:!0}).removeAttr("_lide target _lname _lurl _extJUrl"),o.data("jumpIde",""),L(this).trigger("mouseenter")})},t.constructor.prototype.showGlobalLinkPanel=function(t){var e=t.option,o=t.toolbar.find(".tool-link"),n=e.moduleId.replace("module",""),i=o.find("."+e.css+"-linkSlideBar"),r=i.find(".linkPanel");0<i.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e):(r.find(".linkSet").find(".jumpCtrl").removeAttr("_linkdeleteclick"),r.addClass("fkEditorBarBorder"),o.find(".slideDiv").addClass("slideDivBorder"),i.addClass("linkPanelSlide"),_EditToolBase.getEventCtrl().editToolBarMask(n))}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){var r=this;r.constructor.prototype.createHoverBtnToolDom=function(t){var e=t.option,o=t.btn,n=[],i="";return e.tipTitle&&(i=' data-title-tip="'+o.title+'" '),n.push('<div class="linkDiv slideDiv" '+u+">"),n.push("</div>"),n.push("<a "+u+' class="editToolIcon '+o.command+'-tool-icon" command ="'+o.command+'" '+i+" ></a>"),n.push('<div class="'+e.css+'-linkSlideBar">'),n.push('<div class="linkPanel fkEditorBar">'),n.push(r.createLinkPanelDom(e)),n.push("</div>"),n.push("</div>"),n.push("</div>"),t.btnContent=n.join(""),n=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,n},r.constructor.prototype.createLinkPanelDom=function(t){var e=[];return e.push('<div class="linkItem">'),e.push('<div class="linkTip">链接地址：</div>'),t.simpleLinkPanel||t.simpleTool?e.push('<div class="linkSet"><input id="jumpHref'+t.moduleId.replace("module","")+'" class="jumpHref" maxlength="255"/></div>'):(e.push('<div class="linkSet"><input id="jumpHref'+t.moduleId+'" class="jumpHref" maxlength="255"/></div>'),e.push('<div title="删除" class="linkDelete f-deleteLink" style="display:block;">删除</div>')),e.push("</div>"),e.push('<div class="operaItem">'),e.push('<div class="confirm" title="保存链接">确定</div>'),e.push('<div class="cancel" title="取消">取消</div>'),e.push("</div>"),e.join("")}};return e=new t}};_EditGlobalLinkBtn=new rt;var at=function at(){var t,e;this._panelHeight=45,this.getEventCtrl=function(){if(t)return t;var e=function e(){var t=this;t.constructor.prototype.bindBorderRadiusPanelEvent=function(t){var e=t.option,o=t.module,i=(t.editor,t.toolbar),r=e.moduleId.replace("module",""),n=M.isVueStyleGrayTest(r)?M.getModuleAttrPattern(r).vfb:M.getModuleAttrPattern(r).floatBtn;if(n){var a,l=n.r,d=n.s.w||163,s=n.s.h||52,c=i.find(".tool-borderRadius").find("."+e.css+"-borderRadiusSlideBar"),u=c.find(".borderRadiusPanel");l.lt;a=parseInt(d/2)>parseInt(s/2)?parseInt(s/2):parseInt(d/2);var f=o.find(".floatBtn"),p=l.lt>a?a:l.lt;0==l.t&&(p=parseInt(f.css("borderTopLeftRadius")));var m=null,h={animate:!0,max:a,min:0,orientation:"horizontal",step:1,value:p,start:function B(t,e){m=e.value},slide:C,stop:E},g=h.value,v=90/a;u.find(".borderRadiusLhBar").css("width",g*v+"px"),setTimeout(function(){u.find(".borderRadiusBar").slider(h)},200)}function C(t,e){c.find(".borderRadiusLhBar").css("width",e.value*v+"px"),l.t=2,l.lb=e.value,l.lt=e.value,l.rb=e.value,l.rt=e.value,M.setFlBtnRadiusChange(r,l);var o=i.find(".setRadiusBar .ui-slider-handle"),n=e.value;o.css({left:n*v+"px"})}function E(t,e){N.top.Site.getModuleAttrPattern(r).changed=!0,M.styleChanged(),null!==m&&(M.undoRun(C,{type:"module.floatBtn",detail:"floatBtnBorderRadius",id:r,doArgs:[null,{value:e.value}],undoArgs:[null,{value:m}]}),m=null)}},t.constructor.prototype.showBorderRadiusPanel=function(t){var e=t.option,o=t.toolbar.find(".tool-borderRadius"),n=e.moduleId.replace("module",""),i=o.find("."+e.css+"-borderRadiusSlideBar").find(".borderRadiusPanel");0<i.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e,j.BorderRadius):(i.addClass("f-borderRadiusPanel-show"),o.find(".slideDiv").addClass("slideDivBorder"),_EditToolBase.getEventCtrl().editToolBarMask(n),M.logDog(200193,16))}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){var r=this;r.constructor.prototype.createHoverBtnToolDom=function(t){var e=t.option,o=t.btn,n=[],i="";return e.tipTitle&&(i=' data-title-tip="'+o.title+'" '),n.push('<div class="boderRadiusDiv slideDiv" '+u+">"),n.push("</div>"),n.push("<a "+u+' class="f-editToolIcon editToolIcon '+o.command+'-tool-icon" command ="'+o.command+'" '+i+" ></a>"),n.push('<div class="borderRadiusSlideBarForBtnM '+e.css+"-borderRadiusSlideBar f-"+e.css+'-borderRadiusSlideBar ">'),n.push('<div class="f-borderRadiusPanel f-fkEditorBar borderRadiusPanel fkEditorBar">'),n.push(r.createBorderRadiusPanelDom(e)),n.push("</div>"),n.push("</div>"),n.push("</div>"),t.btnContent=n.join(""),n=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,n},r.constructor.prototype.createBorderRadiusPanelDom=function(t){var e=[];return e.push('<div class="borderRadiusBar f-slideBar" ></div>'),e.push('<div class="borderRadiusLhBar f-select-slideBar"></div>'),e.join("")}};return e=new t}};_EditBorderRadiusBtn=new at;var lt=function lt(){var t,e;this._panelHeight=45,this.getEventCtrl=function(){if(t)return t;var e=function e(){var t=this;t.constructor.prototype.bindOpacityPanelEvent=function(t){var e=t.option,o=(t.module,t.editor,t.toolbar),n=e.moduleId.replace("module",""),i=o.find(".tool-opacity").find("."+e.css+"-opacitySlideBar"),r=i.find(".opacityPanel");if(M.isVueStyleGrayTest(n))var a=100-N.top.Site.getModuleAttrPattern(n).tran;else a=100-N.top.Site.getModuleAttrPattern(n).transparent;r.find(".opacityBar").css("left");r.find(".inputVal").html(a+"%"),r.find(".opacityLhBar").css("width",a+"px");var l=null,d={animate:!0,max:90,min:0,orientation:"horizontal",step:1,value:a,start:function f(t,e){l=e.value},slide:s,stop:c};function s(t,e){i.find(".opacityLhBar").css("width",e.value+"px"),i.find(".inputVal").html(e.value+"%"),M.refreshFloatImgOpacity(n,e.value),M.isVueStyleGrayTest(n)?N.top.Site.getModuleAttrPattern(n).tran=100-e.value:N.top.Site.getModuleAttrPattern(n).transparent=100-e.value}function c(t,e){null!==l&&(M.undoRun(u,{type:"module.floatBtn",detail:"floatBtnOpacity",id:n,doArgs:[e.value],undoArgs:[l]}),l=null)}function u(t){r.find(".opacityBar").slider("value",t),i.find(".opacityLhBar").css("width",t+"px"),i.find(".inputVal").hasClass("contentEditable")||i.find(".inputVal").html(t+"%"),M.refreshFloatImgOpacity(n,t),M.isVueStyleGrayTest(n)?N.top.Site.getModuleAttrPattern(n).tran=100-t:N.top.Site.getModuleAttrPattern(n).transparent=100-t,N.top.Site.getModuleAttrPattern(n).changed=!0,M.styleChanged()}setTimeout(function(){r.find(".opacityBar").slider(d),_EditToolBase.getEventCtrl().bindSliderInputEvent(i.find(".inputVal"),{onChange:u,maxVal:i.find(".opacityBar").width()}),i.find(".inputVal").off(".undoOpacity").on("focus.undoOpacity",function(){N.isNull(l)&&(l=parseInt(L(this).text()))}).on("blur.undoOpactiy",function(){c(null,{value:parseInt(L(this).text())})})},200)},t.constructor.prototype.showOpacityPanel=function(t){var e=t.option,o=t.toolbar.find(".tool-opacity"),n=e.moduleId.replace("module",""),i=o.find("."+e.css+"-opacitySlideBar").find(".opacityPanel");0<i.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e,j.Opacity):(i.addClass("f-opacityPanel-show"),o.find(".slideDiv").addClass("slideDivBorder"),_EditToolBase.getEventCtrl().editToolBarMask(n))}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){var r=this;r.constructor.prototype.createHoverBtnToolDom=function(t){var e=t.option,o=t.btn,n=[],i="";return e.tipTitle&&(i=' data-title-tip="'+o.title+'" '),n.push('<div class="opacityDiv slideDiv" '+u+">"),n.push("</div>"),n.push("<a "+u+' class="f-editToolIcon editToolIcon '+o.command+'-tool-icon" command ="'+o.command+'" '+i+" ></a>"),n.push('<div class="opacitySlideBarForBtnM '+e.css+"-opacitySlideBar f-"+e.css+'-opacitySlideBar ">'),n.push('<div class="f-opacityPanel f-fkEditorBar opacityPanel fkEditorBar">'),n.push(r.createOpacityPanelDom(e)),n.push("</div>"),n.push("</div>"),n.push("</div>"),t.btnContent=n.join(""),n=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,n},r.constructor.prototype.createOpacityPanelDom=function(t){var e=[];return e.push('<div class="opacityBar f-slideBar" ></div>'),e.push('<div class="opacityLhBar f-select-slideBar"></div>'),e.push('<div class="inputVal f-inputVal">0%</div>'),e.join("")}};return e=new t}};_EditOpacityBtn=new lt;var dt=function dt(){var t,e;this._panelHeight=55,this.getEventCtrl=function(){if(t)return t;var e=function e(){var t=this;t.constructor.prototype.bindBorderPanelEvent=function(t){var e=t.option,o=(t.module,t.editor,t.toolbar),l=e.moduleId.replace("module",""),d=o.find(".tool-border").find("."+e.css+"-borderSlideBar"),n=d.find(".borderPanel");if(M.isVueStyleGrayTest(l))var i=N.top.Site.getModuleAttrPattern(l).vfb;else i=N.top.Site.getModuleAttrPattern(l).floatBtn;if(i){var s=i.b,r=8,a=0,c=1,u=s.w||0,f=null;0==s.t&&(u=0);var p={animate:!0,max:r,min:a,orientation:"horizontal",step:c,value:u,start:function g(t,e){f=e.value},slide:m,stop:h};n.find(".setBorderSize").slider(p),d.find(".inputVal").html(u+"px"),d.find(".borderSizeBar").css("width",11*u+"px"),d.find(".borderColor").css("background",s.c),_EditToolBase.getEventCtrl().bindSliderInputEvent(d.find(".inputVal"),{onChange:function v(t){n.find(".setBorderSize").slider("value",t),d.find(".borderSizeBar").css("width",11*t+"px"),s.t=2,s.w=t,M.setFlBtnBorderChang(l,s),N.top.Site.getModuleAttrPattern(l).changed=!0,M.styleChanged()},maxVal:r,per:"px"}),d.find(".inputVal").off(".undoBorder").on("focus.undoBorder",function(){N.isNull(f)&&(f=parseInt(L(this).text()))}).on("blur.undoBorder",function(){h(null,{value:parseInt(L(this).text())})}),d.find(".borderColor").off("click.b").on("click.b",function(t){function e(t){d.find(".borderColor").css("background",t),s.t=2,s.c=t,M.setFlBtnBorderChang(l,s),N.top.Site.getModuleAttrPattern(l).changed=!0,M.styleChanged()}function o(t,e){2==t&&(d.find(".borderColor").css("background",e),s.t=2,s.c=e,M.setFlBtnBorderChang(l,s),N.top.Site.getModuleAttrPattern(l).changed=!0,M.styleChanged())}N.isMozilla()&&t.stopPropagation();var n=s.c,i=(d.find(".borderColor"),function r(t){M.undoRun(e,{type:"module.floatBtn",detail:"floatBtnBordercolor",id:l,doArgs:[t],undoArgs:[n]})},d.find(".borderColor")[0]);M.colorPickerV2.show({base:i,initialColor:i.style.background,openGradientMode:!1,onChange:e,onChangeStop:function a(t){M.undoRun(e,{type:"module.floatBtn",detail:"floatBtnBordercolor",id:l,doArgs:[t],undoArgs:[n]})},top:M.colorPickerV2.nonHeaderHeight/2})})}function m(t,e){d.find(".borderSizeBar").css("width",11*e.value+"px"),s.t=2,s.w=e.value,d.find(".inputVal").html(e.value+"px"),M.setFlBtnBorderChang(l,s)}function h(t,e){N.top.Site.getModuleAttrPattern(l).changed=!0,M.styleChanged(),null!==f&&(M.undoRun(function(t){m(null,{value:t}),n.find(".setBorderSize").slider("value",t),d.find(".borderSizeBar").css("width",11*t+"px")},{type:"module.floatBtn",detail:"floatBtnBorderSize",id:l,doArgs:[e.value],undoArgs:[f]}),f=null)}},t.constructor.prototype.showBorderPanel=function(t){var e=t.option,o=t.toolbar.find(".tool-border"),n=e.moduleId.replace("module",""),i=o.find("."+e.css+"-borderSlideBar").find(".borderPanel");0<i.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e,j.Border):(i.addClass("f-borderPanel-show"),o.find(".slideDiv").addClass("slideDivBorder"),_EditToolBase.getEventCtrl().editToolBarMask(n))}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){var r=this;r.constructor.prototype.createHoverBtnToolDom=function(t){var e=t.option,o=t.btn,n=[],i="";return e.tipTitle&&(i=' data-title-tip="'+o.title+'" '),n.push('<div class="borderDiv slideDiv" '+u+">"),n.push("</div>"),n.push("<a "+u+' class="f-editToolIcon editToolIcon '+o.command+'-tool-icon" command ="'+o.command+'" '+i+" ></a>"),n.push('<div class=" '+e.css+"-borderSlideBar f-"+e.css+'-borderSlideBar ">'),n.push('<div class="f-borderPanel f-fkEditorBar borderPanel fkEditorBar">'),n.push(r.createBorderPanelDom(e)),n.push("</div>"),n.push("</div>"),n.push("</div>"),t.btnContent=n.join(""),n=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,n},r.constructor.prototype.createBorderPanelDom=function(t){var e=[];return e.push('<div class="f-item">'),e.push('<div class="f-tip">大小</div>'),e.push('<div class="setBorderSize f-slideBar"></div>'),e.push('<div class="borderSizeBar f-select-slideBar"></div>'),e.push('<div class="inputVal f-inputVal">0px</div>'),e.push("</div>"),e.push('<div class="f-item">'),e.push('<div class="f-tip">颜色</div>'),e.push('<div class="borderColor f-color-select"></div>'),e.push("</div>"),e.join("")}};return e=new t}};_EditBorderBtn=new dt;var st=function st(){var t,e;this._panelHeight=130,this.getEventCtrl=function(){if(t)return t;var e=function e(){var t=this;t.constructor.prototype.bindShadowPanelEvent=function(t){var e=t.option,o=(t.module,t.editor,t.toolbar),a=e.moduleId.replace("module",""),l=o.find(".tool-shadow").find("."+e.css+"-shadowSlideBar"),n=l.find(".shadowPanel");if(M.isVueStyleGrayTest(a))var i=N.top.Site.getModuleAttrPattern(a).vfb;else i=N.top.Site.getModuleAttrPattern(a).floatBtn;if(i){var d=i.sh,r=d.dx,s=d.dy,c=d.f;0==d.t&&(c=s=r=0);var u=null,f={animate:!0,max:110,min:0,orientation:"horizontal",step:1,value:r,start:function B(t,e){u=L.extend({},d)},slide:h,stop:C},p={animate:!0,max:110,min:0,orientation:"horizontal",step:1,value:s,start:function B(t,e){u=L.extend({},d)},slide:g,stop:C},m={animate:!0,max:110,min:0,orientation:"horizontal",step:1,value:c,start:function B(t,e){u=L.extend({},d)},slide:v,stop:C};n.find(".setShadowX").slider(f),l.find(".J_inputValX").html(r+"px"),_EditToolBase.getEventCtrl().bindSliderInputEvent(l.find(".J_inputValX"),{onChange:function b(t){n.find(".setShadowX").slider("value",t),l.find(".shadowXBar").css("width",t+"px"),d.t=2,d.dx=t,M.setFlBtnShadowChange(a,d),Bt(a)},per:"px",maxVal:f.max,maxLength:4}),n.find(".setShadowY").slider(p),l.find(".J_inputValY").html(s+"px"),_EditToolBase.getEventCtrl().bindSliderInputEvent(l.find(".J_inputValY"),{onChange:function b(t){n.find(".setShadowY").slider("value",t),l.find(".shadowYBar").css("width",t+"px"),d.t=2,d.dy=t,M.setFlBtnShadowChange(a,d),Bt(a)},per:"px",maxVal:p.max,maxLength:4}),n.find(".setShadowStyle").slider(m),l.find(".J_inputValS").html(c+"px"),_EditToolBase.getEventCtrl().bindSliderInputEvent(l.find(".J_inputValS"),{onChange:function b(t){n.find(".setShadowStyle").slider("value",t),l.find(".shadowStyleBar").css("width",t+"px"),d.t=2,d.f=t,M.setFlBtnShadowChange(a,d),Bt(a)},per:"px",maxVal:m.max}),l.find(".shadowXBar").css("width",d.dx+"px"),l.find(".shadowYBar").css("width",d.dy+"px"),l.find(".shadowStyleBar").css("width",d.f+"px"),l.find(".shadowColor").css("background",d.c),l.find(".J_inputValY, .J_inputValY, .J_inputValS").off(".undoShadow").on("focus.undoShadow",function(){N.isNull(undoCacheOpacity)&&(undoCacheOpacity=L.extend({},d))}).on("blur.undoShadow",function(){C()}),l.find(".shadowColor").off("click.s").on("click.s",function(t){function e(t){l.find(".shadowColor").css("background",t),d.t=2,d.c=t,M.setFlBtnShadowChange(a,d),N.top.Site.getModuleAttrPattern(a).changed=!0,M.styleChanged()}function o(t,e){l.find(".shadowColor").css("background",e),d.t=2,d.c=e,M.setFlBtnShadowChange(a,d),N.top.Site.getModuleAttrPattern(a).changed=!0,M.styleChanged()}N.isMozilla()&&t.stopPropagation();var n=d.c,i=(l.find(".shadowColor"),function r(t){M.undoRun(e,{type:"module.floatBtn",detail:"floatBtnColor",id:a,doArgs:[t],undoArgs:[n]}),n=null},l.find(".shadowColor")[0]);M.colorPickerV2.show({base:i,initialColor:i.style.background,onChange:e,openGradientMode:!1,top:M.colorPickerV2.nonHeaderHeight/2})})}function h(t,e){l.find(".shadowXBar").css("width",e.value+"px"),l.find(".J_inputValX").html(e.value+"px"),d.t=2,d.dx=e.value,M.setFlBtnShadowChange(a,d),Bt(a)}function g(t,e){l.find(".shadowYBar").css("width",e.value+"px"),l.find(".J_inputValY").html(e.value+"px"),d.t=2,d.dy=e.value,M.setFlBtnShadowChange(a,d),Bt(a)}function v(t,e){l.find(".shadowStyleBar").css("width",e.value+"px"),l.find(".J_inputValS").html(e.value+"px"),d.t=2,d.f=e.value,M.setFlBtnShadowChange(a,d),Bt(a)}function C(t,e){M.undoRun(E,{type:"module.floatBtn",detail:"floatBtnShadow",id:a,doArgs:[L.extend({},d)],undoArgs:[L.extend({},u)]}),undoCacheOpacity=null}function E(t){l.find(".shadowXBar").css("width",t.dx+"px"),l.find(".J_inputValX").html(t.dx+"px"),n.find(".setShadowX").slider("value",t.dx),l.find(".shadowYBar").css("width",t.dy+"px"),l.find(".J_inputValY").html(t.dy+"px"),n.find(".setShadowY").slider("value",t.dy),l.find(".shadowStyleBar").css("width",t.f+"px"),l.find(".J_inputValS").html(t.f+"px"),n.find(".setShadowStyle").slider("value",t.f),L.extend(d,t),M.setFlBtnShadowChange(a,d),Bt(a)}},t.constructor.prototype.showShadowPanel=function(t){var e=t.option,o=t.toolbar.find(".tool-shadow"),n=e.moduleId.replace("module",""),i=o.find("."+e.css+"-shadowSlideBar").find(".shadowPanel");0<i.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e,j.Shadow):(i.addClass("f-shadowPanel-show"),o.find(".slideDiv").addClass("slideDivShadow"),_EditToolBase.getEventCtrl().editToolBarMask(n))}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){var r=this;r.constructor.prototype.createHoverBtnToolDom=function(t){var e=t.option,o=t.btn,n=[],i="";return e.tipTitle&&(i=' data-title-tip="'+o.title+'" '),n.push('<div class="shadowDiv slideDiv" '+u+">"),n.push("</div>"),n.push("<a "+u+' class="f-editToolIcon editToolIcon '+o.command+'-tool-icon" command ="'+o.command+'" '+i+" ></a>"),n.push('<div class=" '+e.css+"-shadowSlideBar f-"+e.css+'-shadowSlideBar ">'),n.push('<div class="f-shadowPanel f-fkEditorBar shadowPanel fkEditorBar">'),n.push(r.createShadowPanelDom(e)),n.push("</div>"),n.push("</div>"),n.push("</div>"),t.btnContent=n.join(""),n=_EditBtnBase.getUICtrl().createHoverBtnToolDom(t),t.btnContent=null,n},r.constructor.prototype.createShadowPanelDom=function(t){var e=[];return e.push('<div class="f-item">'),e.push('<div class="f-tip">X轴</div>'),e.push('<div class="setShadowX f-slideBar"></div>'),e.push('<div class="shadowXBar f-select-slideBar"></div>'),e.push('<div class="f-inputVal inputVal J_inputValX"></div>'),e.push("</div>"),e.push('<div class="f-item">'),e.push('<div class="f-tip">Y轴</div>'),e.push('<div class="setShadowY f-slideBar"></div>'),e.push('<div class="shadowYBar f-select-slideBar"></div>'),e.push('<div class="f-inputVal inputVal J_inputValY"></div>'),e.push("</div>"),e.push('<div class="f-item">'),e.push('<div class="f-tip">阴影</div>'),e.push('<div class="setShadowStyle f-slideBar"></div>'),e.push('<div class="shadowStyleBar f-select-slideBar"></div>'),e.push('<div class="f-inputVal inputVal J_inputValS"></div>'),e.push("</div>"),e.push('<div class="f-item">'),e.push('<div class="f-tip">颜色</div>'),e.push('<div class="shadowColor f-color-select"></div>'),e.push("</div>"),e.join("")}};return e=new t}};_EditShadowBtn=new st;var ct=function ct(){var e,o,n=this;this.getEventCtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.bindRadiusBtnEvent=function(t){var o,e=t.option,n=t.module,i=t.toolbar,r=e.moduleId.replace("module",""),a=M.isVueStyleGrayTest(r)?M.getModuleAttrPattern(r).vfb:M.getModuleAttrPattern(r).floatBtn;if(a){var l,d=a.r,s=a.s.w||163,c=a.s.h||52,u=i.find(".tool-borderRadius").find("."+e.css+"-borderRadiusSlideBar").find(".borderRadiusPanel");if(l=parseInt(s/2)>parseInt(c/2)?parseInt(c/2):parseInt(s/2),!((o=i.find(".setRadiusBar")).length<1)){var f=90/l,p=null,m=n.find(".floatBtn"),h=d.lt>l?l:d.lt;0==d.t&&(h=parseInt(m.css("borderTopLeftRadius")));var g={max:l,min:0,orientation:"horizontal",step:1,value:h,start:v,slide:C,stop:E};o.slider(g),n.off("mouseover.radius").on("mouseover.radius",function(){i.find(".setRadiusBar").show()}).off("mouseleave.radius").on("mouseleave.radius",function(){i.find(".setRadiusBar").data("radiusSliding")||i.find(".setRadiusBar").hide()}),o.off("mouseover.radius").on("mouseover.radius",function(){i.find(".setRadiusBar").show()}).off("mouseleave.radius").on("mouseleave.radius",function(){i.find(".setRadiusBar").data("radiusSliding")||i.find(".setRadiusBar").hide()})}}function v(t,e){p=e.value,o.data("radiusSliding",!0),_EditToolBase.getEventCtrl().editToolLogDog({module:n,command:j.Radius})}function C(t,e){d.t=2,d.lb=e.value,d.lt=e.value,d.rb=e.value,d.rt=e.value,M.setFlBtnRadiusChange(r,d),u.find(".borderRadiusLhBar").css("width",e.value*f+"px"),u.find(".ui-slider-handle").css("left",e.value*f+"px")}function E(t,e){o.data("radiusSliding",!1),N.top.Site.getModuleAttrPattern(r).changed=!0,M.styleChanged(),L(e.handle).blur(),null!==p&&(M.undoRun(C,{type:"module.floatBtn",detail:"floatBtnRadoisBarSliding",id:r,doArgs:[null,e],undoArgs:[null,{vulue:p}]}),p=null)}}};return e=new t},this.getUICtrl=function(){if(o)return o;var t=function t(){this.constructor.prototype.createEditRadiusBtnDom=function(t){t.option;var e=t.toolbar,o="";if(!(0<e.find(".setRadiusBar").length))return o+="<div class='setRadiusBar f-setRadiusBar' title='左右拖动改变圆角'></div>",e.append(o),n}};return o=new t}};_EditRadiusBtn=new ct;var ut=function ut(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createBtnToolDom(t)}};return e=new t}};_EditItalicBtn=new ut;var ft=function ft(){var e,o,b=this;this.getEventCtrl=function(){if(e)return e;var t=function t(){var l,B=this;B.constructor.prototype.setLinkAttr=function(t){var e=t.element;return e.attr("href",t._lurl),e.attr("_ltype",t._ltype),e.attr("_lide",t._lide),e.attr("_lname",t._lname),e.attr("target",t._target),e.attr("rel","true"===t._nofollow?"nofollow":""),t._reqArgs?e.attr("_reqArgs",t._reqArgs):e.removeAttr("_reqArgs"),b},B.constructor.prototype.setChildLink=function(t){var e,o,n=t.element,i=t.wrapStr;if(n&&!(n.text().length<=0)&&(0<n.find("div").length||0<n.find("p").length)){for(var r=0;r<n.children().length;r++)(0<(e=n.children().eq(r)).find("div").length||0<e.find("p").length)&&0<e.text().length?B.setChildLink({element:e,wrapStr:i}):0<e.text().length&&(o=L(i).html(e.html()),e.html(o));return b}},B.constructor.prototype.setLinkAll=function(t){var e=t.text().length,o=0;if(e<=0||!t)return b;if(t.children().length<=0)return t.text().length<=0||"a"!=t.prop("tagName").toLowerCase()&&(s=t.parent("a"))&&0<=s.length&&((s=s.clone()).text(t.text()),t.html(s.prop("outerHTML"))),b;for(var n=0;n<t.children().length;n++)o+=t.children().eq(n).text().length;var i,r,a,l,d,s,c,u,f="'.?+'";if(e!=o&&0<o){i=t.clone(),r=[];for(n=0;n<i.children().length;n++)r.push(t.children().eq(n)),i.children().eq(n).prop("outerHTML",f);if(a=[],l=i.html(),d=0,s="",(s="a"!=t.prop("tagName").toLowerCase()?t.parent("a"):t)&&0<=s.length){for(n=0;n<r.length&&!((d=l.indexOf(f))<0||l.length<=0);n++)0==d?(r[n].attr("style")||r[n].attr("style",s.attr("style")),a.push(r[n].prop("outerHTML")),0<(l=l.length>f.length?l.substring(f.length,l.length):"").length&&((d=l.indexOf(f))<0?((u=s.clone()).html(l),a.push(u.prop("outerHTML")),l=""):0<d&&(c=l.substr(0,d),l=l.length>f.length?l.substring(f.length,l.length):"",(u=s.clone()).html(c),a.push(u.prop("outerHTML"))))):(c=l.substr(0,d),(u=s.clone()).html(c),a.push(u.prop("outerHTML")),l=l.length>d+f.length?l.substring(d+f.length,l.length):"",r[n].attr("style")||r[n].attr("style",s.attr("style")),a.push(r[n].prop("outerHTML")));0<l.length&&((u=s.clone()).html(l),a.push(u.prop("outerHTML"))),t.html(a.join(""))}}for(n=0;n<t.children().length;n++)B.setLinkAll(t.children().eq(n));return b},B.constructor.prototype.fkEditorSetLink=function(t){var d=t.editor,e=t.jumpCtrl,o=t.isGloableLink,n=t.option,s=n.moduleId;if(!e)return b;if("corpTitle"!=n.editorName){var c,i,u,f=e.attr("_ltype"),p=e.attr("_lide"),m=e.attr("_lname"),h=e.attr("_lurl"),g=e.attr("target"),v=e.attr("_nofollow"),r=e.attr("_linkdeleteclick"),C=e.attr("_reqArgs")||"",E=!1,a="";if(d.attr(U.Contenteditable,!0),o){if(F.getEventCtrl().setNodeRange(d[0]),"true"==r&&(_typeof(p)==I||""==L.trim(p)))return F.getEventCtrl().setSelection("Unlink"),void setTimeout(function(){for(var t=d.find("a"),e=0;e<t.length;e++)aLink=t.eq(e),aLink.text().length<=0&&aLink.remove();d.data(R.SimpleTextEdit)||d.attr(U.Contenteditable,!1)},300)}else F.getEventCtrl().setSelectRange(d.data(R.Range));if(_typeof(h)!=I)return 108==f&&(g=""),(i=L(F.getEventCtrl().getSelectedNode()))&&(a=i.children("span").css("color")||i.css("color"),E=a==d.css("color")),E&&F.getEventCtrl().setTagStyle({styleName:"color",styleValue:"#496EE8",isSetLinkColor:!0,editor:d}),c=h+"&_saltLurl",F.getEventCtrl().setSelection("Unlink"),F.getEventCtrl().setSelection(j.Createlink,c),clearTimeout(l),l=setTimeout(function(){var t,e=d.find("a"),o=d.attr("style");if(!(e.length<=0)){d.height(d.height()+"px");for(var n=0;n<e.length;n++)if((t=e.eq(n)).text().length<=0&&t.remove(),c==t.attr("href")){var i={element:t,_lurl:h,_ltype:f,_lide:p,_lname:m,_target:g,_nofollow:v,_reqArgs:C};B.setLinkAttr(i);var r=C?'_reqArgs="'.concat(C,'"'):"";if(u=h.includes('"')?"<a href='".concat(h,"' _ltype=\"").concat(f,'" _lide="').concat(p,'" _lname="').concat(m,'" target="').concat(g,'" ').concat(r,">"):'<a href="'.concat(h,'" _ltype="').concat(f,'" _lide="').concat(p,'" _lname="').concat(m,'" target="').concat(g,'" ').concat(r,">"),B.setChildLink({element:t,wrapStr:u}),E&&t.css("color","#496EE8"),T){var a=A.getEventCtrl().findTagInParent(t,"a",d.data(R.EndCheckClass));a&&B.setLinkAll(a)}}d.attr("style",o),d.data(R.SimpleTextEdit)||d.attr(U.Contenteditable,!1);var l=(s||"").replace("module","");M.removeQrCode(l),M.addQrCode(l)}},500),b}else M.saveTitleJumpUrl(e,d)},B.constructor.prototype.getLinkPreData=function(){var t=0,e=1,o="",n="",i="",r=!1,a={_ltype:t,_lide:o,_lname:n,_target:i,_moduleType:e};if(C)return a;var l,d=F.getEventCtrl().getWindowSelection();if(!d.anchorNode||!d.getRangeAt)return a;l=d.getRangeAt(0);var s=L(l.endContainer).find("a");if(s.length<=0&&(s=L(l.endContainer).closest("a")).length<=0)return a;for(var c=0;c<s.length;c++){var u=s.eq(c);if(u.attr("_lide")&&null!=u.attr("_lide")){t=u.attr("_ltype"),o=u.attr("_lide"),n=u.attr("_lname"),i=u.attr("target"),r="nofollow"===u.attr("rel");break}}return{_ltype:t,_lide:o,_lname:n,_nofollow:r,_target:i,_moduleType:e}},B.constructor.prototype.getCorpTitleLinkPreData=function(){var t=N.top._titleData.jm,e=t.y;return-1!=t.jType&&null==t.jName&&(t.jType=0,t.f="",t.y=0),1===e?t.y=2:0===e&&(t.jType=0,t.f="",t.jUrl="",t.jName=""),{_ltype:t.jType||0,_lide:t.f||"",_lname:t.jName,_target:1==t.ot?"_blank":"",hideNofollow:!0,_moduleType:8}},B.constructor.prototype.getGlobalLinkPreData=function(t,e){var o,n=0,i=1,r="",a="",l="",d=!1,s=e.option,c="",u=t.find("a");return(s.btnModuleEdit||s.simpleTool)&&(u=e.module),(o=1<u.length?u.eq(0):u).attr("_lide")&&null!=o.attr("_lide")&&(n=o.attr("_ltype"),r=o.attr("_lide"),a=o.attr("_lname"),l=o.attr("target"),c=o.attr("href"),d="nofollow"===o.attr("rel")),{_ltype:n,_lide:r,_lname:a,_target:l,_nofollow:d,hideNofollow:!1,_moduleType:i,_lurl:c}}};return e=new t},this.getUICtrl=function(){if(o)return o;var t=function t(){this.constructor.prototype.createBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createBtnToolDom(t)}};return o=new t}};_EditLinkBtn=new ft;var pt=function pt(){var t,e,d=this;this.getEventCtrl=function(){if(t)return t;var e=function e(){var l,t=this;t.constructor.prototype.showLineHiehgtToolBar=function(t){var e=t.option,o=t.toolbar.find(".tool-lineHeight"),n=o.find(".selectDiv"),i=o.find(".selectDiv span"),r=o.find("."+e.css+"-formatBar"),a=300;return 0<r.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e):(r.addClass("formatBarSlideDown"),r.find(".formatDef").addClass("J_formatDef").removeClass("formatDef"),n.removeClass("selectDivNew"),n.find("span").html(n.find("span").attr("_value")),r.parent().find(".fkEditor-tool-iconNew").addClass("edTriangleOnNew"),i.attr(U.Contenteditable,!0),clearTimeout(l),l=setTimeout(function(){F.getEventCtrl().setNodeRange(i[0])},a),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e,j.LineHeight)),d},t.constructor.prototype.bindLineHeihgtSliderBarEvent=function(t){var e,o=t.option,n=t.editor,i=t.toolbar,r=t.module,a=i.find(".tool-lineHeight"),l=a.find(".selectDiv span"),d=a.find("."+o.css+"-formatBar");_SelectedTool.getEventCtrl().bindMousewheelAndSlideEvent({formatbar:d,toolbar:i}),_SelectedTool.getEventCtrl().bindInputEvent({element:l,command:j.LineHeight,editor:n,btn:a,option:o,module:r}),d.find("a").click(function(t){return _EditToolBase.getEventCtrl().editToolLogDog({module:r,command:j.ChooseLineHeight}),l.attr(U.Contenteditable,!1),F.getEventCtrl().getWindowSelection().removeAllRanges(),c&&(t.stopPropagation(),F.getEventCtrl().setSelectRange(n.data(R.Range))),e=L(this).attr(o.css+"-formatName").replace("px",""),a.find(".selectDiv span").attr("_value",e).html(e),F.getEventCtrl().setTagStyle({styleName:"line-height",styleValue:L(this).attr(o.css+"-formatval"),editor:n,notCreateNewNode:!0,createNewNodeAction:!0}),F.getEventCtrl().setTagStyle({styleName:"display",styleValue:"inline-block",editor:n,notCreateNewNode:!0,createNewNodeAction:!0}),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(o),!1}).hover(function(){d.find(".formatDef").removeClass("formatDef"),L(this).addClass("formatDef")})}};return t=new e},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createBtnToolDom=function(t){var e;return t.selectedData=t.option.EditLineHeightBtn.selectedData,t.reSetUnselectable=" ",e=_SelectedTool.getUICtrl().createSelectedSlideToolDom(t),delete t.reSetUnselectable,e}};return e=new t}};_EditLineHeightBtn=new pt;var mt=function mt(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createBtnToolDom(t)}};return e=new t}};_EditUnderlineBtn=new mt;var ht=function ht(){var e,o,C=this;this.getEventCtrl=function(){if(e)return e;var t=function t(){var v=this;v.constructor.prototype.showWritingModePanel=function(t){var e=t.option,o=t.toolbar.find(".tool-writingMode"),n=o.find("."+e.css+"-formatBar"),i=o.find(".selectDiv");return 0<n.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e):(n.addClass("writingModeSlideDown formatBarSlideDown"),n.find(".formatDef").addClass("J_formatDef").removeClass("formatDef"),n.find(".writingMode").removeClass("horizontalHover verticalToRightHover verticalToLeftHover"),i.removeClass("selectDivNew"),n.parent().find(".fkEditor-tool-iconNew").addClass("edTriangleOnNew"),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e,j.WritingMode)),C},v.constructor.prototype.adjustWritingModeState=function(t){var e=t.toolbar,o=(t.option.moduleId,t.option),n=t.editor,i=e.find(".tool-textAlign");return n.hasClass("fk-editor-vertical-rl")||n.hasClass("fk-editor-vertical-lr")?(e.find(".tool-lineHeight").find(".selectDiv span").addClass("lrLineHeight-tool-icon"),i.find(".selectDiv span").addClass("lrTextAlign-tool-icon"),i.find("."+o.css+"-formatBarNew").addClass("lrTextAlign"),i.find(".justifyLeft .fkEditor-tool-icon").addClass("lrTextAlignLeft-tool-icon"),i.find(".justifyLeft").parent().find(".formatMg").text("上对齐"),i.find(".justifyCenter .fkEditor-tool-icon").addClass("lrTextAlignCenter-tool-icon"),i.find(".justifyRight .fkEditor-tool-icon").addClass("lrTextAlignRight-tool-icon"),i.find(".justifyRight").parent().find(".formatMg").text("下对齐"),i.find(".justifyFull .fkEditor-tool-icon").addClass("lrTextAlignFull-tool-icon"),e.find(".tool-writingMode").find(".fkEditor-tool-icon").addClass("lrWritingMode-tool-icon")):(e.find(".tool-lineHeight").find(".selectDiv span").removeClass("lrLineHeight-tool-icon"),i.find(".selectDiv span").removeClass("lrTextAlign-tool-icon"),i.find("."+o.css+"-formatBarNew").removeClass("lrTextAlign"),i.find(".justifyLeft .fkEditor-tool-icon").removeClass("lrTextAlignLeft-tool-icon"),i.find(".justifyLeft").parent().find(".formatMg").text("左对齐"),i.find(".justifyCenter .fkEditor-tool-icon").removeClass("lrTextAlignCenter-tool-icon"),i.find(".justifyRight .fkEditor-tool-icon").removeClass("lrTextAlignRight-tool-icon"),i.find(".justifyRight").parent().find(".formatMg").text("右对齐"),i.find(".justifyFull .fkEditor-tool-icon").removeClass("lrTextAlignFull-tool-icon"),e.find(".tool-writingMode").find(".fkEditor-tool-icon").removeClass("lrWritingMode-tool-icon")),C},v.constructor.prototype.switchWritingMode=function(t,e){var o=t.option,n=t.module,i=(t.toolbar,o.moduleId),r=t.editor,a="40px",l="40px",d="10px",s=521,c="10px",u="1440px",f=n.width(),p=n.height(),m=r.hasClass("fk-editor-vertical-rl")||r.hasClass("fk-editor-vertical-lr"),h=!r.hasClass("fk-editor-vertical-rl")&&!r.hasClass("fk-editor-vertical-lr"),g=n.find(".J_resizableTip");return 0==r.length?C:h&&"horizontal"==e||r.hasClass("fk-editor-vertical-rl")&&"verticalToLeft"==e||r.hasClass("fk-editor-vertical-lr")&&"verticalToRight"==e?C:(n.css(_defineProperty({"min-width":"","min-height":"","max-height":""},"max-height","")).find(".fk-editor").css(_defineProperty({"min-width":"","min-height":"","max-height":""},"max-height","")),"horizontal"==e?(r.removeClass("fk-editor-vertical-rl fk-editor-vertical-lr"),n.data(R.OldVHeight,p),n.css("width",(n.data(R.OldHwidth)||s)+"px"),r.css("width",n.width()+"px"),n.css({"max-height":""}).find(".fk-editor").css({"max-height":""}),n.css({"min-height":a,"min-width":d,"max-width":u}).find(".fk-editor").css({"min-height":a,"min-width":d,"max-width":u}),M.absModuleAutoHeight(i.replace("module",""))):(r.removeClass("fk-editor-vertical-rl fk-editor-vertical-lr"),"verticalToLeft"==e?r.addClass("fk-editor-vertical-rl").attr("_autowidth",1):"verticalToRight"==e&&r.addClass("fk-editor-vertical-lr").attr("_autowidth",1),g.attr({_faiscoTip:"还原模块默认宽度",onclick:"Site.simpleTextAutoWidth('"+i+"');return false;"}),m||(n.data(R.OldHwidth,f),n.css({"max-width":""}).find(".fk-editor").css({"max-width":""}),n.css({"min-width":l,"min-height":c,"max-height":u}).find(".fk-editor").css({"min-width":l,"min-height":c,"max-height":u}))),v.adjustWritingModeState(t),m||(r.height(),n.css("height",(n.data(R.OldVHeight)||220)+"px"),r.css("height",(n.data(R.OldVHeight)||220)+"px"),M.simpleTextAutoWidth(i)),0!=n.attr("_inpack")&&(n.find(".fk-editor-vertical-rl").attr("_autowidth",1),n.find(".fk-editor-vertical-lr").attr("_autowidth",1)),M.createSimpleTextAutoWidthBtn(n),void M.resizeModule.init(n))},v.constructor.prototype.writtingModeEmphasize=function(t){t.editor;var e=t.toolbar,o=t.command,n=e.find(".tool-writingMode").find(".selectDiv");switch(o){case j.Horizontal:n.removeClass("selectVerticalToRight selectVerticalToLeft");break;case j.VerticalToRight:n.addClass("selectVerticalToRight").removeClass("selectVerticalToLeft");break;case j.VerticalToLeft:n.addClass("selectVerticalToLeft").removeClass("selectVerticalToRight")}return C},v.constructor.prototype.bindWrittingModeSliderBarEvent=function(e){var o,t,n=e.option,i=e.editor,r=e.toolbar,a=e.module,l=r.find(".tool-writingMode").find("."+n.css+"-formatBar");l.find(".fkEditor-formatSlidebg").remove(),l.find(".fkEditor-formatSlider").remove(),l.find("a").click(function(t){return c&&(t.stopPropagation(),F.getEventCtrl().setSelectRange(i.data(R.Range))),o=L(this).attr(n.css+"-formatval"),_EditToolBase.getEventCtrl().editToolLogDog({module:a,command:o}),v.constructor.prototype.switchWritingMode(e,o),v.constructor.prototype.writtingModeEmphasize({editor:i,toolbar:r,command:o}),M.simpleTextSetCgData(n.moduleId),F.getEventCtrl().setSelection(o),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(n),!1}).hover(function(){switch(t=L(this),l.find(".formatDef").removeClass("formatDef"),l.find(".writingMode").removeClass("horizontalHover verticalToRightHover verticalToLeftHover"),t.addClass("formatDef"),o=t.attr(n.css+"-formatval")){case j.Horizontal:t.find(".writingMode").addClass("horizontalHover");break;case j.VerticalToRight:t.find(".writingMode").addClass("verticalToRightHover");break;case j.VerticalToLeft:t.find(".writingMode").addClass("verticalToLeftHover")}})}};return e=new t},this.getUICtrl=function(){if(o)return o;var t=function t(){this.constructor.prototype.createBtnToolDom=function(t){return t.selectedData=t.option.EditWritingModeBtn.selectedData,_SelectedTool.getUICtrl().createSelectedSlideToolDom(t)}};return o=new t}};_EditWritingModeBtn=new ht;var gt=function gt(){var e,o,r=this;this.getEventCtrl=function(){if(e)return e;var t=function t(){var d=this;d.constructor.prototype.showTextAlignBtnPanel=function(t){var e=t.option,o=t.toolbar.find(".tool-textAlign"),n=o.find("."+e.css+"-formatBar"),i=o.find(".selectDiv");return 0<n.height()?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e):(i.removeClass("selectDivNew"),n.find(".formatDef").addClass("J_formatDef").removeClass("formatDef"),n.find(".justify").removeClass("justifyLeftHover justifyCenterHover justifyRightHover justifyFullHover"),n.parent().find(".fkEditor-tool-iconNew").addClass("edTriangleOnNew"),n.addClass("textAlignSlideDown formatBarSlideDown"),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e,j.TextAlign)),r},d.constructor.prototype.textAlignEmphasize=function(t){t.editor;var e=t.toolbar,o=t.command,n=e.find(".tool-textAlign").find(".selectDiv");switch(o){case j.JustifyLeft:n.removeClass("selectJustifyCenter selectJustifyRight selectJustifyFull");break;case j.JustifyCenter:n.addClass("selectJustifyCenter").removeClass("selectJustifyRight selectJustifyFull");break;case j.JustifyRight:n.addClass("selectJustifyRight").removeClass("selectJustifyCenter selectJustifyFull");break;case j.JustifyFull:n.addClass("selectJustifyFull").removeClass("selectJustifyCenter selectJustifyRight")}return r},d.constructor.prototype.bindTextAlignSliderBarEvent=function(t){var e,o,n=t.option,i=t.editor,r=t.module,a=t.toolbar,l=a.find(".tool-textAlign").find("."+n.css+"-formatBar");l.find("a").click(function(t){return c&&(t.stopPropagation(),F.getEventCtrl().setSelectRange(i.data(R.Range))),e=L(this).attr(n.css+"-formatval"),_EditToolBase.getEventCtrl().editToolLogDog({module:r,command:e}),d.constructor.prototype.textAlignEmphasize({editor:i,toolbar:a,command:e}),r.find("[style*=inline-block]").css("display",""),F.getEventCtrl().setSelection(e),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(n),i.trigger("change.fkeditorClick"),!1}).hover(function(){switch(o=L(this),l.find(".formatDef").removeClass("formatDef"),l.find(".justify").removeClass("justifyLeftHover justifyCenterHover justifyRightHover justifyFullHover"),o.addClass("formatDef"),e=o.attr(n.css+"-formatval")){case j.JustifyLeft:o.find(".justify").addClass("justifyLeftHover");break;case j.JustifyCenter:o.find(".justify").addClass("justifyCenterHover");break;case j.JustifyRight:o.find(".justify").addClass("justifyRightHover");break;case j.JustifyFull:o.find(".justify").addClass("justifyFullHover")}})}};return e=new t},this.getUICtrl=function(){if(o)return o;var t=function t(){this.constructor.prototype.createBtnToolDom=function(t){return t.selectedData=t.option.EditTextAlignBtn.selectedData,_SelectedTool.getUICtrl().createSelectedSlideToolDom(t)}};return o=new t}};_EditTextAlignBtn=new gt;var vt=function vt(){var e;this.getEventCtrl=function(){},this.getUICtrl=function(){if(e)return e;var t=function t(){this.constructor.prototype.createBtnToolDom=function(t){return _EditBtnBase.getUICtrl().createBtnToolDom(t)}};return e=new t}};_EditRemoveFormatBtn=new vt;var Ct=function Ct(){var n,t;this.getEventCtrl=function(){if(n)return n;var t,e=(t=function(){this.constructor.prototype.getOuterFunc=function(){return e={fkEditorSetLink:_EditLinkBtn.getEventCtrl().fkEditorSetLink,simpleTextColorInputHexStatus:_EditColorBtn.getEventCtrl().simpleTextColorInputHexStatus,simpleTextFormatPasteData:_EditorBase.getEventCtrl().simpleTextFormatPasteData,deleteOrHideToolBar:_EditToolBase.getEventCtrl().deleteOrHideToolBar,animateHideToolSecondPanel:_EditToolBase.getEventCtrl().animateHideToolSecondPanel}}},o.toString=function(){return t.toString()},o);function o(){return t.apply(this,arguments)}return n=new e},this.getUICtrl=function(){return t||(t=new func)}};_EditorOuterFunc=new Ct;var Et=function Et(){var e,o,r=this;this.getEventCtrl=function(){if(e)return e;var t=function t(){var a,l,d,s="keypress.fkeditorClick keyup.fkeditorClick keydown.fkeditorClick drop.fkeditorClick cut.fkeditorClick copy.fkeditorClick paste.fkeditorClick DOMCharacterDataModified.fkeditorClick DOMSubtreeModified.fkeditorClick",c="change.fkeditorClick",u="click.fkeditorClick",f="mouseover.fkeditorClick",p="mouseleave.fkeditorClick",m="mousedown.fkeditorClick",h="mousemove.fkeditorClick",g="mouseup.fkeditorClick",v="keyup.fkeditorClick";this.constructor.prototype.bindEditorEvent=function(o){var n=o.option,i=o.module,r=o.editor,t=o.toolbar,e=r.find(".editTip");emphasize=n.css+"-tool-depressedNew",emphasizeHover=n.css+"-tool-depressedNewHover",emphasizeShow=n.css+"-tool-depressedNewShow",e.unbind("click.editTipbutton").bind("click.editTipbutton",function(){r.focus()}),r.data(R.EditorEventBind)||(r.data(R.EditorEventBind,!0),r.unbind(s).bind(s,function(t){if(L(this).trigger("change"),n.btnModuleEdit&&13==t.which)return!1}).unbind(c).bind(c,function(){r.data(R.ChangeCount)>n.changeCount&&(r.data(R.SetPageChange)&&0===N.top._changeStyleNum&&r.data(R.SetPageChange,!1),n.pageChangeFun&&""!=n.pageChangeFun&&!r.data(R.SetPageChange)&&r.find(".editTip").length<=0&&(clearTimeout(a),a=setTimeout(function(){r.data(R.SimpleTextEdit)||""!=r.data(R.PreHtmlContent)||r.data(R.PreHtmlContent,r.html());var t=r.children().first(),e=-1<(t.length&&t.attr("class")||"").indexOf("fk-c-")?t.html():r.html();r.data(R.PreHtmlContent)!=e&&(r.data(R.SetPageChange,!0),r.data(R.PreHtmlContent,r.html()),N.fkEval(n.pageChangeFun))},200)),n.btnModuleEdit||"auto"===n.editorHeight||_EditorBase.getEventCtrl().refeshEidtorHeight(o)),(L(this).hasClass("fk-editor-vertical-rl")||L(this).hasClass("fk-editor-vertical-lr"))&&"1"==L(this).attr("_autoWidth")&&setTimeout(function(){i.css("width",L(this).width()+"px")}.bind(this),0),r.data(R.ChangeCount,parseInt(r.data(R.ChangeCount))+1),r.data(R.RemoveUselessChildIng)||r.data(R.HasRemoveUselessChild,!1),clearTimeout(d),d=setTimeout(function(){_EditToolBase.getEventCtrl().calcuToolBarPos(o)},300)}).unbind(u).bind(u,function(t){_EditColorBtn.getEventCtrl().backTextSelectedStatus(o),_EditToolBase.getEventCtrl().animateHideToolSecondPanel(n),n.btnModuleEdit||"auto"===n.editorHeight||_EditorBase.getEventCtrl().refeshEidtorHeight(o),_EditorBase.getEventCtrl().logEditorSingleClick(o),_EditorBase.getEventCtrl().stopBannerJump({clickEvent:t})}).unbind(f).bind(f,function(){_EditToolBase.getEventCtrl().showToolBar(o)}).unbind(p).bind(p,function(){i.data(R.HoverToolOn,!1),r.data(R.HasRefreshClick)&&F.getEventCtrl().getSelectText(r,!1)}).unbind(m).bind(m,function(t){0==t.button&&(i.data(R.Mousemove,!1),i.data(R.Mousedown,!0),i.data(R.ScreenX,t.screenX),i.data(R.ScreenY,t.screenY),setTimeout(function(){_EditToolBase.getEventCtrl().animateHideToolSecondPanel(n),_EditBtnBase.getEventCtrl().buttonEmphasize(o)},100),r.data(R.HasRefreshClick,!0))}).unbind(h).bind(h,function(t){if(i.data(R.Mousedown)&&0<i.data(R.ScreenX)){var e=t.screenX,o=t.screenY;1<Math.pow(i.data(R.ScreenX)-e,2)+Math.pow(i.data(R.ScreenY)-o,2)&&i.data(R.Mousemove,!0)}}).unbind(g).bind(g,function(t){if(0==t.button){var e=r.attr(U.Contenteditable);i.data(R.Mousemove)||1!=e&&"true"!=e||(i.addClass("formLockEdit"),i.removeClass("fk-hoverModule"),r.focus().find(".editTip").remove(),clearTimeout(l),l=setTimeout(function(){r.css("cursor","text").attr(U.Contenteditable,!0),r.data(R.FirstChooseEditor)||(r.data(R.FirstChooseEditor,!0),A.getEventCtrl().textPositionCorrect(r),0<r.find(".editTip").length?r.data(R.PreHtmlContent,""):r.data(R.PreHtmlContent,r.html())),r.trigger("mouseover")},50),r.trigger("mouseover"),n.btnModuleEdit||"auto"===n.editorHeight||_EditorBase.getEventCtrl().refeshEidtorHeight(o)),i.data(R.Mousemove)||i.data(R.Mousedown,!1),i.data(R.Mousemove,!1)}}).unbind(v).bind(v,function(){setTimeout(function(){_EditBtnBase.getEventCtrl().buttonEmphasize(o)},100)}).focus(function(){if(n.focusFun&&""!=n.focusFun&&N.fkEval(n.focusFun),B){var t=H.createRange();t.selectNodeContents(r[0]),t.collapse(!1),F.getEventCtrl().setSelectRange(t)}}).focusout(function(){t.find(".tool");i.data(R.Mousedown,!1),n.blurFun&&""!=n.blurFun&&N.fkEval(n.blurFun),r.data(R.Onfocused,!1)}))}};return e=new t},this.getUICtrl=function(){if(o)return o;var t=function t(){this.constructor.prototype.creatFkEditorWrapDom=function(t){var e,o=t.option,n=t.element,i=n.parent("."+o.css+"-wrap");if(!(0<i.length))return n.wrap('<div class="'+o.css+'-wrap"></div>'),i=n.parent("."+o.css+"-wrap"),(e=[]).push('<div id="'+o.css+"-"+o.moduleId+'" class="fk-editor fkEditor '+o.extClasses+'" style="width:'+o.editorWidth+"; height:"+o.editorHeight+'; border:0px;" _width="'+o.editorWidth+'" _height="'+o.editorHeight+'" onpaste="Site.simpleTextFormatPasteData(event, \''+o.moduleId+"')\" "+U.Contenteditable+"=false >"),o.showEditTipWord?e.push('<div class="editTip">'+o.editTipWord+"</div>"):e.push(n.html()),e.push("</div>"),i.html(e.join("")),r}};return o=new t}};function Bt(t){N.top.Site.getModuleAttrPattern(t).changed=!0,M.styleChanged()}_FkEditor=new Et,M.checkSimpleTextHideTool=function(h){if(0==M.simpleTextList.checking){M.simpleTextList.checking=!0;var g=M.hasPopupModuleOpen();setTimeout(function(){if(M.simpleTextList.allEditors)for(var t,e,o,n,i,r,a,l,d,s="",c="",u=!1,f=!1,p=!1,m=0;m<M.simpleTextList.allEditors.length;m++)s=M.simpleTextList.allEditors[m].moduleId,h!=s&&(t=N.top.$("#"+s),d=M.checkNestModule(t),g&&!d.inPopupZone||((!(e=t.find("#fkEditor-"+s))||e.length<1)&&(e=M.simpleTextList.allEditors[m].editor),u=e.attr("contenteditable"),f=t.data("hoverToolOn"),p=t.data("mousedown"),(o=N.top.$("#fkEditor-toolBar-"+s)).find(".fkEditor-linkSlideBar"),_EditToolBase.getEventCtrl().isShowHoverToolPanel(o)?_EditToolBase.getEventCtrl().deleteOrHideToolBar(e.data("option")):f||p||"true"!=u||(l=o.find(".simpleTextHoverTool"),n=o.find(".tool-formats").find(".fkEditor-formatBar"),i=o.find(".tool-fontSize").find(".fkEditor-formatBar"),fsizebarTextDiv=o.find(".tool-fontSize").find(".selectDiv"),r=o.find(".tool-lineHeight").find(".fkEditor-formatBar"),lhbarTextDiv=o.find(".tool-lineHeight").find(".selectDiv"),a=o.find(".tool-textAlign").find(".fkEditor-formatBar"),c=M.simpleTextList.colorToolShow,fontFamily=L(".tool-formats .tabs-select__tabs"),l.is(":visible")||0<n.height()||0<i.height()||0<r.height()||0<a.height()||c||"none"!=fontFamily.css("display")?_EditToolBase.getEventCtrl().animateHideToolSecondPanel(e.data("option")):_EditToolBase.getEventCtrl().deleteOrHideToolBar(e.data("option"))),t.data(R.Mousedown,!1)))},50),setTimeout(function(){M.simpleTextList.checking=!1},300)}},M.simpleTextFormatPasteData=function(t,e){if(N.isSafari()){var o=t||E.event;o.preventDefault();var n=(o.originalEvent||o).clipboardData.getData("text/plain");H.execCommand("insertText",!1,n)}var i="",r="";if(M.simpleTextList.allEditors)for(var a=0;a<M.simpleTextList.allEditors.length;a++)if(M.simpleTextList.allEditors[a].moduleId==e){r=M.simpleTextList.allEditors[a].editor;break}return setTimeout(function(){_EditorBase.getEventCtrl().simpleTextFormatPasteData(r.data("editor"),i)},20),!0},M.simpleTextSetJumpCtrl=function(){N.top._subNavPackEdit&&M.logDog(200256,11);var t=N.top.$("#jumpCtrl"),e=t.data("moduleId");if(M.simpleTextList.allEditors)for(var o=0;o<M.simpleTextList.allEditors.length;o++)if(M.simpleTextList.allEditors[o].moduleId==e){var n=M.simpleTextList.allEditors[o].editor;_EditLinkBtn.getEventCtrl().fkEditorSetLink({editor:n.data("editor"),option:n.data("option"),jumpCtrl:t,isGloableLink:!1});break}},M.simpleTextSetTextColor=function(t,e){var o=M.simpleTextList.chooseEditor;o&&_EditColorBtn.getEventCtrl().simpleTextColorInputHexStatus({state:2,editor:o.data("editor"),option:o.data("option"),color:t,rgbaColor:e})},M.simpleTextColoronShowStatus=function(t){var e=1==t;M.simpleTextList.colorToolShow=e,setTimeout(function(){M.simpleTextList.colorToolShow=!e},200)},M.simpleTextShowGlobalJumpCtrl=function(t,e){111!=(e={showFullMeasure:!0,inputId:"jumpHref"+t,jumpCusId:"jumpCtrl"+t,moduleType:e._moduleType,jumpType:e._ltype,jumpIde:e._lide,jumpName:e._lname,jumpTarget:e._target,hideNofollow:e.hideNofollow,nofollow:e._nofollow,showWeixinService:!0}).jumpType&&120!=e.jumpType?M.jumpControl(e):M.parseIdeInfo(e)},M.saveTitleJumpUrl=function(t,e){if(!(t.length<1)){var o=N.top._titleData,n=N.top.$("#corpTitle"),i=t.attr("_lurl"),r=t.attr("_linkdeleteclick"),a=parseInt(t.attr("_ltype")),l=t.attr("_reqargs")||"";if(_typeof(i)!=I||r)return o.jm.ot=108==a?0:"_blank"==t.attr("target")?1:0,null!=i?(o.jm.f=t.attr("_lide"),o.jm.jType=a,o.jm.jUrl=i,o.jm.y=2,o.jm.jName=2===a||103===a?i:t.attr("_lname")||o.jm.jName,n.attr("_href",i),n.attr("href",i),n.css("cursor","pointer"),l?n.attr("_reqargs",l):n.removeAttr("_reqargs")):(o.jm.jType=0,o.jm.f="",o.jm.y=0,n.removeAttr("_href"),n.removeAttr("href"),n.removeAttr("_reqargs"),n.css("cursor","move")),114==o.jm.jType&&"微信客服"==o.jm.jName?M.checkCorpTitle():M.removeQrCode("corpTitle"),n.attr("onclick",""),N.top._titleChanged++,M.styleChanged(),e.attr(U.Contenteditable,!1),!0}},M.simpleTextSaveJumpCtrl=function(t){var e=N.top.$("#jumpCtrl"+t);if(!M.simpleTextList.allEditors)return!1;for(var o=0;o<M.simpleTextList.allEditors.length;o++)if(M.simpleTextList.allEditors[o].moduleId==t){var n=M.simpleTextList.allEditors[o].editor;_EditLinkBtn.getEventCtrl().fkEditorSetLink({editor:n.data("editor"),option:n.data("option"),jumpCtrl:e,isGloableLink:!0}),N.top.$("#fkEditor-"+t).attr(U.Contenteditable,!1);var i=L("#"+t).attr("href");return"string"==typeof i&&i.includes("_script:Site.hoverQrCode")&&M.addQrCode(t),!0}return!1},M.simpleTextShowJumpCtrl=function(t,e){N.top.$("#jumpCtrl").remove();e={showFullMeasure:!0,inputId:"simpleTextLinkInputVal-"+t,moduleType:e._moduleType,jumpType:e._ltype,jumpIde:e._lide,jumpName:e._lname,jumpTarget:e._target,hideNofollow:!1,nofollow:e._nofollow||!1,setPageChange:M.simpleTextSetJumpCtrl,showWeixinService:!0};M.jumpControl(e),setTimeout(function(){N.top.$("#jumpCtrl").data("moduleId",t).click()},300)},L(function(){var t="click.simpleTextBodyClick";L(N.top.document.body).children().unbind(t).bind(t,function(t){0==t.button&&M.checkSimpleTextHideTool()}),L(N.top.document).live("mouseup.simpleTextScrollingMouseup",function(){var t=L(".J_fkSingleTool");t.length<=0&&!t.data(w.Scrolling)||setTimeout(function(){t.data(w.Scrolling,!1)},0)})}),L.fn.fkEditor=function(t){var e,o,n={moduleId:"module0",editorName:"",css:"fkEditor",endCheckClass:"fkEditor-wrap",editSignClass:"fk-c-",btnModuleEdit:!1,simpleTool:!1,tipTitle:!1,editorWidth:"200px",editorHeight:"60px",defultContent:"",showEditTipWord:!1,showContentIcon:!1,showLinkPanel:!1,simpleLinkPanel:!1,editTipWord:"双击输入内容...",changeCount:1,systemModule:"",extClasses:"",toolExtClasses:"",isSystemModule:!1,toolBarWidth:"154px",changeFun:"",focusFun:"",blurFun:"",pageChangeFun:"",deleteFun:"",jumpCtrlFun:"",globalJumpCtrlFun:"",saveGlobalJumpCtrlFun:"",cancelGlobalJumpCtrlFun:"",animationFun:"",editModuleFun:"",positionFixedFun:"",logoDisplayFun:"",editNumberCtrlFun:"",EditContentBtn:{name:"编辑文本"},EditFormatsBtn:{name:"字体",selectedData:null},EditFontSizeBtn:{name:"大小",selectedData:[["12px","12px"],["14px","14px"],["16px","16px"],["18px","18px"],["20px","20px"],["24px","24px"],["30px","30px"],["36px","36px"],["48px","48px"],["60px","60px"],["72px","72px"],["84px","84px"],["96px","96px"],["108px","108px"],["120px","120px"]]},EditLineHeightBtn:{name:"行高",selectedData:[["12px","12px"],["14px","14px"],["16px","16px"],["18px","18px"],["20px","20px"],["24px","24px"],["30px","30px"],["36px","36px"],["48px","48px"],["60px","60px"],["72px","72px"],["84px","84px"],["96px","96px"],["108px","108px"],["120px","120px"]]},EditTextAlignBtn:{name:"对齐方式",selectedData:[["justifyLeft","左对齐","justify justifyLeft"],["justifyCenter","居中对齐","justify justifyCenter"],["justifyRight","右对齐","justify justifyRight"],["justifyFull","两端对齐","justify justifyFull"]]},EditWritingModeBtn:{name:"文字排列方式",selectedData:[["horizontal","横向排列","writingMode horizontal"],["verticalToRight","垂直向右","writingMode verticalToRight"],["verticalToLeft","垂直向左","writingMode verticalToLeft"]]},HoverTool:{show:!0,width:"154px",animationShowWidth:"186px",height:"42px",ToolBtnOrder:["EditContentBtn","EditSeperatorBtn","EditAnimationBtn","EditGlobalLinkBtn","EditDeleteBtn"]},Tool:{show:!0,width:"315px",height:"82px",ToolBtnOrder:["EditColorBtn","EditFormatsBtn","EditFontSizeBtn","EditBreakLineBtn","EditBoldBtn","EditItalicBtn","EditUnderlineBtn","EditSeperatorBtn","EditWritingModeBtn","EditLineHeightBtn","EditTextAlignBtn","EditSeperatorBtn","EditLinkBtn","EditRemoveFormatBtn"]}},i=L.extend(n,t),r=L(this),a=_EditorBase.getEventCtrl().getModule({option:i});if(a&&!(a.length<=0)&&(!_Global||_Global.moduleManage)){T&&i.changeCount++,i.btnModuleEdit?((!(e=a.find("#"+i.moduleId+"FlBtn"))||e.length<=0)&&(e=a.find(".J_floatBtnBox .floatBtn")),o=e,_EditorBase.getEventCtrl().bindAllEvent({option:i,module:a,editor:e,fkEditorWrap:o})):i.simpleTool?((e=a).data(R.SimpleTextEdit,!1),_EditorBase.getEventCtrl().bindSimpleToolAllEvent({option:i,module:a,editor:e})):(_FkEditor.getUICtrl().creatFkEditorWrapDom({option:i,element:r}),e=L("#"+i.css+"-"+i.moduleId),o=r.parent("."+i.css+"-wrap"),_EditorBase.getEventCtrl().bindAllEvent({option:i,module:a,editor:e,fkEditorWrap:o})),e.data(R.ScrollChangeChecking,!1),e.data(R.Onfocused,!1),e.data(R.SetPageChange,!1),e.data(R.LinkHasClick,!1),e.data(R.ClearSpanCursoring,!1),e.data(R.HasRefreshClick,!1),e.data(R.PreHtmlContent,""),e.data(R.HasRsChildStyle,0),e.data(R.EditSignClass,i.editSignClass),e.data(R.SignClassNum,1),e.data(R.ChangeCount,0),e.data(R.FirstChooseEditor,!1),e.data(R.HasRemoveUselessChild,!0),e.data(R.RemoveUselessChildIng,!1),e.data(R.EndCheckClass,i.endCheckClass),e.data(R.EditorEventBind,!1),e.data(R.Option,i),e.data(R.OuterFun,_EditorOuterFunc.getEventCtrl().getOuterFunc()),e.data(R.Editor,e);var l=M.simpleTextList.allEditors;for(var d in l)if(l[d].moduleId===i.moduleId){l.splice(d,1);break}return l.push({moduleId:i.moduleId,editor:e}),e}}}(jQuery,window,document,Fai||{},"undefined");
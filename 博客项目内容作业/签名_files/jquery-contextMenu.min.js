function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function n(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?e(require("jquery")):e(jQuery)}(function(m){"use strict";var s;m.support.htmlMenuitem="HTMLMenuItemElement"in window,m.support.htmlCommand="HTMLCommandElement"in window,m.support.eventSelectstart="onselectstart"in document.documentElement,m.ui&&m.widget||(m.cleanData=(s=m.cleanData,function(e){var t,n,a;for(a=0;null!=(n=e[a]);a++)try{(t=m._data(n,"events"))&&t.remove&&m(n).triggerHandler("remove")}catch(o){}s(e)}));var i=null,l=!1,u=m(window),d=0,p={},f={},h={},x={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",iconQuit:"context-menu-icon-quit"},determinePosition:function n(e){if(m.ui&&m.ui.position)e.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var t=this.offset();t.top+=this.outerHeight(),t.left+=this.outerWidth()/2-e.outerWidth()/2,e.css(t)}},position:function $(e,t,n){var a;if(t||n){a="maintain"===t&&"maintain"===n?e.$menu.position():{top:n,left:t};var o=u.scrollTop()+u.height(),s=u.scrollLeft()+u.width(),i=e.$menu.outerHeight(),c=e.$menu.outerWidth();a.top+i>o&&(a.top-=i),a.top<0&&(a.top=0),a.left+c>s&&(a.left-=c),a.left<0&&(a.left=0),e.$menu.css(a)}else e.determinePosition.call(this,e.$menu)},positionSubmenu:function a(e){if(m.ui&&m.ui.position)e.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var t={top:0,left:this.outerWidth()};e.css(t)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:m.noop,hide:m.noop},callback:null,items:{}},o={timer:null,pageX:null,pageY:null},c=function c(e){for(var t=0,n=e;t=Math.max(t,parseInt(n.css("z-index"),10)||0),(n=n.parent())&&n.length&&!(-1<"html body".indexOf(n.prop("nodeName").toLowerCase())););return t},g={abortevent:function t(e){e.preventDefault(),e.stopImmediatePropagation()},contextmenu:function k(e){var t=m(this);if("right"===e.data.trigger&&(e.preventDefault(),e.stopImmediatePropagation()),!("right"!==e.data.trigger&&"demand"!==e.data.trigger&&e.originalEvent||!(e.mouseButton===undefined||!e.data||"left"==e.data.trigger&&0===e.mouseButton||"right"==e.data.trigger&&2===e.mouseButton)||t.hasClass("context-menu-active")||t.hasClass("context-menu-disabled"))){if(i=t,e.data.build){var n=e.data.build(i,e);if(!1===n)return;if(e.data=m.extend(!0,{},x,e.data,n||{}),!e.data.items||m.isEmptyObject(e.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");e.data.$trigger=i,v.create(e.data)}var a=!1;for(var o in e.data.items){if(e.data.items.hasOwnProperty(o))(m.isFunction(e.data.items[o].visible)?e.data.items[o].visible.call(m(e.currentTarget),o,e.data):"undefined"==typeof o.visible||!0===e.data.items[o].visible)&&(a=!0)}a&&v.show.call(t,e.data,e.pageX,e.pageY)}},click:function M(e){e.preventDefault(),e.stopImmediatePropagation(),m(this).trigger(m.Event("contextmenu",{data:e.data,pageX:e.pageX,pageY:e.pageY}))},mousedown:function w(e){var t=m(this);i&&i.length&&!i.is(t)&&i.data("contextMenu").$menu.trigger("contextmenu:hide"),2===e.button&&(i=t.data("contextMenuActive",!0))},mouseup:function C(e){var t=m(this);t.data("contextMenuActive")&&i&&i.length&&i.is(t)&&!t.hasClass("context-menu-disabled")&&(e.preventDefault(),e.stopImmediatePropagation(),(i=t).trigger(m.Event("contextmenu",{data:e.data,pageX:e.pageX,pageY:e.pageY}))),t.removeData("contextMenuActive")},mouseenter:function I(e){var t=m(this),n=m(e.relatedTarget),a=m(document);n.is(".context-menu-list")||n.closest(".context-menu-list").length||i&&i.length||(o.pageX=e.pageX,o.pageY=e.pageY,o.data=e.data,a.on("mousemove.contextMenuShow",g.mousemove),o.timer=setTimeout(function(){o.timer=null,a.off("mousemove.contextMenuShow"),(i=t).trigger(m.Event("contextmenu",{data:o.data,pageX:o.pageX,pageY:o.pageY}))},e.data.delay))},mousemove:function T(e){o.pageX=e.pageX,o.pageY=e.pageY},mouseleave:function N(e){var t=m(e.relatedTarget);if(!t.is(".context-menu-list")&&!t.closest(".context-menu-list").length){try{clearTimeout(o.timer)}catch(e){}o.timer=null}},layerClick:function e(n){var a,o,s=m(this).data("contextMenuRoot"),i=n.button,c=n.pageX,r=n.pageY;n.preventDefault(),n.stopImmediatePropagation(),setTimeout(function(){var e,t="left"===s.trigger&&0===i||"right"===s.trigger&&2===i;if(document.elementFromPoint&&s.$layer&&(s.$layer.hide(),a=document.elementFromPoint(c-u.scrollLeft(),r-u.scrollTop()),s.$layer.show()),s.reposition&&t)if(document.elementFromPoint){if(s.$trigger.is(a)||s.$trigger.has(a).length)return void s.position.call(s.$trigger,s,c,r)}else if(o=s.$trigger.offset(),e=m(window),o.top+=e.scrollTop(),o.top<=n.pageY&&(o.left+=e.scrollLeft(),o.left<=n.pageX&&(o.bottom=o.top+s.$trigger.outerHeight(),o.bottom>=n.pageY&&(o.right=o.left+s.$trigger.outerWidth(),o.right>=n.pageX))))return void s.position.call(s.$trigger,s,c,r);a&&t&&s.$trigger.one("contextmenu:hidden",function(){m(a).contextMenu({x:c,y:r,button:i})}),s.$menu.trigger("contextmenu:hide")},50)},keyStop:function S(e,t){t.isInput||e.preventDefault(),e.stopPropagation()},key:function P(e){var t={};switch(i&&(t=i.data("contextMenu")||{}),e.keyCode){case 9:case 38:if(g.keyStop(e,t),t.isInput){if(9===e.keyCode&&e.shiftKey)return e.preventDefault(),t.$selected&&t.$selected.find("input, textarea, select").blur(),void t.$menu.trigger("prevcommand");if(38===e.keyCode&&"checkbox"===t.$selected.find("input, textarea, select").prop("type"))return void e.preventDefault()}else if(9!==e.keyCode||e.shiftKey)return void t.$menu.trigger("prevcommand");case 40:if(g.keyStop(e,t),!t.isInput)return void t.$menu.trigger("nextcommand");if(9===e.keyCode)return e.preventDefault(),t.$selected&&t.$selected.find("input, textarea, select").blur(),void t.$menu.trigger("nextcommand");if(40===e.keyCode&&"checkbox"===t.$selected.find("input, textarea, select").prop("type"))return void e.preventDefault();break;case 37:if(g.keyStop(e,t),t.isInput||!t.$selected||!t.$selected.length)break;if(t.$selected.parent().hasClass("context-menu-root"))break;var n=t.$selected.parent().parent();return t.$selected.trigger("contextmenu:blur"),void(t.$selected=n);case 39:if(g.keyStop(e,t),t.isInput||!t.$selected||!t.$selected.length)break;var a=t.$selected.data("contextMenu")||{};if(a.$menu&&t.$selected.hasClass("context-menu-submenu"))return t.$selected=null,a.$selected=null,void a.$menu.trigger("nextcommand");break;case 35:case 36:return t.$selected&&t.$selected.find("input, textarea, select").length?void 0:((t.$selected&&t.$selected.parent()||t.$menu).children(":not(."+t.classNames.disabled+", ."+t.classNames.notSelectable+")")[36===e.keyCode?"first":"last"]().trigger("contextmenu:focus"),void e.preventDefault());case 13:if(g.keyStop(e,t),t.isInput){if(t.$selected&&!t.$selected.is("textarea, select"))return void e.preventDefault();break}return void("undefined"!=typeof t.$selected&&null!==t.$selected&&t.$selected.trigger("mouseup"));case 32:case 33:case 34:return void g.keyStop(e,t);case 27:return g.keyStop(e,t),void t.$menu.trigger("contextmenu:hide");default:var o=String.fromCharCode(e.keyCode).toUpperCase();if(t.accesskeys&&t.accesskeys[o])return void t.accesskeys[o].$node.trigger(t.accesskeys[o].$menu?"contextmenu:focus":"mouseup")}e.stopPropagation(),"undefined"!=typeof t.$selected&&null!==t.$selected&&t.$selected.trigger(e)},prevItem:function _(e){e.stopPropagation();var t=m(this).data("contextMenu")||{},n=m(this).data("contextMenuRoot")||{};if(t.$selected){var a=t.$selected;(t=t.$selected.parent().data("contextMenu")||{}).$selected=a}for(var o=t.$menu.children(),s=t.$selected&&t.$selected.prev().length?t.$selected.prev():o.last(),i=s;s.hasClass(n.classNames.disabled)||s.hasClass(n.classNames.notSelectable);)if((s=s.prev().length?s.prev():o.last()).is(i))return;t.$selected&&g.itemMouseleave.call(t.$selected.get(0),e),g.itemMouseenter.call(s.get(0),e);var c=s.find("input, textarea, select");c.length&&c.focus()},nextItem:function D(e){e.stopPropagation();var t=m(this).data("contextMenu")||{},n=m(this).data("contextMenuRoot")||{};if(t.$selected){var a=t.$selected;(t=t.$selected.parent().data("contextMenu")||{}).$selected=a}for(var o=t.$menu.children(),s=t.$selected&&t.$selected.next().length?t.$selected.next():o.first(),i=s;s.hasClass(n.classNames.disabled)||s.hasClass(n.classNames.notSelectable);)if((s=s.next().length?s.next():o.first()).is(i))return;t.$selected&&g.itemMouseleave.call(t.$selected.get(0),e),g.itemMouseenter.call(s.get(0),e);var c=s.find("input, textarea, select");c.length&&c.focus()},focusInput:function R(){var e=m(this).closest(".context-menu-item"),t=e.data(),n=t.contextMenu,a=t.contextMenuRoot;a.$selected=n.$selected=e,a.isInput=n.isInput=!0},blurInput:function X(){var e=m(this).closest(".context-menu-item").data(),t=e.contextMenu;e.contextMenuRoot.isInput=t.isInput=!1},menuMouseenter:function Y(){m(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function E(e){var t=m(this).data().contextMenuRoot;t.$layer&&t.$layer.is(e.relatedTarget)&&(t.hovering=!1)},itemMouseenter:function z(e){var t=m(this),n=t.data(),a=n.contextMenu,o=n.contextMenuRoot;o.hovering=!0,e&&o.$layer&&o.$layer.is(e.relatedTarget)&&(e.preventDefault(),e.stopImmediatePropagation()),(a.$menu?a:o).$menu.children(".hover").trigger("contextmenu:blur"),t.hasClass(o.classNames.disabled)||t.hasClass(o.classNames.notSelectable)?a.$selected=null:t.trigger("contextmenu:focus")},itemMouseleave:function A(e){var t=m(this),n=t.data(),a=n.contextMenu,o=n.contextMenuRoot;if(o!==a&&o.$layer&&o.$layer.is(e.relatedTarget))return"undefined"!=typeof o.$selected&&null!==o.$selected&&o.$selected.trigger("contextmenu:blur"),e.preventDefault(),e.stopImmediatePropagation(),void(o.$selected=a.$selected=a.$node);t.trigger("contextmenu:blur")},itemClick:function H(e){var t,n=m(this),a=n.data(),o=a.contextMenu,s=a.contextMenuRoot,i=a.contextMenuKey;if(o.items[i]&&!n.is("."+s.classNames.disabled+", .context-menu-submenu, .context-menu-separator, ."+s.classNames.notSelectable)){if(e.preventDefault(),e.stopImmediatePropagation(),m.isFunction(s.callbacks[i])&&Object.prototype.hasOwnProperty.call(s.callbacks,i))t=s.callbacks[i];else{if(!m.isFunction(s.callback))return;t=s.callback}!1!==t.call(s.$trigger,i,s)?s.$menu.trigger("contextmenu:hide"):s.$menu.parent().length&&v.update.call(s.$trigger,s)}},inputClick:function F(e){e.stopImmediatePropagation()},hideMenu:function W(e,t){var n=m(this).data("contextMenuRoot");v.hide.call(n.$trigger,n,t&&t.force)},focusItem:function j(e){e.stopPropagation();var t=m(this),n=t.data(),a=n.contextMenu,o=n.contextMenuRoot;t.addClass([o.classNames.hover,o.classNames.visible].join(" ")).siblings().removeClass(o.classNames.visible).filter(o.classNames.hover).trigger("contextmenu:blur"),a.$selected=o.$selected=t,a.$node&&o.positionSubmenu.call(a.$node,a.$menu)},blurItem:function L(e){e.stopPropagation();var t=m(this),n=t.data(),a=n.contextMenu,o=n.contextMenuRoot;a.autoHide&&t.removeClass(o.classNames.visible),t.removeClass(o.classNames.hover),a.$selected=null}},v={show:function O(n,e,t){var a=m(this),o={};if(m("#context-menu-layer").trigger("mousedown"),n.$trigger=a,!1!==n.events.show.call(a,n)){if(v.update.call(a,n),n.position.call(a,n,e,t),n.zIndex){var s=n.zIndex;"function"==typeof n.zIndex&&(s=n.zIndex.call(a,n)),o.zIndex=c(a)+s}v.layer.call(n.$menu,n,o.zIndex),n.$menu.find("ul").css("zIndex",o.zIndex+1),n.$menu.css(o)[n.animation.show](n.animation.duration,function(){a.trigger("contextmenu:visible")}),a.data("contextMenu",n).addClass("context-menu-active"),m(document).off("keydown.contextMenu").on("keydown.contextMenu",g.key),n.autoHide&&m(document).on("mousemove.contextMenuAutoHide",function(e){var t=a.offset();t.right=t.left+a.outerWidth(),t.bottom=t.top+a.outerHeight(),!n.$layer||n.hovering||e.pageX>=t.left&&e.pageX<=t.right&&e.pageY>=t.top&&e.pageY<=t.bottom||n.$menu.trigger("contextmenu:hide")})}else i=null},hide:function B(t,e){var n=m(this);if(t||(t=n.data("contextMenu")||{}),e||!t.events||!1!==t.events.hide.call(n,t)){if(n.removeData("contextMenu").removeClass("context-menu-active"),t.$layer){setTimeout((a=t.$layer,function(){a.remove()}),10);try{delete t.$layer}catch(o){t.$layer=null}}var a;i=null,t.$menu.find("."+t.classNames.hover).trigger("contextmenu:blur"),t.$selected=null,m(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),t.$menu&&t.$menu[t.animation.hide](t.animation.duration,function(){t.build&&(t.$menu.remove(),m.each(t,function(e){switch(e){case"ns":case"selector":case"build":case"trigger":return!0;default:t[e]=undefined;try{delete t[e]}catch(o){}return!0}})),setTimeout(function(){n.trigger("contextmenu:hidden")},10)})}},create:function K(l,u){function d(e){var t=m("<span></span>");return e._accesskey?(e._beforeAccesskey&&t.append(document.createTextNode(e._beforeAccesskey)),m("<span></span>").addClass("context-menu-accesskey").text(e._accesskey).appendTo(t),e._afterAccesskey&&t.append(document.createTextNode(e._afterAccesskey))):t.text(e.name),t}u===undefined&&(u=l),l.$menu=m('<ul class="context-menu-list"></ul>').addClass(l.className||"").data({contextMenu:l,contextMenuRoot:u}),m.each(["callbacks","commands","inputs"],function(e,t){l[t]={},u[t]||(u[t]={})}),u.accesskeys||(u.accesskeys={}),m.each(l.items,function(n,a){var e=m('<li class="context-menu-item"></li>').addClass(a.className||""),t=null,o=null;if(e.on("click",m.noop),"string"==typeof a&&(a={type:"cm_seperator"}),a.$node=e.data({contextMenu:l,contextMenuRoot:u,contextMenuKey:n}),"undefined"!=typeof a.accesskey)for(var s,i=b(a.accesskey),c=0;s=i[c];c++)if(!u.accesskeys[s]){var r=(u.accesskeys[s]=a).name.match(new RegExp("^(.*?)("+s+")(.*)$","i"));r&&(a._beforeAccesskey=r[1],a._accesskey=r[2],a._afterAccesskey=r[3]);break}if(a.type&&h[a.type])h[a.type].call(e,a,l,u),m.each([l,u],function(e,t){t.commands[n]=a,m.isFunction(a.callback)&&(t.callbacks[n]=a.callback)});else{switch("cm_seperator"===a.type?e.addClass("context-menu-separator "+u.classNames.notSelectable):"html"===a.type?e.addClass("context-menu-html "+u.classNames.notSelectable):a.type?(t=m("<label></label>").appendTo(e),d(a).appendTo(t),e.addClass("context-menu-input"),l.hasTypes=!0,m.each([l,u],function(e,t){t.commands[n]=a,t.inputs[n]=a})):a.items&&(a.type="sub"),a.type){case"cm_seperator":break;case"text":o=m('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+n).val(a.value||"").appendTo(t);break;case"textarea":o=m('<textarea name=""></textarea>').attr("name","context-menu-input-"+n).val(a.value||"").appendTo(t),a.height&&o.height(a.height);break;case"checkbox":o=m('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+n).val(a.value||"").prop("checked",!!a.selected).prependTo(t);break;case"radio":o=m('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+a.radio).val(a.value||"").prop("checked",!!a.selected).prependTo(t);break;case"select":o=m('<select name="">').attr("name","context-menu-input-"+n).appendTo(t),a.options&&(m.each(a.options,function(e,t){m("<option></option>").val(e).text(t).appendTo(o)}),o.val(a.selected));break;case"sub":d(a).appendTo(e),a.appendTo=a.$node,v.create(a,u),e.data("contextMenu",a).addClass("context-menu-submenu"),a.callback=null;break;case"html":m(a.html).appendTo(e);break;default:m.each([l,u],function(e,t){t.commands[n]=a,m.isFunction(a.callback)&&(t.callbacks[n]=a.callback)}),a.usehtml?m(a.html).appendTo(e):d(a).appendTo(e)}a.type&&"sub"!==a.type&&"html"!==a.type&&"cm_seperator"!==a.type&&(o.on("focus",g.focusInput).on("blur",g.blurInput),a.events&&o.on(a.events,l)),a.icon&&(m.isFunction(a.icon)?a._icon=a.icon.call(this,this,e,n,a):a._icon=u.classNames.icon+"-"+a.icon,e.addClass(a._icon))}a.$input=o,a.$label=t,e.appendTo(l.$menu),!l.hasTypes&&m.support.eventSelectstart&&e.on("selectstart.disableTextSelect",g.abortevent)}),l.$node||l.$menu.css("display","none").addClass("context-menu-root"),l.$menu.appendTo(l.appendTo||document.body)},resize:function q(e,t){e.css({position:"absolute",display:"block"}),e.data("width",Math.ceil(e.outerWidth())),e.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),e.find("> li > ul").each(function(){v.resize(m(this),!0)}),t||e.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return m(this).data("width")})},update:function U(o,s){var i=this;s===undefined&&(s=o,v.resize(o.$menu)),o.$menu.children().each(function(){var e=m(this),t=e.data("contextMenuKey"),n=o.items[t],a=m.isFunction(n.disabled)&&n.disabled.call(i,t,s)||!0===n.disabled;if(e[(m.isFunction(n.visible)?n.visible.call(i,t,s):"undefined"==typeof n.visible||!0===n.visible)?"show":"hide"](),e[a?"addClass":"removeClass"](s.classNames.disabled),m.isFunction(n.icon)&&(e.removeClass(n._icon),n._icon=n.icon.call(this,i,e,t,n),e.addClass(n._icon)),n.type)switch(e.find("input, select, textarea").prop("disabled",a),n.type){case"text":case"textarea":n.$input.val(n.value||"");break;case"checkbox":case"radio":n.$input.val(n.value||"").prop("checked",!!n.selected);break;case"select":n.$input.val(n.selected||"")}n.$menu&&v.update.call(i,n,s)})},layer:function Q(e,t){var n=e.$layer=m('<div id="context-menu-layer" style="position:fixed; z-index:'+t+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;visibility:hidden;"></div>').css({height:u.height(),width:u.width(),display:"block"}).data("contextMenuRoot",e).insertBefore(this).css("visibility","visible").on("contextmenu",g.abortevent).on("mousedown",g.layerClick);return document.body.style.maxWidth===undefined&&n.css({position:"absolute",height:m(document).height()}),n}};function b(e){for(var t,n=e.split(/\s+/),a=[],o=0;t=n[o];o++)t=t.charAt(0).toUpperCase(),a.push(t);return a}function r(e){return e.id&&m('label[for="'+e.id+'"]').val()||e.name}function y(s,e,i){return i||(i=0),e.each(function(){var e,t,n=m(this),a=this,o=this.nodeName.toLowerCase();switch("label"===o&&n.find("input, textarea, select").length&&(e=n.text(),o=(a=(n=n.children().first()).get(0)).nodeName.toLowerCase()),o){case"menu":t={name:n.attr("label"),items:{}},i=y(t.items,n.children(),i);break;case"a":case"button":t={name:n.text(),disabled:!!n.attr("disabled"),callback:function(){n.click()}};break;case"menuitem":case"command":switch(n.attr("type")){case undefined:case"command":case"menuitem":t={name:n.attr("label"),disabled:!!n.attr("disabled"),icon:n.attr("icon"),callback:function(){n.click()}};break;case"checkbox":t={type:"checkbox",disabled:!!n.attr("disabled"),name:n.attr("label"),selected:!!n.attr("checked")};break;case"radio":t={type:"radio",disabled:!!n.attr("disabled"),name:n.attr("label"),radio:n.attr("radiogroup"),value:n.attr("id"),selected:!!n.attr("checked")};break;default:t=undefined}break;case"hr":t="-------";break;case"input":switch(n.attr("type")){case"text":t={type:"text",name:e||r(a),disabled:!!n.attr("disabled"),value:n.val()};break;case"checkbox":t={type:"checkbox",name:e||r(a),disabled:!!n.attr("disabled"),selected:!!n.attr("checked")};break;case"radio":t={type:"radio",name:e||r(a),disabled:!!n.attr("disabled"),radio:!!n.attr("name"),value:n.val(),selected:!!n.attr("checked")};break;default:t=undefined}break;case"select":t={type:"select",name:e||r(a),disabled:!!n.attr("disabled"),selected:n.val(),options:{}},n.children().each(function(){t.options[this.value]=m(this).text()});break;case"textarea":t={type:"textarea",name:e||r(a),disabled:!!n.attr("disabled"),value:n.val()};break;case"label":break;default:t={type:"html",html:n.clone(!0)}}t&&(s["key"+ ++i]=t)}),i}m.fn.contextMenu=function(e){var t=this,n=e;if(0<this.length)if(e===undefined)this.first().trigger("contextmenu");else if(e.x!==undefined&&e.y!==undefined)this.first().trigger(m.Event("contextmenu",{pageX:e.x,pageY:e.y,mouseButton:e.button}));else if("hide"===e){var a=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;a&&a.trigger("contextmenu:hide")}else"destroy"===e?m.contextMenu("destroy",{context:this}):m.isPlainObject(e)?(e.context=this,m.contextMenu("create",e)):e?this.removeClass("context-menu-disabled"):e||this.addClass("context-menu-disabled");else m.each(f,function(){this.selector===t.selector&&(n.data=this,m.extend(n.data,{trigger:"demand"}))}),g.contextmenu.call(n.target,n);return this},m.contextMenu=function(e,t){"string"!=typeof e&&(t=e,e="create"),"string"==typeof t?t={selector:t}:t===undefined&&(t={});var n=m.extend(!0,{},x,t||{}),a=m(document),o=a,s=!1;switch(n.context&&n.context.length?(o=m(n.context).first(),n.context=o.get(0),s=n.context!==document):n.context=document,e){case"create":if(!n.selector)throw new Error("No selector specified");if(n.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+n.selector+'" as it contains a reserved className');if(!n.build&&(!n.items||m.isEmptyObject(n.items)))throw new Error("No Items specified");switch(d++,n.ns=".contextMenu"+d,s||(p[n.selector]=n.ns),(f[n.ns]=n).trigger||(n.trigger="right"),l||(a.on({"contextmenu:hide.contextMenu":g.hideMenu,"prevcommand.contextMenu":g.prevItem,"nextcommand.contextMenu":g.nextItem,"contextmenu.contextMenu":g.abortevent,"mouseenter.contextMenu":g.menuMouseenter,"mouseleave.contextMenu":g.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",g.inputClick).on({"mouseup.contextMenu":g.itemClick,"contextmenu:focus.contextMenu":g.focusItem,"contextmenu:blur.contextMenu":g.blurItem,"contextmenu.contextMenu":g.abortevent,"mouseenter.contextMenu":g.itemMouseenter,"mouseleave.contextMenu":g.itemMouseleave},".context-menu-item"),l=!0),o.on("contextmenu"+n.ns,n.selector,n,g.contextmenu),s&&o.on("remove"+n.ns,function(){m(this).contextMenu("destroy")}),n.trigger){case"hover":o.on("mouseenter"+n.ns,n.selector,n,g.mouseenter).on("mouseleave"+n.ns,n.selector,n,g.mouseleave);break;case"left":o.on("click"+n.ns,n.selector,n,g.click)}n.build||v.create(n);break;case"destroy":var i;if(s){var c=n.context;m.each(f,function(e,t){if(t.context!==c)return!0;(i=m(".context-menu-list").filter(":visible")).length&&i.data().contextMenuRoot.$trigger.is(m(t.context).find(t.selector))&&i.trigger("contextmenu:hide",{force:!0});try{f[t.ns].$menu&&f[t.ns].$menu.remove(),delete f[t.ns]}catch(n){f[t.ns]=null}return m(t.context).off(t.ns),!0})}else if(n.selector){if(p[n.selector]){(i=m(".context-menu-list").filter(":visible")).length&&i.data().contextMenuRoot.$trigger.is(n.selector)&&i.trigger("contextmenu:hide",{force:!0});try{f[p[n.selector]].$menu&&f[p[n.selector]].$menu.remove(),delete f[p[n.selector]]}catch(r){f[p[n.selector]]=null}a.off(p[n.selector])}}else a.off(".contextMenu .contextMenuAutoHide"),m.each(f,function(e,t){m(t.context).off(t.ns)}),p={},d=0,l=!(f={}),m("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!m.support.htmlCommand&&!m.support.htmlMenuitem||"boolean"==typeof t&&t)&&m('menu[type="context"]').each(function(){this.id&&m.contextMenu({selector:"[contextmenu="+this.id+"]",items:m.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+e+'"')}return this},m.contextMenu.setInputValues=function(e,n){n===undefined&&(n={}),m.each(e.inputs,function(e,t){switch(t.type){case"text":case"textarea":t.value=n[e]||"";break;case"checkbox":t.selected=!!n[e];break;case"radio":t.selected=(n[t.radio]||"")===t.value;break;case"select":t.selected=n[e]||""}})},m.contextMenu.getInputValues=function(e,n){return n===undefined&&(n={}),m.each(e.inputs,function(e,t){switch(t.type){case"text":case"textarea":case"select":n[e]=t.$input.val();break;case"checkbox":n[e]=t.$input.prop("checked");break;case"radio":t.$input.prop("checked")&&(n[t.radio]=t.value)}}),n},m.contextMenu.fromMenu=function(e){var t={};return y(t,m(e).children()),t},m.contextMenu.defaults=x,m.contextMenu.types=h,m.contextMenu.handle=g,m.contextMenu.op=v,m.contextMenu.menus=f});
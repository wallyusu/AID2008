!function(w){function t(e){var m=w(this),v=null,y=[],p=null,n=null,d=w.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:w.noop,exit:w.noop,activate:w.noop,deactivate:w.noop,exitMenu:w.noop,exitActRow:w.noop},e),t=3,b=300,i=function i(e){y.push({x:e.pageX,y:e.pageY}),y.length>t&&y.shift()},o=function o(){n&&clearTimeout(n),d.exitActRow(this)&&(w(v).length&&0==w(v).attr("_chd")&&d.deactivate(v),v=null),d.exitMenu(this)&&(v&&d.deactivate(v),v=null)},u=function u(){n&&clearTimeout(n),d.enter(this),a(this)},r=function r(){d.exit(this)},c=function c(){l(this)},l=function l(e){e!=v&&(v&&d.deactivate(v),d.activate(e),v=e)},a=function a(e){var t=g();t?n=setTimeout(function(){a(e)},t):l(e)},g=function g(){if(!v||!w(v).is(d.submenuSelector))return 0;var e=m.offset(),t={x:e.left,y:e.top-d.tolerance},n={x:e.left+m.outerWidth(),y:t.y},i={x:e.left,y:e.top+m.outerHeight()+d.tolerance},o={x:e.left+m.outerWidth(),y:i.y},u=y[y.length-1],r=y[0];if(!u)return 0;if(r||(r=u),r.x<e.left||r.x>o.x||r.y<e.top||r.y>o.y)return 0;if(p&&u.x==p.x&&u.y==p.y)return 0;function c(e,t){return(t.y-e.y)/(t.x-e.x)}var l=n,a=o;"left"==d.submenuDirection?(l=i,a=t):"below"==d.submenuDirection?(l=o,a=i):"above"==d.submenuDirection&&(l=t,a=n);var f=c(u,l),s=c(u,a),h=c(r,l),x=c(r,a);return f<h&&x<s?(p=u,b):(p=null,0)};m.mouseleave(o).find(d.rowSelector).mouseenter(u).mouseleave(r).click(c),w(document).mousemove(i)}w.fn.menuAim=function(e){return this.each(function(){t.call(this,e)}),this}}(jQuery);